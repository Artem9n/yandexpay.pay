{"version":3,"file":"solution.js","sources":["../../reference/page.js","../element.js","../basket.js","../order.js","../../reference/factory.js","../index.js"],"sourcesContent":["export default class Page {\r\n\r\n\tbootFactory(factory) {\r\n\r\n\t}\r\n\r\n\tbootWidget(widget) {\r\n\r\n\t}\r\n\r\n\tbootCart(cart) {\r\n\r\n\t}\r\n\r\n\tonEvent(name, callback, config = {}) {\r\n\t\tthis.matchEvent('bx', config) && this.onBxEvent(name, callback, config);\r\n\t\tthis.matchEvent('jquery', config) && this.onJQueryEvent(name, callback, config);\r\n\t\tthis.matchEvent('plain', config) && this.onPlainEvent(name, callback, config);\r\n\t}\r\n\r\n\tmatchEvent(type, config) {\r\n\t\treturn config[type] != null ? !!config[type] : !config['strict'];\r\n\t}\r\n\r\n\tonBxEvent(name, callback, config) {\r\n\t\tif (typeof BX === 'undefined') { return; }\r\n\r\n\t\tBX.addCustomEvent(name, callback);\r\n\t}\r\n\r\n\tonJQueryEvent(name, callback, config) {\r\n\t\tif (typeof jQuery === 'undefined') { return; }\r\n\r\n\t\tconst selfConfig = this.extractEventTypeConfig('jquery', config);\r\n\r\n\t\tif (selfConfig['proxy'] !== false) {\r\n\t\t\tconst originalCallback = callback;\r\n\r\n\t\t\tcallback = (evt, data) => {\r\n\t\t\t\tconst proxyData = data != null ? data : evt?.originalEvent?.detail;\r\n\r\n\t\t\t\toriginalCallback(proxyData);\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tjQuery(document).on(name, callback);\r\n\t}\r\n\r\n\tonPlainEvent(name, callback, config) {\r\n\t\tconst selfConfig = this.extractEventTypeConfig('plain', config);\r\n\r\n\t\tif (selfConfig['force'] !== true && typeof jQuery !== 'undefined') { // will be catch inside jquery\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (selfConfig['proxy'] !== false) {\r\n\t\t\tconst originalCallback = callback;\r\n\r\n\t\t\tcallback = (evt) => {\r\n\t\t\t\toriginalCallback(evt.detail);\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tdocument.addEventListener(name, callback);\r\n\t}\r\n\r\n\textractEventTypeConfig(type, config) {\r\n\t\treturn typeof config[type] === 'object' && config[type] != null ? config : {}\r\n\t}\r\n\r\n}","import Page from '../reference/page';\r\n\r\nexport default class Element extends Page {\r\n\r\n\tbootCart(cart) {\r\n\t\tthis.onEvent('onCatalogElementChangeOffer', (eventData) => {\r\n\t\t\tlet newProductId = parseInt(eventData?.newId, 10);\r\n\r\n\t\t\tif (isNaN(newProductId)) { return; }\r\n\r\n\t\t\tcart.delayChangeOffer(newProductId);\r\n\t\t});\r\n\t}\r\n}\r\n","import Page from '../reference/page';\r\n\r\nexport default class Basket extends Page {\r\n\r\n\tbootFactory(factory) {\r\n\t\tfactory.extendDefaults({\r\n\t\t\tpreserve: {\r\n\t\t\t\tmutation: {\r\n\t\t\t\t\tanchor: '[data-entity=\"basket-total-block\"]',\r\n\t\t\t\t\tdelay: null,\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t});\r\n\t}\r\n\r\n\tbootCart(cart) {\r\n\t\tif (typeof BX === 'undefined') { return; }\r\n\r\n\t\tthis.onEvent('OnBasketChange', () => {\r\n\t\t\tcart.getProducts().then((result) => {\r\n\t\t\t\tcart.combineOrderWithProducts(result);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n}\r\n","import Page from '../reference/page';\r\n\r\nexport default class Order extends Page {\r\n\r\n\tbootFactory(factory) {\r\n\t\tfactory.extendDefaults({\r\n\t\t\tpreserve: {\r\n\t\t\t\tmutation: {\r\n\t\t\t\t\tanchor: '.bx-soa-cart-total',\r\n\t\t\t\t\tdelay: null,\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t});\r\n\t}\r\n}\r\n","export default class Factory {\r\n\r\n\tclassMap = {};\r\n\r\n\tconstructor(classMap) {\r\n\t\tthis.classMap = classMap;\r\n\t}\r\n\r\n\tcreate(mode) {\r\n\t\tconst className = this.classMap[mode];\r\n\r\n\t\tif (className == null) { return null; }\r\n\r\n\t\treturn new className();\r\n\t}\r\n\r\n}","import Element from './element';\r\nimport Basket from './basket';\r\nimport Order from './order';\r\nimport Factory from '../reference/factory';\r\n\r\nimport './widget.css';\r\n\r\nconst factory = new Factory({\r\n\telement: Element,\r\n\tbasket: Basket,\r\n\torder: Order,\r\n});\r\n\r\nexport {\r\n\tfactory,\r\n}\r\n"],"names":["Page","factory","widget","cart","name","callback","config","matchEvent","onBxEvent","onJQueryEvent","onPlainEvent","type","BX","addCustomEvent","jQuery","selfConfig","extractEventTypeConfig","originalCallback","evt","data","proxyData","originalEvent","detail","document","on","addEventListener","Element","onEvent","eventData","newProductId","parseInt","newId","isNaN","delayChangeOffer","Basket","extendDefaults","preserve","mutation","anchor","delay","getProducts","then","result","combineOrderWithProducts","Order","Factory","classMap","mode","className","element","basket","order"],"mappings":"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"}