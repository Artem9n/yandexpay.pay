{"version":3,"file":"widget.js","sources":["../solutionregistry.js","../ui/nodepreserver/mutationskeleton.js","../ui/nodepreserver/mutationloop.js","../ui/nodepreserver/mutationobserver.js","../ui/nodepreserver/mutationfactory.js","../utils/eventproxy.js","../ui/nodepreserver/subscriber.js","../ui/nodepreserver.js","../utils/template.js","../factory.js","../step/abstractstep.js","../secure3d/base.js","../secure3d/form.js","../secure3d/iframe.js","../secure3d/iframerbs.js","../step/secure3d.js","../step/finish.js","../step/failure.js","../step/payment.js","../utils/ready.js","../step/cart.js","../step/factory.js","../widget.js"],"sourcesContent":["export default class SolutionRegistry {\r\n\r\n\tstatic pages = {};\r\n\r\n\tstatic getFactory(name) {\r\n\t\tif (name == null) { return null; }\r\n\r\n\t\tconst factory = window?.BX?.YandexPay?.Solution?.[name]?.factory;\r\n\r\n\t\tif (factory == null) {\r\n\t\t\tconsole?.warn(`cant find solution ${name}`);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\treturn factory;\r\n\t}\r\n\r\n\tstatic getPage(name, mode) {\r\n\t\tif (name == null || mode == null) { return null; }\r\n\r\n\t\tconst key = name + ':' + mode;\r\n\r\n\t\tif (this.pages[key] == null) {\r\n\t\t\tthis.pages[key] = this.createPage(name, mode);\r\n\t\t}\r\n\r\n\t\treturn this.pages[key];\r\n\t}\r\n\r\n\tstatic createPage(name, mode) {\r\n\t\tconst factory = this.getFactory(name);\r\n\r\n\t\tif (factory == null) { return null; }\r\n\r\n\t\treturn factory.create(mode);\r\n\t}\r\n\r\n}","export default class MutationSkeleton {\r\n\r\n\tstatic defaults = {\r\n\t\tcheck: null,\r\n\t}\r\n\r\n\tconstructor(element, options = {}) {\r\n\t\tthis.el = element;\r\n\t\tthis.options = Object.assign({}, this.constructor.defaults, options);\r\n\t}\r\n\r\n\tdestroy() {\r\n\r\n\t}\r\n\r\n}","import MutationSkeleton from \"./mutationskeleton\";\r\n\r\nexport default class MutationLoop extends MutationSkeleton {\r\n\r\n\tstatic defaults = Object.assign({}, MutationSkeleton.defaults, {\r\n\t\ttimeout: 1000,\r\n\t})\r\n\r\n\tconstructor(element, options = {}) {\r\n\t\tsuper(element, options);\r\n\t\tthis.loopTimeout();\r\n\t}\r\n\r\n\tdestroy() {\r\n\t\tthis.loopCancel();\r\n\t}\r\n\r\n\tloopTimeout() {\r\n\t\tclearTimeout(this._loopTimeout);\r\n\t\tthis._loopTimeout = setTimeout(this.loop, this.options.timeout);\r\n\t}\r\n\r\n\tloopCancel() {\r\n\t\tclearTimeout(this._loopTimeout);\r\n\t}\r\n\r\n\tloop = () => {\r\n\t\tthis.options.check() && this.loopTimeout();\r\n\t}\r\n\r\n}","import MutationSkeleton from \"./mutationskeleton\";\r\n\r\nexport default class MutationObserver extends MutationSkeleton {\r\n\r\n\tstatic defaults = Object.assign({}, MutationSkeleton.defaults, {\r\n\t\tanchor: null,\r\n\t\tdelay: 0,\r\n\t})\r\n\r\n\tconstructor(element, options = {}) {\r\n\t\tsuper(element, options);\r\n\t\tthis.observe();\r\n\t}\r\n\r\n\tdestroy() {\r\n\t\tthis.disconnect();\r\n\t}\r\n\r\n\tobserve() {\r\n\t\tconst anchor = this.getAnchor();\r\n\r\n\t\tif (anchor == null) {\r\n\t\t\tconsole?.warn('cant find anchor for node preserver');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.observer = new window.MutationObserver(this.listener);\r\n\t\tthis.observer.observe(anchor, {\r\n\t\t\tchildList: true,\r\n\t\t\tsubtree: true,\r\n\t\t});\r\n\t}\r\n\r\n\tdisconnect() {\r\n\t\tif (this.observer == null) { return; }\r\n\r\n\t\tthis.observer.disconnect();\r\n\t\tthis.observer = null;\r\n\t}\r\n\r\n\tlistener = (mutations) => {\r\n\t\tfor (const mutation of mutations) {\r\n\t\t\tif (mutation.removedNodes == null) { continue; }\r\n\r\n\t\t\tfor (const removedNode of mutation.removedNodes) {\r\n\t\t\t\tif (!(removedNode instanceof HTMLElement)) { continue; }\r\n\r\n\t\t\t\tif (removedNode === this.el || removedNode.contains(this.el)) {\r\n\t\t\t\t\tthis.runCheck();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\trunCheck() {\r\n\t\tconst delay = this.options.delay;\r\n\r\n\t\tif (delay == null) {\r\n\t\t\tthis.options.check();\r\n\t\t} else {\r\n\t\t\tclearTimeout(this._checkTimeout);\r\n\t\t\tthis._checkTimeout = setTimeout(() => { this.options.check(); }, delay);\r\n\t\t}\r\n\t}\r\n\r\n\tgetAnchor() {\r\n\t\tif (this.options.anchor == null) { return document.body; }\r\n\r\n\t\treturn this.el.closest(this.options.anchor);\r\n\t}\r\n\r\n}","import MutationLoop from \"./mutationloop\";\r\nimport MutationObserver from \"./mutationobserver\";\r\n\r\nexport default class MutationFactory {\r\n\r\n\tstatic make(element, options) {\r\n\t\tif (typeof window.MutationObserver === 'function') {\r\n\t\t\treturn new MutationObserver(element, options);\r\n\t\t}\r\n\r\n\t\treturn new MutationLoop(element, options);\r\n\t}\r\n\r\n}","export class EventProxy {\r\n\r\n\tstatic make(config = {}) {\r\n\t\treturn new EventProxy(config);\r\n\t}\r\n\r\n\tconstructor(config = {}) {\r\n\t\tthis.config = config;\r\n\t\tthis.callbackMap = {};\r\n\t}\r\n\r\n\ton(name, callback) {\r\n\t\tthis.matchEvent('bx') && this.onBxEvent(name, callback);\r\n\t\tthis.matchEvent('jquery') && this.onJQueryEvent(name, callback);\r\n\t\tthis.matchEvent('plain') && this.onPlainEvent(name, callback);\r\n\t}\r\n\r\n\toff(name, callback) {\r\n\t\tthis.matchEvent('bx') && this.offBxEvent(name, callback);\r\n\t\tthis.matchEvent('jquery') && this.offJQueryEvent(name, callback);\r\n\t\tthis.matchEvent('plain') && this.offPlainEvent(name, callback);\r\n\t}\r\n\r\n\tfire(name, data = {}) {\r\n\t\tthis.matchEvent('bx') && this.fireBxEvent(name, data);\r\n\t\tthis.matchEvent('jquery') && this.fireJQueryEvent(name, data);\r\n\t\tthis.matchEvent('plain') && this.firePlainEvent(name, data);\r\n\t}\r\n\r\n\tmatchEvent(type) {\r\n\t\treturn this.config[type] != null ? !!this.config[type] : !this.config['strict'];\r\n\t}\r\n\r\n\tonBxEvent(name, callback) {\r\n\t\tif (typeof BX === 'undefined') { return; }\r\n\r\n\t\tBX.addCustomEvent(name, callback);\r\n\t}\r\n\r\n\toffBxEvent(name, callback) {\r\n\t\tif (typeof BX === 'undefined') { return; }\r\n\r\n\t\tBX.removeCustomEvent(name, callback);\r\n\t}\r\n\r\n\tfireBxEvent(name, data) {\r\n\t\tif (typeof BX === 'undefined') { return; }\r\n\r\n\t\tBX.onCustomEvent(name, [data]);\r\n\t}\r\n\r\n\tonJQueryEvent(name, callback) {\r\n\t\tif (typeof jQuery === 'undefined') { return; }\r\n\r\n\t\tconst selfConfig = this.typeConfig('jquery');\r\n\r\n\t\tif (this.canProxyCallback(selfConfig)) {\r\n\t\t\tconst originalCallback = callback;\r\n\r\n\t\t\tcallback = (evt, data) => {\r\n\t\t\t\tconst proxyData = data != null ? data : evt?.originalEvent?.detail;\r\n\r\n\t\t\t\toriginalCallback(proxyData);\r\n\t\t\t};\r\n\r\n\t\t\tthis.storeCallbackVariation('jquery', originalCallback, callback);\r\n\t\t}\r\n\r\n\t\tjQuery(document).on(name, callback);\r\n\t}\r\n\r\n\toffJQueryEvent(name, callback) {\r\n\t\tif (typeof jQuery === 'undefined') { return; }\r\n\r\n\t\tconst selfConfig = this.typeConfig('jquery');\r\n\r\n\t\tif (this.canProxyCallback(selfConfig)) {\r\n\t\t\tcallback = this.getCallbackVariation('jquery', callback);\r\n\r\n\t\t\tif (callback == null) { return; }\r\n\t\t}\r\n\r\n\t\tjQuery(document).off(name, callback);\r\n\t}\r\n\r\n\tfireJQueryEvent(name, data) {\r\n\t\tif (typeof jQuery === 'undefined') { return; }\r\n\t\tif (this.hasPlainAndJQueryCollision()) { return; }\r\n\r\n\t\tjQuery(document).triggerHandler(new CustomEvent(name, { \"detail\": data }));\r\n\t}\r\n\r\n\tonPlainEvent(name, callback) {\r\n\t\tif (this.hasPlainAndJQueryCollision()) { return; }\r\n\r\n\t\tconst selfConfig = this.typeConfig('plain');\r\n\r\n\t\tif (this.canProxyCallback(selfConfig)) {\r\n\t\t\tconst originalCallback = callback;\r\n\r\n\t\t\tcallback = (evt) => {\r\n\t\t\t\toriginalCallback(evt.detail);\r\n\t\t\t};\r\n\r\n\t\t\tthis.storeCallbackVariation('plain', originalCallback, callback);\r\n\t\t}\r\n\r\n\t\tdocument.addEventListener(name, callback);\r\n\t}\r\n\r\n\toffPlainEvent(name, callback) {\r\n\t\tif (this.hasPlainAndJQueryCollision()) { return; }\r\n\r\n\t\tconst selfConfig = this.typeConfig('plain');\r\n\r\n\t\tif (this.canProxyCallback(selfConfig)) {\r\n\t\t\tcallback = this.getCallbackVariation('plain', callback);\r\n\r\n\t\t\tif (callback == null) { return; }\r\n\t\t}\r\n\r\n\t\tdocument.removeEventListener(name, callback);\r\n\t}\r\n\r\n\tfirePlainEvent(name, data) {\r\n\t\tdocument.dispatchEvent(new CustomEvent(name, { \"detail\": data }));\r\n\t}\r\n\r\n\thasPlainAndJQueryCollision() {\r\n\t\tif (!this.matchEvent('plain') || !this.matchEvent('jquery')) { return false; }\r\n\r\n\t\tconst plainConfig = this.typeConfig('plain');\r\n\r\n\t\treturn (plainConfig['force'] !== true && typeof jQuery !== 'undefined');\r\n\t}\r\n\r\n\tcanProxyCallback(selfConfig) {\r\n\t\treturn selfConfig['proxy'] !== false;\r\n\t}\r\n\r\n\ttypeConfig(type) {\r\n\t\treturn typeof this.config[type] === 'object' && this.config[type] != null ? this.config : {};\r\n\t}\r\n\r\n\tstoreCallbackVariation(type, callback, proxy) {\r\n\t\tif (this.callbackMap[type] == null) {\r\n\t\t\tthis.callbackMap[type] = new WeakMap();\r\n\t\t}\r\n\r\n\t\tthis.callbackMap[type].set(callback, proxy);\r\n\t}\r\n\r\n\tgetCallbackVariation(type, callback) {\r\n\t\treturn this.callbackMap[type]?.get(callback);\r\n\t}\r\n\r\n}","import {EventProxy} from \"../../utils/eventproxy\";\r\n\r\nexport default class Subscriber {\r\n\r\n\tstatic defaults = {\r\n\t\tcheck: null,\r\n\t\tevent: null,\r\n\t\teventConfig: {},\r\n\t\ton: null,\r\n\t\toff: null,\r\n\t}\r\n\r\n\tconstructor(element, options = {}) {\r\n\t\tthis.el = element;\r\n\t\tthis.options = Object.assign({}, this.constructor.defaults, options);\r\n\t\tthis.eventProxy = new EventProxy(this.options.eventConfig);\r\n\r\n\t\tthis.bind();\r\n\t}\r\n\r\n\tdestroy() {\r\n\t\tthis.unbind();\r\n\r\n\t\tthis.eventProxy = null;\r\n\t\tthis.options = {};\r\n\t\tthis.el = null;\r\n\t}\r\n\r\n\tbind() {\r\n\t\tthis.bindOn();\r\n\t\tthis.bindEvent();\r\n\t}\r\n\r\n\tunbind() {\r\n\t\tthis.unbindOff();\r\n\t\tthis.unbindEvent();\r\n\t}\r\n\r\n\tbindOn() {\r\n\t\tif (this.options.on == null) { return; }\r\n\r\n\t\tthis.options.on(this.options.check);\r\n\t}\r\n\r\n\tunbindOff() {\r\n\t\tif (this.options.off == null) { return; }\r\n\r\n\t\tthis.options.off(this.options.check);\r\n\t}\r\n\r\n\tbindEvent() {\r\n\t\tconst event = this.options.event;\r\n\r\n\t\tif (event == null) { return; }\r\n\r\n\t\tif (typeof event === 'string') {\r\n\t\t\tthis.eventProxy.on(event, this.options.check);\r\n\t\t} else if (Array.isArray(event)) {\r\n\t\t\tevent.forEach((one) => {\r\n\t\t\t\tthis.eventProxy.on(one, this.options.check);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tconsole?.warn(`unknown event type ${typeof event}`);\r\n\t\t}\r\n\t}\r\n\r\n\tunbindEvent() {\r\n\t\tconst event = this.options.event;\r\n\r\n\t\tif (event == null) { return; }\r\n\r\n\t\tif (typeof event === 'string') {\r\n\t\t\tthis.eventProxy.off(event, this.options.check);\r\n\t\t} else if (Array.isArray(event)) {\r\n\t\t\tevent.forEach((one) => {\r\n\t\t\t\tthis.eventProxy.off(one, this.options.check);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tconsole?.warn(`unknown event type ${typeof event}`);\r\n\t\t}\r\n\t}\r\n\r\n}","import MutationFactory from \"./nodepreserver/mutationfactory\";\r\nimport Subscriber from \"./nodepreserver/subscriber\";\r\n\r\nexport default class NodePreserver {\r\n\r\n\tstatic defaults = {\r\n\t\trestore: null,\r\n\t\tsubscriber: null,\r\n\t\tmutation: true,\r\n\t}\r\n\r\n\t/** @var MutationSkeleton */\r\n\tmutation;\r\n\t/** @var Subscriber */\r\n\tsubscriber;\r\n\r\n\tconstructor(element, options = {}) {\r\n\t\tthis.el = element;\r\n\t\tthis.options = Object.assign({}, this.constructor.defaults, options);\r\n\r\n\t\tthis.install();\r\n\t}\r\n\r\n\tdestroy() {\r\n\t\tthis.uninstall();\r\n\t\tthis.options = {};\r\n\t\tthis.el = null;\r\n\t}\r\n\r\n\tinstall() {\r\n\t\tthis.installMutation();\r\n\t\tthis.installSubscriber();\r\n\t}\r\n\r\n\tuninstall() {\r\n\t\tthis.uninstallMutation();\r\n\t\tthis.uninstallSubscriber();\r\n\t}\r\n\r\n\tinstallMutation() {\r\n\t\tif (!this.isEnabled('mutation')) { return; }\r\n\r\n\t\tthis.mutation = MutationFactory.make(this.el, this.driverOptions('mutation'));\r\n\t}\r\n\r\n\tuninstallMutation() {\r\n\t\tif (this.mutation == null) { return; }\r\n\r\n\t\tthis.mutation.destroy();\r\n\t}\r\n\r\n\tinstallSubscriber() {\r\n\t\tif (!this.isEnabled('subscriber')) { return; }\r\n\r\n\t\tthis.subscriber = new Subscriber(this.el, this.driverOptions('subscriber'));\r\n\t}\r\n\r\n\tuninstallSubscriber() {\r\n\t\tif (this.subscriber == null) { return; }\r\n\r\n\t\tthis.subscriber.destroy();\r\n\t\tthis.subscriber = null;\r\n\t}\r\n\r\n\tisEnabled(type) {\r\n\t\treturn !!this.options[type];\r\n\t}\r\n\r\n\tdriverOptions(type) {\r\n\t\tconst option = typeof this.options[type] === 'object' ? this.options[type] : {};\r\n\t\tconst overrides = {\r\n\t\t\tcheck: this.check,\r\n\t\t};\r\n\r\n\t\treturn Object.assign({}, option, overrides);\r\n\t}\r\n\r\n\tcheck = () => {\r\n\t\tconst found = document.body.contains(this.el);\r\n\r\n\t\tif (!found) {\r\n\t\t\tthis.options.restore();\r\n\t\t}\r\n\r\n\t\treturn found;\r\n\t}\r\n}","export default class Template {\r\n\r\n\t/**\r\n\t * @param {string=} template\r\n\t * @param {Object} vars\r\n\t * @returns {string}\r\n\t */\r\n\tstatic compile(template, vars) {\r\n\t\tlet key;\r\n\t\tlet replaceKey;\r\n\t\tlet replaceValue;\r\n\t\tlet result = template;\r\n\r\n\t\tfor (key in vars) {\r\n\t\t\tif (!vars.hasOwnProperty(key)) { continue; }\r\n\r\n\t\t\treplaceKey = '#' + key.toUpperCase() + '#';\r\n\t\t\treplaceValue = vars[key];\r\n\r\n\t\t\tdo {\r\n\t\t\t\tresult = result.replace(replaceKey, replaceValue);\r\n\t\t\t} while (result.indexOf(replaceKey) !== -1);\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tstatic toElement(html) {\r\n\t\tconst context = document.createElement('div');\r\n\t\tcontext.innerHTML = html;\r\n\r\n\t\treturn context.firstElementChild;\r\n\t}\r\n\r\n\tstatic toElements(html) {\r\n\t\tconst context = document.createElement('div');\r\n\t\tcontext.innerHTML = html;\r\n\r\n\t\treturn [...context.children];\r\n\t}\r\n\r\n}","import SolutionRegistry from './solutionregistry';\r\nimport NodePreserver from \"./ui/nodepreserver\";\r\nimport Utils from './utils/template';\r\nimport {EventProxy} from \"./utils/eventproxy\";\r\n\r\nexport default class Factory {\r\n\r\n\tstatic defaults = {\r\n\t\tsolution: null,\r\n\t\ttemplate: '<div id=\"yandexpay\" class=\"bx-yapay-drawer\"></div>',\r\n\t\tcontainerSelector: '.bx-yapay-drawer',\r\n\t\tpreserve: false,\r\n\t\twaitLimit: 30,\r\n\t\twaitTimeout: 1000,\r\n\t}\r\n\r\n\tdefaults;\r\n\toptions;\r\n\twaitCount = 0;\r\n\r\n\tconstructor(options = {}) {\r\n\t\tthis.defaults = Object.assign({}, this.constructor.defaults);\r\n\t\tthis.options = {};\r\n\r\n\t\tthis.setOptions(options);\r\n\t\tthis.bootSolution();\r\n\t\tthis.bootLocal();\r\n\t}\r\n\r\n\tinject(selector, position) {\r\n\t\treturn Promise.resolve()\r\n\t\t\t.then(() => this.waitElement(selector))\r\n\t\t\t.then((anchor) => this.checkElement(anchor))\r\n\t\t\t.then((anchor) => {\r\n\t\t\t\tconst element = this.renderElement(anchor, position);\r\n\t\t\t\tconst widget = this.install(element);\r\n\r\n\t\t\t\tif (this.getOption('preserve')) {\r\n\t\t\t\t\tthis.preserve(selector, position, widget);\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn widget;\r\n\t\t\t})\r\n\t}\r\n\r\n\tcheckElement(anchor) {\r\n\t\tconst selector = this.getOption('containerSelector');\r\n\t\tconst contains = (\r\n\t\t\t!!anchor.querySelector(selector)\r\n\t\t\t|| this.containsSiblingElement(anchor, selector)\r\n\t\t);\r\n\r\n\t\tif (contains) {\r\n\t\t\tthrow new Error('the element already has a container');\r\n\t\t}\r\n\r\n\t\treturn anchor;\r\n\t}\r\n\r\n\tcontainsSiblingElement(anchor, selector) {\r\n\t\tlet result = false;\r\n\t\tlet next = anchor.parentElement?.firstElementChild;\r\n\r\n\t\twhile (next) {\r\n\t\t\tif (next.matches(selector) || next.querySelector(selector)) {\r\n\t\t\t\tresult = true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tnext = next.nextElementSibling;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\t\r\n\tpreserve(selector, position, widget) {\r\n\t\tconst preserver = new NodePreserver(widget.el, Object.assign({}, this.preserveOptions(), {\r\n\t\t\trestore: () => {\r\n\t\t\t\tpreserver.destroy();\r\n\t\t\t\t// noinspection JSIgnoredPromiseFromCall\r\n\t\t\t\tthis.restore(selector, position, widget);\r\n\t\t\t},\r\n\t\t}));\r\n\t}\r\n\r\n\tpreserveOptions() {\r\n\t\tconst preserveOption = this.getOption('preserve');\r\n\r\n\t\treturn typeof preserveOption === 'object' ? preserveOption : {};\r\n\t}\r\n\r\n\trestore(selector, position, widget) {\r\n\t\treturn Promise.resolve()\r\n\t\t\t.then(() => this.waitElement(selector))\r\n\t\t\t.then((anchor) => {\r\n\t\t\t\tconst element = this.renderElement(anchor, position);\r\n\r\n\t\t\t\twidget.restore(element);\r\n\r\n\t\t\t\tif (this.getOption('preserve')) {\r\n\t\t\t\t\tthis.preserve(selector, position, widget);\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn widget;\r\n\t\t\t});\r\n\t}\r\n\r\n\tinstall(element) {\r\n\t\treturn new BX.YandexPay.Widget(element);\r\n\t}\r\n\r\n\twaitElement(selector) {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tthis.waitCount = 0;\r\n\t\t\tthis.waitElementLoop(selector, resolve, reject);\r\n\t\t});\r\n\t}\r\n\r\n\twaitElementLoop(selector, resolve, reject) {\r\n\t\tconst anchor = this.findElement(selector);\r\n\r\n\t\tif (anchor) {\r\n\t\t\tresolve(anchor);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t++this.waitCount;\r\n\r\n\t\tif (this.waitCount >= this.getOption('waitLimit')) {\r\n\t\t\treject('cant find element by selector ' + selector);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tsetTimeout(this.waitElementLoop.bind(this, selector, resolve, reject), this.getOption('waitTimeout'));\r\n\t}\r\n\r\n\tfindElement(selector) {\r\n\t\tlet elementList;\r\n\t\tlet variant = selector.trim();\r\n\t\tlet result;\r\n\r\n\t\tif (variant === '') { throw new Error('widget selector is empty'); }\r\n\r\n\t\telementList = this.searchBySelector(variant) ?? this.searchById(selector) ?? this.searchByClassName(selector);\r\n\r\n\t\tif (elementList == null) { return null; }\r\n\r\n\t\tif (elementList.length > 1) {\r\n\t\t\tresult = this.reduceVisible(elementList);\r\n\t\t}\r\n\r\n\t\tif (result == null) {\r\n\t\t\tresult = elementList[0];\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tsearchBySelector(selector) {\r\n\t\ttry {\r\n\t\t\tconst result = [];\r\n\r\n\t\t\tfor (const part of selector.split(',')) { // first selector\r\n\t\t\t\tconst partSanitized = part.trim();\r\n\r\n\t\t\t\tif (partSanitized === '' || !this.isCssSelector(partSanitized)) { continue; }\r\n\r\n\t\t\t\tconst collection = document.querySelectorAll(partSanitized);\r\n\r\n\t\t\t\tfor (const element of collection) {\r\n\t\t\t\t\tresult.push(element);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn result.length > 0 ? result : null;\r\n\t\t} catch (e) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\tsearchById(selector) {\r\n\t\ttry {\r\n\t\t\tconst element = document.getElementById(selector);\r\n\r\n\t\t\treturn element != null ? [element] : null;\r\n\t\t} catch (e) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\tsearchByClassName(selector) {\r\n\t\ttry {\r\n\t\t\tconst collection = document.getElementsByClassName(selector);\r\n\r\n\t\t\treturn collection.length > 0 ? collection : null;\r\n\t\t} catch (e) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\treduceVisible(collection) {\r\n\t\tlet result = null;\r\n\t\t\r\n\t\tfor (const element of collection) {\r\n\t\t\tif (this.testVisible(element)) {\r\n\t\t\t\tresult = element;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\t\r\n\ttestVisible(element) {\r\n\t\treturn (element.offsetWidth || element.offsetHeight || element.getClientRects().length );\r\n\t}\r\n\r\n\tisCssSelector(selector) {\r\n\t\treturn /^[.#]/.test(selector);\r\n\t}\r\n\r\n\trenderElement(anchor, position) {\r\n\t\tconst selector = this.getOption('containerSelector');\r\n\t\tconst width = this.getOption('buttonWidth') || YaPay.ButtonWidth.Auto;\r\n\t\tconst html = Utils.compile(this.getOption('template'), {\r\n\t\t\tlabel: this.getOption('label'),\r\n\t\t\twidth: width.toLowerCase(),\r\n\t\t});\r\n\t\tlet elements = Utils.toElements(html);\r\n\t\tlet result = null;\r\n\r\n\t\tif (position.indexOf('after') === 0) { elements = elements.reverse(); }\r\n\r\n\t\tfor (const element of elements) {\r\n\t\t\tanchor.insertAdjacentElement(position, element);\r\n\r\n\t\t\tif (result != null) { continue; }\r\n\r\n\t\t\tresult = element.matches(selector) ? element : element.querySelector(selector);\r\n\t\t}\r\n\r\n\t\tif (result == null) {\r\n\t\t\tthrow new Error(`cant find template container by selector ${selector}`);\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tbootSolution() {\r\n\t\tconst name = this.getOption('solution');\r\n\t\tconst mode = this.getOption('mode');\r\n\t\tconst solution = SolutionRegistry.getPage(name, mode);\r\n\r\n\t\tif (solution == null) { return; }\r\n\r\n\t\tsolution.bootFactory(this);\r\n\t}\r\n\r\n\tbootLocal() {\r\n\t\tEventProxy.make().fire('bxYapayFactoryInit', {\r\n\t\t\tfactory: this,\r\n\t\t});\r\n\t}\r\n\r\n\textendDefaults(options) {\r\n\t\tthis.defaults = Object.assign(this.defaults, options);\r\n\t}\r\n\r\n\tsetOptions(options) {\r\n\t\tthis.options = Object.assign(this.options, options);\r\n\t}\r\n\r\n\tgetOption(name) {\r\n\t\treturn this.options[name] ?? this.defaults[name]\r\n\t}\r\n}","import Template from '../utils/template';\r\n\r\nexport default class AbstractStep {\r\n\r\n\tstatic defaults = {\r\n\t\ttemplate: '',\r\n\t}\r\n\r\n\tdefaults;\r\n\toptions;\r\n\twidget;\r\n\tdelayTimeouts = {};\r\n\r\n\t/**\r\n\t * @param {Widget} widget\r\n\t * @param {Object} options\r\n\t */\r\n\tconstructor(widget, options = {}) {\r\n\t\tthis.widget = widget;\r\n\t\tthis.defaults = Object.assign({}, this.constructor.defaults);\r\n\t\tthis.options = Object.assign({}, options);\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t * @param {string} name\r\n\t * @returns {*}\r\n\t */\r\n\tgetOption(name) {\r\n\t\treturn this.options[name] ?? this.widget.getOption(name) ?? this.defaults[name];\r\n\t}\r\n\r\n\t/**\r\n\t * @param {Object<Element>} node Element\r\n\t * @param {Object} data Options\r\n\t */\r\n\trender(node, data = {}) {\r\n\t\tnode.innerHTML = this.compile(data);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {Object} data\r\n\t * @returns {string}\r\n\t */\r\n\tcompile(data) {\r\n\t\treturn Template.compile(this.getOption('template'), data);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {Object<Element>} node\r\n\t */\r\n\trestore(node) {\r\n\t\t// nothing by default\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} url\r\n\t * @param {Object} data\r\n\t * @returns {Promise.<Object>}\r\n\t */\r\n\tquery(url, data) {\r\n\t\treturn fetch(url, {\r\n\t\t\tmethod: 'POST',\r\n\t\t\theaders: { 'Content-Type': 'application/json' },\r\n\t\t\tbody: JSON.stringify(data)\r\n\t\t})\r\n\t\t\t.then(response => {return response.json()})\r\n\t}\r\n\r\n\tgetTemplate(key) {\r\n\t\tlet optionKey = key + 'Template';\r\n\t\tlet option = this.options[optionKey];\r\n\t\tlet optionFirstSymbol = option.substr(0, 1);\r\n\t\tlet result;\r\n\r\n\t\tif (optionFirstSymbol === '.' || optionFirstSymbol === '#') {\r\n\t\t\tresult = this.getNode(option).innerHTML;\r\n\t\t} else {\r\n\t\t\tresult = option;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tgetElement(key, context, method) {\r\n\t\tlet selector = this.getElementSelector(key);\r\n\r\n\t\treturn this.getNode(selector, context, method || 'querySelector');\r\n\t}\r\n\r\n\tgetElementSelector(key) {\r\n\t\tlet optionKey = key + 'Element';\r\n\r\n\t\treturn this.options[optionKey];\r\n\t}\r\n\r\n\tgetNode(selector, context, method) {\r\n\t\tif (selector.substr(0, 1) === '#') { // is id query\r\n\t\t\tcontext = document;\r\n\t\t} else if (!context) {\r\n\t\t\tcontext = this.el;\r\n\t\t}\r\n\r\n\t\treturn context[method](selector);\r\n\t}\r\n\r\n\tclearDelay(name) {\r\n\t\tif (this.delayTimeouts[name] == null) { return; }\r\n\r\n\t\tclearTimeout(this.delayTimeouts[name]);\r\n\t\tthis.delayTimeouts[name] = null;\r\n\t}\r\n\r\n\tdelay(name, args = [], timeout = 300) {\r\n\t\tthis.clearDelay(name);\r\n\t\tthis.delayTimeouts[name] = setTimeout(this[name].bind(this, ...args), timeout);\r\n\t}\r\n\r\n}","import Template from \"../utils/template\";\r\n\r\nexport default class Base {\r\n\tstatic defaults = {\r\n\t\ttemplate: null,\r\n\t}\r\n\r\n\tconstructor(options = {}) {\r\n\t\tthis.options = Object.assign({}, this.constructor.defaults, options);\r\n\t\tthis.widget = null;\r\n\t}\r\n\r\n\trender(node, data = {}) {\r\n\t\tnode.innerHTML = this.compile(data);\r\n\t}\r\n\r\n\tcompile(data) {\r\n\t\treturn Template.compile(this.options.template, data);\r\n\t}\r\n\r\n\tsetWidget(widget) {\r\n\t\tthis.widget = widget;\r\n\t}\r\n\r\n\tgetOption(key) {\r\n\t\tif (key in this.options) {\r\n\t\t\treturn this.options[key];\r\n\t\t} else {\r\n\t\t\treturn this.widget.options[key];\r\n\t\t}\r\n\t}\r\n}","import Base from \"./base\";\r\nimport Template from \"../utils/template\";\r\n\r\nexport default class Form extends Base {\r\n\r\n\tstatic defaults = {\r\n\t\ttemplate: '<form name=\"form\" action=\"#ACTION#\" method=\"#METHOD#\">'\r\n\t\t\t+ '#INPUTS#'\r\n\t\t\t+ '</form>',\r\n\t}\r\n\r\n\trender(node, data) {\r\n\t\tsuper.render(node, data);\r\n\t\tthis.autosubmit(node);\r\n\t}\r\n\r\n\tcompile(data) {\r\n\t\tconst template = this.options.template;\r\n\t\tconst vars = Object.assign(data, {\r\n\t\t\t'inputs': this.makeInputs(data)\r\n\t\t});\r\n\r\n\t\treturn Template.compile(template, vars);\r\n\t}\r\n\r\n\tmakeInputs(data) {\r\n\t\tlet key;\r\n\t\tlet vars = data.params;\r\n\t\tlet value;\r\n\t\tlet template;\r\n\r\n\t\tif (Object.keys(vars).length === 0) { return ''; }\r\n\r\n\t\ttemplate = data.termUrl ? '<input type=\"hidden\" name=\"TermUrl\" value=\"' + vars.termUrl + '\">' : '';\r\n\r\n\t\tfor (key in vars)\r\n\t\t{\r\n\t\t\tif (!vars.hasOwnProperty(key)) { continue; }\r\n\r\n\t\t\tvalue = vars[key];\r\n\r\n\t\t\ttemplate += '<input type=\"hidden\" name=\"' + key + '\" value=\"' + value + '\">';\r\n\t\t}\r\n\r\n\t\treturn template;\r\n\t}\r\n\r\n\tmakeTermUrl() {\r\n\t\tlet result = this.getOption('notifyUrl');\r\n\t\tlet backUrl = window.location.href;\r\n\r\n\t\tresult +=\r\n\t\t\t(result.indexOf('?') === -1 ? '?' : '&')\r\n\t\t\t+ 'backurl=' + encodeURIComponent(backUrl)\r\n\t\t\t+ '&service=' + this.getOption('requestSign')\r\n\t\t\t+ '&paymentId=' + this.getOption('externalId');\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tautosubmit(node) {\r\n\t\tconst form = node.querySelector('form');\r\n\r\n\t\tform.submit();\r\n\t}\r\n}","import Base from \"./base\";\r\nimport Template from \"../utils/template\";\r\n\r\nexport default class Iframe extends Base {\r\n\r\n\tstatic defaults = {\r\n\t\ttemplate: '<iframe style=\"display: none;\"></iframe>',\r\n\t}\r\n\r\n\trender(node, data) {\r\n\t\tthis.insertIframe(node, data);\r\n\t}\r\n\r\n\tinsertIframe(node, data) {\r\n\t\tnode.innerHTML = Template.compile(this.options.template, data);\r\n\t\tthis.compile(node, data);\r\n\t}\r\n\r\n\tcompile(node, data) {\r\n\t\tlet iframe = node.querySelector('iframe');\r\n\t\tlet contentIframe = iframe.contentWindow || ( iframe.contentDocument.document || iframe.contentDocument);\r\n\t\tlet html = data.params;\r\n\r\n\t\tcontentIframe.document.open();\r\n\t\tcontentIframe.document.write(html);\r\n\t\tcontentIframe.document.close();\r\n\t}\r\n}","import Base from \"./base\";\r\nimport Template from \"../utils/template\";\r\n\r\nexport default class IframeRbs extends Base {\r\n\r\n\tstatic defaults = {\r\n\t\ttemplate: '<iframe style=\"display: none;\"></iframe>',\r\n\t}\r\n\r\n\trender(node, data) {\r\n\t\tthis.insertIframe(node, data);\r\n\t}\r\n\r\n\tinsertIframe(node, data) {\r\n\t\tnode.innerHTML = Template.compile(this.options.template, data);\r\n\t\tthis.compile(node, data);\r\n\t}\r\n\r\n\tcompile(node, data) {\r\n\t\tPromise.resolve()\r\n\t\t\t.then(() => this.renderIframe(node, data))\r\n\t\t\t.then(() => this.query(data));\r\n\t}\r\n\r\n\tquery (data) {\r\n\t\tfetch(this.getOption('notifyUrl'), {\r\n\t\t\tmethod: 'POST',\r\n\t\t\theaders: {\r\n\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t},\r\n\t\t\tbody: JSON.stringify({\r\n\t\t\t\tservice: this.getOption('requestSign'),\r\n\t\t\t\taccept: 'json',\r\n\t\t\t\tsecure: data.params.secure,\r\n\t\t\t\texternalId: data.params.notify.externalId,\r\n\t\t\t\tpaySystemId: data.params.notify.paySystemId\r\n\t\t\t})\r\n\t\t})\r\n\t\t\t.then(response => response.json())\r\n\t\t\t.then(result => {\r\n\t\t\t\tif (result.success === true) {\r\n\t\t\t\t\tthis.widget.go(result.state, result);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.widget.go('error', result);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.catch(error => console.log(error) );\r\n\t}\r\n\r\n\trenderIframe(node, data) {\r\n\t\tlet iframe = node.querySelector('iframe');\r\n\t\tlet contentIframe = iframe.contentWindow || ( iframe.contentDocument.document || iframe.contentDocument);\r\n\t\tlet html = `<form name=\"form\" action=\"${data.action}\" method=\"POST\">`;\r\n\r\n\t\tcontentIframe.document.open();\r\n\t\tcontentIframe.document.write(html);\r\n\t\tcontentIframe.document.close();\r\n\r\n\t\tcontentIframe.document.querySelector('form').submit();\r\n\t}\r\n}\r\n","import AbstractStep from \"./abstractstep\";\r\nimport SecureForm from \"../secure3d/form\";\r\nimport SecureIframe from \"../secure3d/iframe\";\r\nimport SecureRbs from \"../secure3d/iframerbs\";\r\n\r\nexport default class Step3ds extends AbstractStep {\r\n\r\n\trender(node, data) {\r\n\t\tconst view = this.makeView(data);\r\n\t\tview.setWidget(this.widget);\r\n\t\tview.render(node, data);\r\n\t}\r\n\r\n\tmakeView(data) {\r\n\t\tlet view = data.view;\r\n\r\n\t\tif (view === 'form') {\r\n\t\t\treturn new SecureForm();\r\n\t\t} else if (view === 'iframe') {\r\n\t\t\treturn new SecureIframe();\r\n\t\t} else if (view === 'iframerbs') {\r\n\t\t\treturn new SecureRbs();\r\n\t\t}\r\n\r\n\t\tthrow new Error('view secure3d missing')\r\n\t}\r\n}","import AbstractStep from './abstractstep';\r\n\r\nexport default class Finish extends AbstractStep {\r\n\r\n\tstatic defaults = {\r\n\t\ttemplate: '<div class=\"alert alert-success\" role=\"alert\"><strong>#MESSAGE#</strong></div>'\r\n\t}\r\n\r\n}","import AbstractStep from './abstractstep';\r\n\r\nexport default class Failure extends AbstractStep {\r\n\r\n\tstatic defaults = {\r\n\t\ttemplate: '<div class=\"alert alert-danger\" role=\"alert\"><strong>#MESSAGE#</strong></div>'\r\n\t}\r\n\r\n}","import Template from '../utils/template';\r\nimport AbstractStep from './abstractstep';\r\n\r\nconst YaPay = window.YaPay;\r\n\r\nexport default class Payment extends AbstractStep {\r\n\r\n\tstatic defaults = {\r\n\t\ttemplate: '<div class=\"alert alert-success\" role=\"alert\"><strong>#MESSAGE#</strong></div>'\r\n\t}\r\n\r\n\trender(node, data) {\r\n\t\tconst paymentData = this.getPaymentData(data);\r\n\r\n\t\tthis.createPayment(node, paymentData);\r\n\t}\r\n\r\n\tcompile(data) {\r\n\t\treturn Template.compile(this.options.template, data);\r\n\t}\r\n\r\n\tgetPaymentData(data) {\r\n\t\treturn {\r\n\t\t\tenv: this.getOption('env'),\r\n\t\t\tversion: 2,\r\n\t\t\tcountryCode: YaPay.CountryCode.Ru,\r\n\t\t\tcurrencyCode: YaPay.CurrencyCode.Rub,\r\n\t\t\tmerchant: {\r\n\t\t\t\tid: this.getOption('merchantId'),\r\n\t\t\t\tname: this.getOption('merchantName')\r\n\t\t\t},\r\n\t\t\torder: {\r\n\t\t\t\tid: data.id,\r\n\t\t\t\ttotal: { amount: data.total },\r\n\t\t\t\titems: data.items\r\n\t\t\t},\r\n\t\t\tpaymentMethods: [\r\n\t\t\t\t{\r\n\t\t\t\t\ttype: YaPay.PaymentMethodType.Card,\r\n\t\t\t\t\tgateway: this.getOption('gateway'),\r\n\t\t\t\t\tgatewayMerchantId: this.getOption('gatewayMerchantId'),\r\n\t\t\t\t\tallowedAuthMethods: [YaPay.AllowedAuthMethod.PanOnly],\r\n\t\t\t\t\tallowedCardNetworks: [\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.UnionPay,\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.Uzcard,\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.Discover,\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.AmericanExpress,\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.Visa,\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.Mastercard,\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.Mir,\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.Maestro,\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.VisaElectron\r\n\t\t\t\t\t]\r\n\t\t\t\t}\r\n\t\t\t],\r\n\t\t}\r\n\t}\r\n\r\n\tcreatePayment(node, paymentData) {\r\n\t\t// Создать платеж.\r\n\t\tYaPay.createPayment(paymentData, { agent: { name: \"CMS-Bitrix\", version: \"1.0\" } })\r\n\t\t\t.then( (payment) => {\r\n\t\t\t\t// Создать экземпляр кнопки.\r\n\t\t\t\tlet button = payment.createButton({\r\n\t\t\t\t\ttype: YaPay.ButtonType.Pay,\r\n\t\t\t\t\ttheme: this.getOption('buttonTheme') || YaPay.ButtonTheme.Black,\r\n\t\t\t\t\twidth: this.getOption('buttonWidth') || YaPay.ButtonWidth.Auto,\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Смонтировать кнопку в DOM.\r\n\t\t\t\tbutton.mount(node);\r\n\r\n\t\t\t\t// Подписаться на событие click.\r\n\t\t\t\tbutton.on(YaPay.ButtonEventType.Click, function onPaymentButtonClick() {\r\n\t\t\t\t\t// Запустить оплату после клика на кнопку.\r\n\t\t\t\t\tpayment.checkout();\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Подписаться на событие process.\r\n\t\t\t\tpayment.on(YaPay.PaymentEventType.Process, (event) => {\r\n\t\t\t\t\t// Получить платежный токен.\r\n\t\t\t\t\tthis.notify(payment, event).then((result) => {\r\n\t\t\t\t\t});\r\n\t\t\t\t\t/*alert('Payment token — ' + event.token);\r\n\r\n\t\t\t\t\t// Опционально (если выполнить шаг 7).\r\n\t\t\t\t\talert('Billing email — ' + event.billingContact.email);\r\n\r\n\t\t\t\t\t// Закрыть форму Yandex Pay.\r\n\t\t\t\t\t*/\r\n\t\t\t\t\tpayment.complete(YaPay.CompleteReason.Success);\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Подписаться на событие error.\r\n\t\t\t\tpayment.on(YaPay.PaymentEventType.Error, function onPaymentError(event) {\r\n\t\t\t\t\t// Вывести информацию о недоступности оплаты в данный момент\r\n\t\t\t\t\t// и предложить пользователю другой способ оплаты.\r\n\r\n\t\t\t\t\t// Закрыть форму Yandex.Pay.\r\n\t\t\t\t\tconsole.log({'errors': event});\r\n\t\t\t\t\tpayment.complete(YaPay.CompleteReason.Error);\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Подписаться на событие abort.\r\n\t\t\t\t// Это когда пользователь закрыл форму Yandex Pay.\r\n\t\t\t\tpayment.on(YaPay.PaymentEventType.Abort, function onPaymentAbort(event) {\r\n\t\t\t\t\t// Предложить пользователю другой способ оплаты.\r\n\t\t\t\t});\r\n\t\t\t})\r\n\t\t\t.catch(function (err) {\r\n\t\t\t\t// Платеж не создан.\r\n\t\t\t\tconsole.log({'payment not create': err});\r\n\t\t\t});\r\n\t}\r\n\r\n\tnotify(payment, yandexPayData) {\r\n\t\treturn fetch(this.getOption('notifyUrl'), {\r\n\t\t\tmethod: 'POST',\r\n\t\t\theaders: {\r\n\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t},\r\n\t\t\tbody: JSON.stringify({\r\n\t\t\t\tservice: this.getOption('requestSign'),\r\n\t\t\t\taccept: 'json',\r\n\t\t\t\tyandexData: yandexPayData,\r\n\t\t\t\texternalId: this.getOption('externalId'),\r\n\t\t\t\tpaySystemId: this.getOption('paySystemId')\r\n\t\t\t})\r\n\t\t})\r\n\t\t\t.then(response => response.json())\r\n\t\t\t.then(result => {\r\n\t\t\t\tif (result.success === true) {\r\n\t\t\t\t\tthis.widget.go(result.state, result);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.widget.go('error', result);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.catch(error => console.log(error) );\r\n\t}\r\n}","export function ready(callback) {\r\n\tif (document.readyState === 'complete' || document.readyState === 'interactive') {\r\n\t\tsetTimeout(callback, 1);\r\n\t} else {\r\n\t\tdocument.addEventListener('DOMContentLoaded', callback);\r\n\t}\r\n}","import Template from '../utils/template';\r\nimport AbstractStep from './abstractstep';\r\nimport { ready } from \"../utils/ready\";\r\n\r\nconst YaPay = window.YaPay;\r\n\r\nexport default class Cart extends AbstractStep {\r\n\r\n\tstatic defaults = {\r\n\t\tloaderTemplate: '<div class=\"bx-yapay-skeleton-loading width--#WIDTH#\"></div>',\r\n\t\tloaderSelector: '.bx-yapay-skeleton-loading',\r\n\t}\r\n\r\n\trender(node, data) {\r\n\t\tthis.isBootstrap = false;\r\n\t\tthis.element = node;\r\n\t\tthis.paymentData = this.getPaymentData(data);\r\n\t\tthis.paymentButton = null;\r\n\r\n\t\tthis.bootSolution();\r\n\t\tthis.insertLoader();\r\n\t\tthis.setupPaymentCash();\r\n\t\tthis.delayBootstrap();\r\n\t}\r\n\r\n\tcompile(data) {\r\n\t\treturn Template.compile(this.options.template, data);\r\n\t}\r\n\r\n\trestore(node) {\r\n\t\tthis.element = node;\r\n\t\tthis.restoreButton(node);\r\n\t}\r\n\r\n\tbootSolution() {\r\n\t\tconst solution = this.widget.getSolution();\r\n\r\n\t\tif (solution == null) { return; }\r\n\r\n\t\tsolution.bootCart(this);\r\n\t}\r\n\r\n\tdelayChangeOffer(productId) {\r\n\t\tthis.delay('changeOffer', [productId]);\r\n\t}\r\n\r\n\tdelayBootstrap() {\r\n\t\tready(() => {\r\n\t\t\tthis.delay('bootstrap');\r\n\t\t});\r\n\t}\r\n\r\n\tbootstrap() {\r\n\t\tthis.isBootstrap = true;\r\n\r\n\t\tthis.getProducts()\r\n\t\t\t.then((result) => {\r\n\r\n\t\t\t\tif (result.error) { throw new Error(result.error.message); }\r\n\r\n\t\t\t\tthis.combineOrderWithProducts(result);\r\n\t\t\t\tthis.createPayment(this.element, this.paymentData);\r\n\r\n\t\t\t})\r\n\t\t\t.catch((error) => {\r\n\t\t\t\t//this.showError('bootstrap', '', error);\r\n\t\t\t});\r\n\t}\r\n\r\n\tchangeOffer(newProductId) {\r\n\r\n\t\tif (!this.isBootstrap) { return; }\r\n\r\n\t\tlet productId = this.getOption('productId');\r\n\r\n\t\tif (productId !== newProductId) { // todo in items\r\n\t\t\tthis.widget.setOptions({productId: newProductId});\r\n\t\t\tthis.getProducts().then((result) => {\r\n\t\t\t\tthis.combineOrderWithProducts(result);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tsetupPaymentCash(){\r\n\t\t// Указываем возможность оплаты заказа при получении\r\n\t\tif (this.getOption('paymentCash') == null) { return; }\r\n\r\n\t\tthis.paymentData.paymentMethods.push({\r\n\t\t\ttype: YaPay.PaymentMethodType.Cash,\r\n\t\t});\r\n\t}\r\n\r\n\tgetPaymentData(data) {\r\n\t\treturn {\r\n\t\t\tenv: this.getOption('env'),\r\n\t\t\tversion: 2,\r\n\t\t\tcountryCode: YaPay.CountryCode.Ru,\r\n\t\t\tcurrencyCode: YaPay.CurrencyCode.Rub,\r\n\t\t\tmerchant: {\r\n\t\t\t\tid: this.getOption('merchantId'),\r\n\t\t\t\tname: this.getOption('merchantName'),\r\n\t\t\t\turl: this.getOption('siteUrl')\r\n\t\t\t},\r\n\t\t\torder: { id: '0' },\r\n\t\t\tpaymentMethods: [\r\n\t\t\t\t{\r\n\t\t\t\t\ttype: YaPay.PaymentMethodType.Card,\r\n\t\t\t\t\tgateway: this.getOption('gateway'),\r\n\t\t\t\t\tgatewayMerchantId: this.getOption('gatewayMerchantId'),\r\n\t\t\t\t\tallowedAuthMethods: [YaPay.AllowedAuthMethod.PanOnly],\r\n\t\t\t\t\tallowedCardNetworks: [\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.UnionPay,\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.Uzcard,\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.Discover,\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.AmericanExpress,\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.Visa,\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.Mastercard,\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.Mir,\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.Maestro,\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.VisaElectron\r\n\t\t\t\t\t]\r\n\t\t\t\t}\r\n\t\t\t],\r\n\r\n\t\t\trequiredFields: {\r\n\r\n\t\t\t\tbillingContact: {\r\n\t\t\t\t\temail: this.getOption('useEmail') || false\r\n\t\t\t\t},\r\n\r\n\t\t\t\tshippingContact: {\r\n\t\t\t\t\tname: this.getOption('useName') || false,\r\n\t\t\t\t\temail: this.getOption('useEmail') || false,\r\n\t\t\t\t\tphone: this.getOption('usePhone') || false,\r\n\t\t\t\t},\r\n\r\n\t\t\t\tshippingTypes: {\r\n\t\t\t\t\tdirect: true,\r\n\t\t\t\t\tpickup: true,\r\n\t\t\t\t},\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tcreatePayment(node, paymentData) {\r\n\t\t// Создать платеж.\r\n\t\tYaPay.createPayment(paymentData, { agent: { name: \"CMS-Bitrix\", version: \"1.0\" } })\r\n\t\t\t.then((payment) => {\r\n\t\t\t\tthis.removeLoader();\r\n\t\t\t\tthis.mountButton(node, payment);\r\n\r\n\t\t\t\t// Подписаться на событие process.\r\n\t\t\t\tpayment.on(YaPay.PaymentEventType.Process, (event) => {\r\n\t\t\t\t\t// Получить платежный токен.\r\n\t\t\t\t\tthis.orderAccept(event).then((result) => {\r\n\r\n\t\t\t\t\t\tif (result.error) { throw new Error(result.error.message, result.error.code); }\r\n\r\n\t\t\t\t\t\tif(!this.isPaymentTypeCash(event)) {\r\n\t\t\t\t\t\t\tthis.notify(result, event).then(result => {\r\n\t\t\t\t\t\t\t\tif (result.success === true) {\r\n\t\t\t\t\t\t\t\t\tthis.widget.go(result.state, result);\r\n\t\t\t\t\t\t\t\t\tpayment.complete(YaPay.CompleteReason.Success);\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tthis.widget.go('error', result);\r\n\t\t\t\t\t\t\t\t\tpayment.complete(YaPay.CompleteReason.Error);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tpayment.complete(YaPay.CompleteReason.Success);\r\n\r\n\t\t\t\t\t\t\tif (result.redirect != null) {\r\n\t\t\t\t\t\t\t\twindow.location.href = result.redirect;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch((error) => {\r\n\t\t\t\t\t\tthis.showError('yapayProcess', '', error); // todo test it\r\n\t\t\t\t\t\tpayment.complete(YaPay.CompleteReason.Error);\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Подписаться на событие error.\r\n\t\t\t\tpayment.on(YaPay.PaymentEventType.Error, (event) => {\r\n\t\t\t\t\tthis.showError('yapayError', 'service temporary unavailable');\r\n\t\t\t\t\tpayment.complete(YaPay.CompleteReason.Error);\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Подписаться на событие change.\r\n\t\t\t\tpayment.on(YaPay.PaymentEventType.Change, (event) => {\r\n\r\n\t\t\t\t\tif (event.shippingAddress) {\r\n\t\t\t\t\t\tthis.getShippingOptions(event.shippingAddress).then((result) => {\r\n\t\t\t\t\t\t\tpayment.update({shippingOptions: result})\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (event.shippingOption){\r\n\t\t\t\t\t\tpayment.update({\r\n\t\t\t\t\t\t\torder: this.combineOrderWithDirectShipping(event.shippingOption),\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (event.pickupBounds) {\r\n\t\t\t\t\t\tthis.getPickupOptions(event.pickupBounds).then((result) => {\r\n\t\t\t\t\t\t\tpayment.update({pickupPoints: result})\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (event.pickupPoint) {\r\n\t\t\t\t\t\tpayment.update({\r\n\t\t\t\t\t\t\torder: this.combineOrderWithPickupShipping(event.pickupPoint),\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t});\r\n\t\t\t})\r\n\t\t\t.catch((err) => {\r\n\t\t\t\tthis.showError('yapayPayment','payment not created', err);\r\n\t\t\t});\r\n\t}\r\n\r\n\tmountButton(node, payment) {\r\n\t\tthis.paymentButton = payment.createButton({\r\n\t\t\ttype: YaPay.ButtonType.Checkout,\r\n\t\t\ttheme: this.getOption('buttonTheme') || YaPay.ButtonTheme.Black,\r\n\t\t\twidth: this.getOption('buttonWidth') || YaPay.ButtonWidth.Auto,\r\n\t\t});\r\n\r\n\t\tthis.paymentButton.mount(this.element);\r\n\r\n\t\tthis.paymentButton.on(YaPay.ButtonEventType.Click, () => {\r\n\t\t\tpayment.checkout();\r\n\t\t});\r\n\t}\r\n\r\n\trestoreButton(node) {\r\n\t\tif (this.paymentButton == null) {\r\n\t\t\tthis.insertLoader();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//this.removeLoader();\r\n\t\tthis.paymentButton.mount(node);\r\n\t}\r\n\r\n\tisPaymentTypeCash(event) {\r\n\t\treturn (event.paymentMethodInfo.type === 'CASH');\r\n\t}\r\n\r\n\tgetProducts(){\r\n\r\n\t\tlet data = {\r\n\t\t\tyapayAction: 'getProducts',\r\n\t\t\tproductId: this.getOption('productId'),\r\n\t\t\tmode: this.getOption('mode'),\r\n\t\t\tsetupId: this.getOption('setupId')\r\n\t\t};\r\n\r\n\t\treturn this.query(this.getOption('purchaseUrl'), data);\r\n\t}\r\n\r\n\tnotify(payment, yandexPayData) {\r\n\r\n\t\tlet data = {\r\n\t\t\tservice: this.getOption('requestSign'),\r\n\t\t\taccept: 'json',\r\n\t\t\tyandexData: yandexPayData,\r\n\t\t\texternalId: payment.externalId,\r\n\t\t\tpaySystemId: payment.paySystemId\r\n\t\t};\r\n\r\n\t\treturn this.query(this.getOption('notifyUrl'), data);\r\n\t}\r\n\r\n\torderAccept(event) {\r\n\r\n\t\tlet deliveryType = event.shippingMethodInfo.shippingOption ? 'delivery' : 'pickup';\r\n\t\tlet delivery;\r\n\r\n\t\tif (deliveryType === 'pickup') {\r\n\t\t\tdelivery = {\r\n\t\t\t\taddress: event.shippingMethodInfo.pickupPoint.address,\r\n\t\t\t\tpickup: event.shippingMethodInfo.pickupPoint,\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tdelivery = {\r\n\t\t\t\taddress: event.shippingMethodInfo.shippingAddress,\r\n\t\t\t\tdelivery: event.shippingMethodInfo.shippingOption,\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet orderData = {\r\n\t\t\tsetupId: this.getOption('setupId'),\r\n\t\t\titems: this.paymentData.order.items,\r\n\t\t\tpayment: event.paymentMethodInfo,\r\n\t\t\tcontact: event.shippingContact,\r\n\t\t\tyapayAction: 'orderAccept',\r\n\t\t\tdeliveryType: deliveryType,\r\n\t\t\tpaySystemId: this.isPaymentTypeCash(event) ? this.getOption('paymentCash') : this.getOption('paySystemId'),\r\n\t\t\torderAmount: event.orderAmount\r\n\t\t};\r\n\r\n\t\tlet data = {...orderData, ...delivery };\r\n\r\n\t\treturn this.query(this.getOption('purchaseUrl'), data);\r\n\t}\r\n\r\n\tgetShippingOptions(address) {\r\n\r\n\t\tlet data = {\r\n\t\t\taddress: address,\r\n\t\t\tyapayAction: 'deliveryOptions',\r\n\t\t\titems: this.paymentData.order.items,\r\n\t\t\tsetupId: this.getOption('setupId'),\r\n\t\t};\r\n\r\n\t\treturn this.query(this.getOption('purchaseUrl'), data);\r\n\t}\r\n\r\n\tgetPickupOptions(bounds) {\r\n\r\n\t\tlet data = {\r\n\t\t\tbounds: bounds,\r\n\t\t\tyapayAction: 'pickupOptions',\r\n\t\t\titems: this.paymentData.order.items,\r\n\t\t\tsetupId: this.getOption('setupId'),\r\n\t\t};\r\n\r\n\t\treturn this.query(this.getOption('purchaseUrl'), data);\r\n\t}\r\n\r\n\tcombineOrderWithPickupShipping(pickupOption) {\r\n\t\tconst { order } = this.paymentData;\r\n\r\n\t\treturn {\r\n\t\t\t...order,\r\n\t\t\titems: [\r\n\t\t\t\t...order.items,\r\n\t\t\t\t{\r\n\t\t\t\t\ttype: 'SHIPPING',\r\n\t\t\t\t\tlabel: pickupOption.label,\r\n\t\t\t\t\tamount: pickupOption.amount,\r\n\t\t\t\t},\r\n\t\t\t],\r\n\t\t\ttotal: {\r\n\t\t\t\t...order.total,\r\n\t\t\t\tamount: this.amountSum(order.total.amount, pickupOption.amount),\r\n\t\t\t},\r\n\t\t};\r\n\t}\r\n\r\n\tcombineOrderWithDirectShipping(shippingOption) {\r\n\t\tconst { order } = this.paymentData;\r\n\r\n\t\treturn {\r\n\t\t\t...order,\r\n\t\t\titems: [\r\n\t\t\t\t...order.items,\r\n\t\t\t\t{\r\n\t\t\t\t\ttype: 'SHIPPING',\r\n\t\t\t\t\tlabel: shippingOption.label,\r\n\t\t\t\t\tamount: shippingOption.amount,\r\n\t\t\t\t},\r\n\t\t\t],\r\n\t\t\ttotal: {\r\n\t\t\t\t...order.total,\r\n\t\t\t\tamount: this.amountSum(order.total.amount, shippingOption.amount),\r\n\t\t\t},\r\n\t\t};\r\n\t}\r\n\r\n\tcombineOrderWithProducts(products) {\r\n\t\tconst { order } = this.paymentData;\r\n\r\n\t\tlet exampleOrder = {\r\n\t\t\t...order,\r\n\t\t\titems: products.items,\r\n\t\t\ttotal: {\r\n\t\t\t\tamount: products.amount,\r\n\t\t\t},\r\n\t\t};\r\n\r\n\t\tObject.assign(this.paymentData.order, exampleOrder);\r\n\t}\r\n\r\n\tamountSum(amountA, amountB) {\r\n\t\treturn (Number(amountA) + Number(amountB)).toFixed(2);\r\n\t}\r\n\r\n\tshowError(type, message, err = null) {\r\n\t\tlet notify = type + ' - ' + message;\r\n\r\n\t\tif (err) {\r\n\t\t\tnotify += ' ' + err;\r\n\t\t}\r\n\r\n\t\talert(notify);\r\n\t}\r\n\r\n\tinsertLoader() {\r\n\t\tconst width = this.getOption('buttonWidth') || YaPay.ButtonWidth.Auto;\r\n\r\n\t\tthis.element.innerHTML = Template.compile(this.getOption('loaderTemplate'), {\r\n\t\t\twidth: width.toLowerCase(),\r\n\t\t\tlabel: this.getOption('label'),\r\n\t\t});\r\n\t}\r\n\r\n\tremoveLoader() {\r\n\t\tconst loader = this.element.querySelector(this.getOption('loaderSelector'));\r\n\r\n\t\tif (loader == null) { return; }\r\n\r\n\t\tloader.remove();\r\n\t}\r\n}","import Secure3d from './secure3d';\r\nimport Finish from './finish';\r\nimport Failure from './failure';\r\nimport Payment from './payment';\r\nimport Cart from \"./cart\";\r\n\r\nexport default class Factory {\r\n\r\n\t/**\r\n\t * @param {string} type\r\n\t * @param {Widget} widget\r\n\t * @param {Object} options\r\n\t * @returns {Cart|Finish|Step3ds|Payment|Failure}\r\n\t * @throws {Error}\r\n\t */\r\n\tstatic make(type, widget, options = {}) {\r\n\t\tif (type === '3ds') {\r\n\t\t\treturn new Secure3d(widget, options);\r\n\t\t} else if (type === 'finished') {\r\n\t\t\treturn new Finish(widget, options);\r\n\t\t} else if (type === 'error') {\r\n\t\t\treturn new Failure(widget, options);\r\n\t\t} else if (type === 'payment') {\r\n\t\t\treturn new Payment(widget, options);\r\n\t\t} else if (type === 'cart'){\r\n\t\t\treturn new Cart(widget, options);\r\n\t\t}\r\n\r\n\t\tthrow new Error('unknown step ' + type);\r\n\t}\r\n\r\n}","import StepFactory from './step/factory';\r\nimport SolutionRegistry from \"./solutionregistry\";\r\n\r\nexport default class Widget {\r\n\r\n\tstatic defaults = {}\r\n\r\n\tdefaults;\r\n\toptions;\r\n\tel;\r\n\tstep;\r\n\r\n\t/**\r\n\t * @param {Object<Element>} element\r\n\t * @param {Object} options\r\n\t */\r\n\tconstructor(element, options = {}) {\r\n\t\tthis.defaults = Object.assign({}, this.constructor.defaults);\r\n\t\tthis.options = {};\r\n\t\tthis.el = element;\r\n\r\n\t\tthis.setOptions(options);\r\n\t\tthis.bootSolution();\r\n\t}\r\n\r\n\t/**\r\n\t * @param {Object} data\r\n\t */\r\n\tpayment(data) {\r\n\t\tthis.go('payment', data);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {Object} data\r\n\t */\r\n\tcart(data){\r\n\t\tthis.go('cart', data);\r\n\t}\r\n\r\n\trestore(element) {\r\n\t\tthis.el = element;\r\n\t\tthis.step?.restore(element);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} type\r\n\t * @param {Object} data\r\n\t */\r\n\tgo(type, data) {\r\n\t\tthis.step = this.makeStep(type);\r\n\t\tthis.step.render(this.el, data);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {String} type\r\n\t * @returns {Cart|Finish|Step3ds|Payment|Failure}\r\n\t * @throws {Error}\r\n\t */\r\n\tmakeStep(type) {\r\n\t\tconst options = this.getOption(type) || {};\r\n\r\n\t\treturn StepFactory.make(type, this, options);\r\n\t}\r\n\r\n\tgetSolution() {\r\n\t\tconst name = this.getOption('solution');\r\n\t\tconst mode = this.getOption('mode');\r\n\r\n\t\treturn SolutionRegistry.getPage(name, mode);\r\n\t}\r\n\r\n\tbootSolution() {\r\n\t\tconst solution = this.getSolution();\r\n\r\n\t\tif (solution == null) { return; }\r\n\r\n\t\tsolution.bootWidget(this);\r\n\t}\r\n\r\n\textendDefaults(options) {\r\n\t\tthis.defaults = Object.assign(this.defaults, options);\r\n\t}\r\n\r\n\tsetOptions(options) {\r\n\t\tthis.options = Object.assign(this.options, options);\r\n\t}\r\n\r\n\tgetOption(name) {\r\n\t\treturn this.options[name] ?? this.defaults[name];\r\n\t}\r\n}\r\n"],"names":["SolutionRegistry","name","factory","window","BX","YandexPay","Solution","console","warn","mode","key","pages","createPage","getFactory","create","MutationSkeleton","element","options","el","Object","assign","constructor","defaults","check","MutationLoop","loopTimeout","loopCancel","clearTimeout","_loopTimeout","setTimeout","loop","timeout","MutationObserver","mutations","mutation","removedNodes","removedNode","HTMLElement","contains","runCheck","observe","disconnect","anchor","getAnchor","observer","listener","childList","subtree","delay","_checkTimeout","document","body","closest","MutationFactory","EventProxy","config","callbackMap","callback","matchEvent","onBxEvent","onJQueryEvent","onPlainEvent","offBxEvent","offJQueryEvent","offPlainEvent","data","fireBxEvent","fireJQueryEvent","firePlainEvent","type","addCustomEvent","removeCustomEvent","onCustomEvent","jQuery","selfConfig","typeConfig","canProxyCallback","originalCallback","evt","proxyData","originalEvent","detail","storeCallbackVariation","on","getCallbackVariation","off","hasPlainAndJQueryCollision","triggerHandler","CustomEvent","addEventListener","removeEventListener","dispatchEvent","plainConfig","proxy","WeakMap","set","get","Subscriber","eventProxy","eventConfig","bind","unbind","bindOn","bindEvent","unbindOff","unbindEvent","event","Array","isArray","forEach","one","NodePreserver","found","restore","install","uninstall","installMutation","installSubscriber","uninstallMutation","uninstallSubscriber","isEnabled","make","driverOptions","destroy","subscriber","option","overrides","Template","template","vars","replaceKey","replaceValue","result","hasOwnProperty","toUpperCase","replace","indexOf","html","context","createElement","innerHTML","firstElementChild","children","Factory","setOptions","bootSolution","bootLocal","selector","position","Promise","resolve","then","waitElement","checkElement","renderElement","widget","getOption","preserve","querySelector","containsSiblingElement","Error","next","parentElement","matches","nextElementSibling","preserver","preserveOptions","preserveOption","Widget","reject","waitCount","waitElementLoop","findElement","elementList","variant","trim","searchBySelector","searchById","searchByClassName","length","reduceVisible","split","part","partSanitized","isCssSelector","collection","querySelectorAll","push","e","getElementById","getElementsByClassName","testVisible","offsetWidth","offsetHeight","getClientRects","test","width","YaPay","ButtonWidth","Auto","Utils","compile","label","toLowerCase","elements","toElements","reverse","insertAdjacentElement","solution","getPage","bootFactory","fire","containerSelector","waitLimit","waitTimeout","AbstractStep","node","url","fetch","method","headers","JSON","stringify","response","json","optionKey","optionFirstSymbol","substr","getNode","getElementSelector","delayTimeouts","args","clearDelay","Base","Form","autosubmit","makeInputs","params","value","keys","termUrl","backUrl","location","href","encodeURIComponent","form","submit","Iframe","insertIframe","iframe","contentIframe","contentWindow","contentDocument","open","write","close","IframeRbs","renderIframe","query","service","accept","secure","externalId","notify","paySystemId","success","go","state","error","log","action","Step3ds","view","makeView","setWidget","render","SecureForm","SecureIframe","SecureRbs","Finish","Failure","Payment","paymentData","getPaymentData","createPayment","env","version","countryCode","CountryCode","Ru","currencyCode","CurrencyCode","Rub","merchant","id","order","total","amount","items","paymentMethods","PaymentMethodType","Card","gateway","gatewayMerchantId","allowedAuthMethods","AllowedAuthMethod","PanOnly","allowedCardNetworks","AllowedCardNetwork","UnionPay","Uzcard","Discover","AmericanExpress","Visa","Mastercard","Mir","Maestro","VisaElectron","agent","payment","button","createButton","ButtonType","Pay","theme","ButtonTheme","Black","mount","ButtonEventType","Click","onPaymentButtonClick","checkout","PaymentEventType","Process","complete","CompleteReason","Success","onPaymentError","Abort","onPaymentAbort","err","yandexPayData","yandexData","ready","readyState","Cart","isBootstrap","paymentButton","insertLoader","setupPaymentCash","delayBootstrap","restoreButton","getSolution","bootCart","productId","getProducts","message","combineOrderWithProducts","newProductId","Cash","requiredFields","billingContact","email","shippingContact","phone","shippingTypes","direct","pickup","removeLoader","mountButton","orderAccept","code","isPaymentTypeCash","redirect","showError","Change","shippingAddress","getShippingOptions","update","shippingOptions","shippingOption","combineOrderWithDirectShipping","pickupBounds","getPickupOptions","pickupPoints","pickupPoint","combineOrderWithPickupShipping","Checkout","paymentMethodInfo","yapayAction","setupId","deliveryType","shippingMethodInfo","delivery","address","orderData","contact","orderAmount","bounds","pickupOption","amountSum","products","exampleOrder","amountA","amountB","Number","toFixed","alert","loader","remove","loaderTemplate","loaderSelector","Secure3d","step","makeStep","StepFactory","bootWidget"],"mappings":"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"}