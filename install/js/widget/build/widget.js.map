{"version":3,"file":"widget.js","sources":["../ui/nodepreserver/mutationskeleton.js","../ui/nodepreserver/mutationloop.js","../ui/nodepreserver/mutationobserver.js","../utils/eventproxy.js","../ui/nodepreserver/subscriber.js","../ui/nodepreserver/composite.js","../ui/nodepreserver.js","../ui/nodepreserver/mutationfactory.js","../utils/template.js","../sdkloader.js","../intersection.js","../ui/display/display.js","../ui/display/button.js","../ui/display/widget.js","../ui/display/factory.js","../concurrency.js","../factory.js","../solutionregistry.js","../step/abstractstep.js","../secure3d/base.js","../secure3d/form.js","../secure3d/iframe.js","../secure3d/iframerbs.js","../step/secure3d.js","../step/finish.js","../step/failure.js","../step/loader.js","../step/divider.js","../step/cart/proxy.js","../step/cart/rest.js","../step/cart/site.js","../step/cart/cart.js","../utils/ready.js","../step/payment/proxy.js","../step/payment/rest.js","../step/payment/site.js","../step/payment/payment.js","../ui/loader/loader.js","../ui/loader/button.js","../ui/loader/widget/compact.js","../ui/loader/widget/mini.js","../ui/loader/widget/split.js","../widget.js","../ui/loader/factory.js","../ui/loader/widget/factory.js","../step/factory.js","../index.js"],"sourcesContent":["export default class MutationSkeleton {\r\n\r\n\tstatic defaults = {\r\n\t\tcheck: null,\r\n\t}\r\n\r\n\tconstructor(element, options = {}) {\r\n\t\tthis.el = element;\r\n\t\tthis.options = Object.assign({}, this.constructor.defaults, options);\r\n\t}\r\n\r\n\tdestroy() {\r\n\r\n\t}\r\n\r\n}","import MutationSkeleton from \"./mutationskeleton\";\r\n\r\nexport default class MutationLoop extends MutationSkeleton {\r\n\r\n\tstatic defaults = Object.assign({}, MutationSkeleton.defaults, {\r\n\t\ttimeout: 1000,\r\n\t})\r\n\r\n\tconstructor(element, options = {}) {\r\n\t\tsuper(element, options);\r\n\t\tthis.loopTimeout();\r\n\t}\r\n\r\n\tdestroy() {\r\n\t\tthis.loopCancel();\r\n\t}\r\n\r\n\tloopTimeout() {\r\n\t\tclearTimeout(this._loopTimeout);\r\n\t\tthis._loopTimeout = setTimeout(this.loop, this.options.timeout);\r\n\t}\r\n\r\n\tloopCancel() {\r\n\t\tclearTimeout(this._loopTimeout);\r\n\t}\r\n\r\n\tloop = () => {\r\n\t\tthis.options.check() && this.loopTimeout();\r\n\t}\r\n\r\n}","import MutationSkeleton from \"./mutationskeleton\";\r\n\r\nexport default class MutationObserver extends MutationSkeleton {\r\n\r\n\tstatic defaults = Object.assign({}, MutationSkeleton.defaults, {\r\n\t\tanchor: null,\r\n\t\tdelay: 0,\r\n\t})\r\n\r\n\tconstructor(element, options = {}) {\r\n\t\tsuper(element, options);\r\n\t\tthis.observe();\r\n\t}\r\n\r\n\tdestroy() {\r\n\t\tthis.disconnect();\r\n\t}\r\n\r\n\tobserve() {\r\n\t\tconst anchor = this.getAnchor();\r\n\r\n\t\tif (anchor == null) {\r\n\t\t\tconsole?.warn('cant find anchor for node preserver');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.observer = new window.MutationObserver(this.listener);\r\n\t\tthis.observer.observe(anchor, {\r\n\t\t\tchildList: true,\r\n\t\t\tsubtree: true,\r\n\t\t});\r\n\t}\r\n\r\n\tdisconnect() {\r\n\t\tif (this.observer == null) { return; }\r\n\r\n\t\tthis.observer.disconnect();\r\n\t\tthis.observer = null;\r\n\t}\r\n\r\n\tlistener = (mutations) => {\r\n\t\tfor (const mutation of mutations) {\r\n\t\t\tif (mutation.removedNodes == null) { continue; }\r\n\r\n\t\t\tfor (const removedNode of mutation.removedNodes) {\r\n\t\t\t\tif (!(removedNode instanceof HTMLElement)) { continue; }\r\n\r\n\t\t\t\tif (removedNode === this.el || removedNode.contains(this.el)) {\r\n\t\t\t\t\tthis.runCheck();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\trunCheck() {\r\n\t\tconst delay = this.options.delay;\r\n\r\n\t\tif (delay == null) {\r\n\t\t\tthis.options.check();\r\n\t\t} else {\r\n\t\t\tclearTimeout(this._checkTimeout);\r\n\t\t\tthis._checkTimeout = setTimeout(() => { this.options.check(); }, delay);\r\n\t\t}\r\n\t}\r\n\r\n\tgetAnchor() {\r\n\t\tif (this.options.anchor == null) { return document.body; }\r\n\r\n\t\tlet matched = null;\r\n\r\n\t\tfor (let selector of this.options.anchor.split(',')) {\r\n\t\t\tselector = selector.trim();\r\n\r\n\t\t\tif (selector === '') { continue; }\r\n\r\n\t\t\tmatched = this.el.closest(selector);\r\n\r\n\t\t\tif (matched != null) { break; }\r\n\t\t}\r\n\r\n\t\treturn matched;\r\n\t}\r\n\r\n}","export class EventProxy {\n\n\tstatic make(config = {}) {\n\t\treturn new EventProxy(config);\n\t}\n\n\tconstructor(config = {}) {\n\t\tthis.config = config;\n\t\tthis.callbackMap = {};\n\t}\n\n\ton(name, callback) {\n\t\tthis.matchEvent('bx') && this.onBxEvent(name, callback);\n\t\tthis.matchEvent('jquery') && this.onJQueryEvent(name, callback);\n\t\tthis.matchEvent('plain') && this.onPlainEvent(name, callback);\n\t}\n\n\toff(name, callback) {\n\t\tthis.matchEvent('bx') && this.offBxEvent(name, callback);\n\t\tthis.matchEvent('jquery') && this.offJQueryEvent(name, callback);\n\t\tthis.matchEvent('plain') && this.offPlainEvent(name, callback);\n\t}\n\n\tfire(name, data = {}) {\n\t\tthis.matchEvent('bx') && this.fireBxEvent(name, data);\n\t\tthis.matchEvent('jquery') && this.fireJQueryEvent(name, data);\n\t\tthis.matchEvent('plain') && this.firePlainEvent(name, data);\n\t}\n\n\tmatchEvent(type) {\n\t\treturn this.config[type] != null ? !!this.config[type] : !this.config['strict'];\n\t}\n\n\tonBxEvent(name, callback) {\n\t\tif (typeof BX === 'undefined' || BX.addCustomEvent == null) { return; }\n\n\t\tBX.addCustomEvent(name, callback);\n\t}\n\n\toffBxEvent(name, callback) {\n\t\tif (typeof BX === 'undefined' || BX.removeCustomEvent == null) { return; }\n\n\t\tBX.removeCustomEvent(name, callback);\n\t}\n\n\tfireBxEvent(name, data) {\n\t\tif (typeof BX === 'undefined' || BX.onCustomEvent == null) { return; }\n\n\t\tBX.onCustomEvent(name, [data]);\n\t}\n\n\tonJQueryEvent(name, callback) {\n\t\tif (typeof jQuery === 'undefined') { return; }\n\n\t\tconst selfConfig = this.typeConfig('jquery');\n\n\t\tif (this.canProxyCallback(selfConfig)) {\n\t\t\tconst originalCallback = callback;\n\n\t\t\tcallback = (...args) => {\n\t\t\t\toriginalCallback(...args);\n\t\t\t};\n\n\t\t\tthis.pushCallbackVariation('jquery', originalCallback, callback);\n\t\t}\n\n\t\tjQuery(document).on(name, callback);\n\t}\n\n\toffJQueryEvent(name, callback) {\n\t\tif (typeof jQuery === 'undefined') { return; }\n\n\t\tconst selfConfig = this.typeConfig('jquery');\n\n\t\tif (this.canProxyCallback(selfConfig)) {\n\t\t\tcallback = this.popCallbackVariation('jquery', callback);\n\n\t\t\tif (callback == null) { return; }\n\t\t}\n\n\t\tjQuery(document).off(name, callback);\n\t}\n\n\tfireJQueryEvent(name, data) {\n\t\tif (typeof jQuery === 'undefined') { return; }\n\t\tif (this.hasPlainAndJQueryCollision()) { return; }\n\n\t\tjQuery(document).triggerHandler(new CustomEvent(name, { \"detail\": data }));\n\t}\n\n\tonPlainEvent(name, callback) {\n\t\tif (this.hasPlainAndJQueryCollision()) { return; }\n\n\t\tconst selfConfig = this.typeConfig('plain');\n\n\t\tif (this.canProxyCallback(selfConfig)) {\n\t\t\tconst originalCallback = callback;\n\n\t\t\tcallback = (evt) => {\n\t\t\t\toriginalCallback(evt.detail);\n\t\t\t};\n\n\t\t\tthis.pushCallbackVariation('plain', originalCallback, callback);\n\t\t}\n\n\t\tdocument.addEventListener(name, callback);\n\t}\n\n\toffPlainEvent(name, callback) {\n\t\tif (this.hasPlainAndJQueryCollision()) { return; }\n\n\t\tconst selfConfig = this.typeConfig('plain');\n\n\t\tif (this.canProxyCallback(selfConfig)) {\n\t\t\tcallback = this.popCallbackVariation('plain', callback);\n\n\t\t\tif (callback == null) { return; }\n\t\t}\n\n\t\tdocument.removeEventListener(name, callback);\n\t}\n\n\tfirePlainEvent(name, data) {\n\t\tdocument.dispatchEvent(new CustomEvent(name, { \"detail\": data }));\n\t}\n\n\thasPlainAndJQueryCollision() {\n\t\tif (!this.matchEvent('plain') || !this.matchEvent('jquery')) { return false; }\n\n\t\tconst plainConfig = this.typeConfig('plain');\n\n\t\treturn (plainConfig['force'] !== true && typeof jQuery !== 'undefined');\n\t}\n\n\tcanProxyCallback(selfConfig) {\n\t\treturn selfConfig['proxy'] !== false;\n\t}\n\n\ttypeConfig(type) {\n\t\treturn typeof this.config[type] === 'object' && this.config[type] != null ? this.config : {};\n\t}\n\n\tpushCallbackVariation(type, callback, proxy) {\n\t\tif (this.callbackMap[type] == null) {\n\t\t\tthis.callbackMap[type] = new WeakMap();\n\t\t}\n\n\t\tthis.callbackMap[type].set(callback, proxy);\n\t}\n\n\tpopCallbackVariation(type, callback) {\n\t\tif (this.callbackMap[type] == null) { return null; }\n\n\t\tconst map = this.callbackMap[type];\n\t\tconst result = map.get(callback);\n\n\t\tif (result != null) {\n\t\t\tmap.delete(callback);\n\t\t}\n\n\t\treturn result;\n\t}\n\n}","import {EventProxy} from \"../../utils/eventproxy\";\r\n\r\nexport default class Subscriber {\r\n\r\n\tstatic defaults = {\r\n\t\tcheck: null,\r\n\t\tevent: null,\r\n\t\tconfig: {},\r\n\t\ton: null,\r\n\t\toff: null,\r\n\t}\r\n\r\n\tconstructor(element, options = {}) {\r\n\t\tthis.el = element;\r\n\t\tthis.options = Object.assign({}, this.constructor.defaults, options);\r\n\t\tthis.eventProxy = new EventProxy(this.options.config);\r\n\r\n\t\tthis.bind();\r\n\t}\r\n\r\n\tdestroy() {\r\n\t\tthis.unbind();\r\n\r\n\t\tthis.eventProxy = null;\r\n\t\tthis.options = {};\r\n\t\tthis.el = null;\r\n\t}\r\n\r\n\tbind() {\r\n\t\tthis.bindOn();\r\n\t\tthis.bindEvent();\r\n\t}\r\n\r\n\tunbind() {\r\n\t\tthis.unbindOff();\r\n\t\tthis.unbindEvent();\r\n\t}\r\n\r\n\tbindOn() {\r\n\t\tif (this.options.on == null) { return; }\r\n\r\n\t\tthis.options.on(this.options.check);\r\n\t}\r\n\r\n\tunbindOff() {\r\n\t\tif (this.options.off == null) { return; }\r\n\r\n\t\tthis.options.off(this.options.check);\r\n\t}\r\n\r\n\tbindEvent() {\r\n\t\tconst event = this.options.event;\r\n\r\n\t\tif (event == null) { return; }\r\n\r\n\t\tif (typeof event === 'string') {\r\n\t\t\tthis.eventProxy.on(event, this.options.check);\r\n\t\t} else if (Array.isArray(event)) {\r\n\t\t\tevent.forEach((one) => {\r\n\t\t\t\tthis.eventProxy.on(one, this.options.check);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tconsole?.warn(`unknown event type ${typeof event}`);\r\n\t\t}\r\n\t}\r\n\r\n\tunbindEvent() {\r\n\t\tconst event = this.options.event;\r\n\r\n\t\tif (event == null) { return; }\r\n\r\n\t\tif (typeof event === 'string') {\r\n\t\t\tthis.eventProxy.off(event, this.options.check);\r\n\t\t} else if (Array.isArray(event)) {\r\n\t\t\tevent.forEach((one) => {\r\n\t\t\t\tthis.eventProxy.off(one, this.options.check);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tconsole?.warn(`unknown event type ${typeof event}`);\r\n\t\t}\r\n\t}\r\n\r\n}","export default class Composite {\r\n\r\n\tstatic defaults = {\r\n\t\tcheck: null,\r\n\t}\r\n\r\n\tconstructor(element: HTMLElement, options: Object = {}) {\r\n\t\tthis.el = element;\r\n\t\tthis.options = Object.assign({}, this.constructor.defaults, options);\r\n\r\n\t\tthis.boot();\r\n\t}\r\n\r\n\tdestroy() {\r\n\t\tif (typeof BX !== 'undefined') { return; }\r\n\r\n\t\tBX?.removeCustomEvent('onFrameDataReceived', this.onFrameReady);\r\n\t}\r\n\r\n\tboot() {\r\n\t\tconst anchor = this.anchor();\r\n\r\n\t\tif (typeof BX !== 'undefined' && anchor == null) { return; }\r\n\r\n\t\tBX?.addCustomEvent('onFrameDataReceived', this.onFrameReady);\r\n\t}\r\n\r\n\tonFrameReady = () => {\r\n\t\tthis.options.check();\r\n\t}\r\n\r\n\tanchor() {\r\n\t\tlet parent = this.el.parentElement;\r\n\r\n\t\twhile (parent) {\r\n\t\t\tlet start = false;\r\n\t\t\tlet nodes = [];\r\n\r\n\t\t\tfor (const child of parent.children) {\r\n\t\t\t\tif (child.id == null != null && /^bxdynamic_.*_start$/.test(child.id)) {\r\n\t\t\t\t\tstart = true;\r\n\t\t\t\t} else if (child.id == null != null && /^bxdynamic_.*_end$/.test(child.id)) {\r\n\t\t\t\t\tstart = false;\r\n\r\n\t\t\t\t\tfor (const node of nodes) {\r\n\t\t\t\t\t\tif (node === this.el || node.contains(this.el)) {\r\n\t\t\t\t\t\t\treturn node;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tnodes = [];\r\n\t\t\t\t} else if (start) {\r\n\t\t\t\t\tnodes.push(child);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tparent = parent.parentElement;\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n}","import MutationFactory from \"./nodepreserver/mutationfactory\";\r\nimport Subscriber from \"./nodepreserver/subscriber\";\r\nimport Composite from \"./nodepreserver/composite\";\r\n\r\nexport default class NodePreserver {\r\n\r\n\tstatic defaults = {\r\n\t\trestore: null,\r\n\t\tsubscriber: null,\r\n\t\tmutation: true,\r\n\t\tcomposite: true,\r\n\t}\r\n\r\n\t/** @var MutationSkeleton */\r\n\tmutation;\r\n\t/** @var Subscriber */\r\n\tsubscriber;\r\n\t/** @var Composite */\r\n\tcomposite;\r\n\r\n\tconstructor(element, options = {}) {\r\n\t\tthis.el = element;\r\n\t\tthis.options = Object.assign({}, this.constructor.defaults, options);\r\n\r\n\t\tthis.install();\r\n\t}\r\n\r\n\tdestroy() {\r\n\t\tthis.uninstall();\r\n\t\tthis.options = {};\r\n\t\tthis.el = null;\r\n\t}\r\n\r\n\tinstall() {\r\n\t\tthis.installMutation();\r\n\t\tthis.installSubscriber();\r\n\t\tthis.installComposite();\r\n\t}\r\n\r\n\tuninstall() {\r\n\t\tthis.uninstallMutation();\r\n\t\tthis.uninstallSubscriber();\r\n\t\tthis.uninstallComposite();\r\n\t}\r\n\r\n\tinstallMutation() {\r\n\t\tif (!this.isEnabled('mutation')) { return; }\r\n\r\n\t\tthis.mutation = MutationFactory.make(this.el, this.driverOptions('mutation'));\r\n\t}\r\n\r\n\tuninstallMutation() {\r\n\t\tif (this.mutation == null) { return; }\r\n\r\n\t\tthis.mutation.destroy();\r\n\t}\r\n\r\n\tinstallSubscriber() {\r\n\t\tif (!this.isEnabled('subscriber')) { return; }\r\n\r\n\t\tthis.subscriber = new Subscriber(this.el, this.driverOptions('subscriber'));\r\n\t}\r\n\r\n\tuninstallSubscriber() {\r\n\t\tif (this.subscriber == null) { return; }\r\n\r\n\t\tthis.subscriber.destroy();\r\n\t\tthis.subscriber = null;\r\n\t}\r\n\r\n\tinstallComposite() {\r\n\t\tif (!this.isEnabled('composite')) { return; }\r\n\r\n\t\tthis.composite = new Composite(this.el, this.driverOptions('composite'));\r\n\t}\r\n\r\n\tuninstallComposite() {\r\n\t\tif (this.composite == null) { return; }\r\n\r\n\t\tthis.composite.destroy();\r\n\t}\r\n\r\n\tisEnabled(type) {\r\n\t\treturn !!this.options[type];\r\n\t}\r\n\r\n\tdriverOptions(type) {\r\n\t\tconst option = typeof this.options[type] === 'object' ? this.options[type] : {};\r\n\t\tconst overrides = {\r\n\t\t\tcheck: this.check,\r\n\t\t};\r\n\r\n\t\treturn Object.assign({}, option, overrides);\r\n\t}\r\n\r\n\tcheck = () => {\r\n\t\tconst found = document.body.contains(this.el);\r\n\r\n\t\tif (!found) {\r\n\t\t\tthis.options.restore();\r\n\t\t}\r\n\r\n\t\treturn found;\r\n\t}\r\n}","import MutationLoop from \"./mutationloop\";\r\nimport MutationObserver from \"./mutationobserver\";\r\n\r\nexport default class MutationFactory {\r\n\r\n\tstatic make(element, options) {\r\n\t\tif (typeof window.MutationObserver === 'function') {\r\n\t\t\treturn new MutationObserver(element, options);\r\n\t\t}\r\n\r\n\t\treturn new MutationLoop(element, options);\r\n\t}\r\n\r\n}","export default class Template {\r\n\r\n\t/**\r\n\t * @param {string=} template\r\n\t * @param {Object} vars\r\n\t * @returns {string}\r\n\t */\r\n\tstatic compile(template, vars) {\r\n\t\tlet key;\r\n\t\tlet replaceKey;\r\n\t\tlet replaceValue;\r\n\t\tlet result = template;\r\n\r\n\t\tfor (key in vars) {\r\n\t\t\tif (!vars.hasOwnProperty(key)) { continue; }\r\n\r\n\t\t\treplaceKey = '#' + key.toUpperCase() + '#';\r\n\t\t\treplaceValue = vars[key];\r\n\r\n\t\t\tdo {\r\n\t\t\t\tresult = result.replace(replaceKey, replaceValue);\r\n\t\t\t} while (result.indexOf(replaceKey) !== -1);\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tstatic toElement(html) {\r\n\t\tconst context = document.createElement('div');\r\n\t\tcontext.innerHTML = html;\r\n\r\n\t\treturn context.firstElementChild;\r\n\t}\r\n\r\n\tstatic toElements(html) {\r\n\t\tconst context = document.createElement('div');\r\n\t\tcontext.innerHTML = html;\r\n\r\n\t\treturn [...context.children];\r\n\t}\r\n\r\n}","export class Sdkloader {\r\n\r\n\tstatic instance = null;\r\n\r\n\tstatic getInstance() {\r\n\t\tif (this.instance == null) {\r\n\t\t\tthis.instance = new Sdkloader();\r\n\t\t}\r\n\r\n\t\treturn this.instance;\r\n\t}\r\n\r\n\tload() : Promise {\r\n\t\tif (this._loadPromise != null) { return this._loadPromise; }\r\n\r\n\t\tthis._loadPromise = new Promise((resolve, reject) => {\r\n\t\t\tif (this.testGlobal()) {\r\n\t\t\t\tresolve();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst script = document.createElement('script');\r\n\t\t\tconst anchor = document.getElementsByTagName(\"script\")[0] || document.body;\r\n\r\n\t\t\tscript.type = \"text/javascript\";\r\n\t\t\tscript.async = true;\r\n\t\t\tscript.src = 'https://pay.yandex.ru/sdk/v1/pay.js';\r\n\r\n\t\t\tscript.onload = () => {\r\n\t\t\t\tthis.loopGlobal(() => {\r\n\t\t\t\t\tthis._loadPromise = null;\r\n\t\t\t\t\tresolve();\r\n\t\t\t\t});\r\n\t\t\t};\r\n\t\t\tscript.onerror = () => {\r\n\t\t\t\tthis._loadPromise = null;\r\n\t\t\t\tscript.remove();\r\n\r\n\t\t\t\treject(new Error('cant load yandex pay sdk library'));\r\n\t\t\t};\r\n\r\n\t\t\tanchor.parentNode.insertBefore(script, anchor);\r\n\t\t});\r\n\r\n\t\treturn this._loadPromise;\r\n\t}\r\n\r\n\tloopGlobal(resolve) : void {\r\n\t\tif (this.testGlobal()) {\r\n\t\t\tresolve();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tsetTimeout(() => { this.loopGlobal(resolve) }, 100);\r\n\t}\r\n\r\n\ttestGlobal() : boolean {\r\n\t\treturn window.YaPay?.createPayment != null;\r\n\t}\r\n}","export class Intersection {\r\n\r\n\tstatic defaults = {};\r\n\r\n\tobserver;\r\n\r\n\tconstructor(element: HTMLElement, options: Object = {}) {\r\n\t\tthis.el = element;\r\n\t\tthis.options = Object.assign({}, this.constructor.defaults, options);\r\n\t}\r\n\r\n\twait() : Promise {\r\n\t\treturn new Promise((resolve) => {\r\n\t\t\tif (typeof IntersectionObserver === 'undefined') {\r\n\t\t\t\tresolve(this.el);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis.observer = new IntersectionObserver((entries, observer) => {\r\n\t\t\t\tentries.forEach((entry) => {\r\n\t\t\t\t\tif (entry.isIntersecting) {\r\n\t\t\t\t\t\tconst element = entry.target;\r\n\t\t\t\t\t\tobserver.unobserve(element);\r\n\t\t\t\t\t\tresolve(element);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\tthis.observer.observe(this.el);\r\n\t\t});\r\n\t}\r\n\r\n\trestore(node: HTMLElement) : void {\r\n\t\tthis.observer?.unobserve(this.el);\r\n\t\tthis.el = node;\r\n\t\tthis.observer?.observe(this.el);\r\n\t}\r\n}","import Utils from \"../../utils/template\";\n\nexport default class Display {\n\n\tstatic defaults = {\n\n\t}\n\n\tconstructor(factory, options) {\n\t\tthis.factory = factory;\n\t\tthis.options = Object.assign({}, this.constructor.defaults, options);\n\t}\n\n\tstyle() {\n\n\t}\n\n\tmount(node, payment, type) {\n\n\t}\n\n\tunmount(node, payment) {\n\n\t}\n\n\tgetOption(name) {\n\t\treturn this.options[name];\n\t}\n\n\tsetProperty () {\n\n\t}\n\n\tremoveProperty() {\n\n\t}\n}","import Display from './display';\nimport Utils from \"../../utils/template\";\n\nexport default class Button extends Display {\n\n\tstatic defaults = {\n\t\tstyle: `<style>#STYLE#</style>`,\n\t\tstyleHeight: `##ID# .ya-pay-button, ##ID# .bx-yapay-skeleton-loading {height:#HEIGHT#px;}`,\n\t\tstyleBorder: `##ID# .ya-pay-button, ##ID# .bx-yapay-skeleton-load {border-radius:#BORDER#px;}`,\n\t\tstyleWidth: `##ID# .ya-pay-button, ##ID# .bx-yapay-skeleton-loading, ##ID# .bx-yapay-divider{width: #WIDTH#px;}`,\n\t}\n\n\tstyle() {\n\t\tconst collectHeight = this.collectHeight();\n\t\tconst collectBorder = this.collectBorder();\n\t\tconst collectWidth = this.collectWidth();\n\n\t\treturn Utils.compile(this.getOption('style'), {\n\t\t\tstyle: collectHeight + collectBorder + collectWidth,\n\t\t});\n\t}\n\n\tmount(node, payment, type) {\n\t\tconst theme = this.getOption('VARIANT_BUTTON') || YaPay.ButtonTheme.Black;\n\t\tconst width = this.getOption('WIDTH_BUTTON') || YaPay.ButtonWidth.Max;\n\n\t\tpayment.mountButton(node, {\n\t\t\ttype: type,\n\t\t\ttheme: theme,\n\t\t\twidth: width !== 'OWN' ? width : YaPay.ButtonWidth.Max\n\t\t});\n\t}\n\n\tunmount(node, payment) {\n\t\tpayment.unmountButton(node);\n\t}\n\n\tcollectHeight() {\n\n\t\tlet result = '';\n\n\t\tconst heightVariant = this.getOption('HEIGHT_TYPE_BUTTON') || null;\n\n\t\tif (heightVariant == null) {\n\t\t\treturn result;\n\t\t}\n\n\t\tresult = Utils.compile(this.getOption('styleHeight'), {\n\t\t\tid: this.factory.getOption('containerId'),\n\t\t\theight: this.getOption('HEIGHT_VALUE_BUTTON') || '54',\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tcollectBorder() {\n\t\tlet result = '';\n\n\t\tconst borderVariant = this.getOption('BORDER_RADIUS_TYPE_BUTTON') || null;\n\n\t\tif (borderVariant == null) {\n\t\t\treturn result;\n\t\t}\n\n\t\tresult = Utils.compile(this.getOption('styleBorder'), {\n\t\t\tid: this.factory.getOption('containerId'),\n\t\t\tborder: this.getOption('BORDER_RADIUS_VALUE_BUTTON') ?? '8',\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tcollectWidth() {\n\t\tlet result = '';\n\n\t\tconst widthVariant = this.getOption('WIDTH_BUTTON');\n\n\t\tif (widthVariant !== 'OWN') {\n\t\t\treturn result;\n\t\t}\n\n\t\tresult = Utils.compile(this.getOption('styleWidth'), {\n\t\t\tid: this.factory.getOption('containerId'),\n\t\t\twidth: this.getOption('WIDTH_VALUE_BUTTON') || '282',\n\t\t});\n\n\t\treturn result;\n\t}\n\n\twidth() {\n\t\tlet width = this.getOption('WIDTH_BUTTON') || 'MAX';\n\n\t\tif (width === 'OWN'){\n\t\t\twidth = 'MAX';\n\t\t}\n\n\t\treturn width;\n\t}\n}","import Display from './display';\nimport Utils from \"../../utils/template\";\n\nexport default class Widget extends Display {\n\n\tstatic defaults = {\n\t\tstyle: `<style>#STYLE#</style>`,\n\t\tstyleBorder: `##ID# .bx-yapay-skeleton-loading-button, ##ID# .bx-yapay-skeleton-loading-description {border-radius:#BORDER#px !important;}`,\n\t\tstyleWidth: `##ID# .ya-pay-widget, ##ID# .bx-yapay-skeleton-loading, ##ID# .bx-yapay-divider{width: #WIDTH#px !important;}`,\n\t}\n\n\tstyle() {\n\t\tconst collectBorder = this.collectBorder();\n\t\tconst collectWidth = this.collectWidth();\n\n\t\treturn Utils.compile(this.getOption('style'), {\n\t\t\tstyle: collectBorder + collectWidth,\n\t\t});\n\t}\n\n\tmount(node, payment, type) {\n\t\tconst borderType = this.getOption('BORDER_RADIUS_TYPE_WIDGET');\n\t\tlet borderValue = this.getOption('BORDER_RADIUS_VALUE_WIDGET') || '8';\n\n\t\tif (borderType == null) { borderValue = '8'; }\n\n\t\tpayment.mountWidget(node, {\n\t\t\twidgetType: this.getOption('TYPE_WIDGET') || YaPay.WidgetType.Compact,\n\t\t\twidgetTheme: this.getOption('THEME_WIDGET') || YaPay.WidgetTheme.Dark,\n\t\t\tbuttonTheme: this.getOption('BUTTON_THEME_WIDGET') || YaPay.ButtonTheme.Black,\n\t\t\tborderRadius: borderValue,\n\t\t\tbnplSelected: !!Number(this.getOption('SPLIT_SELECT_WIDGET') || false),\n\t\t});\n\t}\n\n\tunmount(node, payment) {\n\t\tpayment.unmountWidget(node);\n\t}\n\n\tcollectBorder() {\n\t\tlet result = '';\n\n\t\tconst borderVariant = this.getOption('BORDER_RADIUS_TYPE_WIDGET') || null;\n\n\t\tif (borderVariant == null) {\n\t\t\treturn result;\n\t\t}\n\n\t\tresult = Utils.compile(this.getOption('styleBorder'), {\n\t\t\tid: this.factory.getOption('containerId'),\n\t\t\tborder: this.getOption('BORDER_RADIUS_VALUE_WIDGET') ?? '8',\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tcollectWidth() {\n\t\tlet result = '';\n\n\t\tconst widthVariant = this.getOption('WIDTH_TYPE_WIDGET') || null;\n\n\t\tif (widthVariant == null) {\n\t\t\treturn result;\n\t\t}\n\n\t\tresult = Utils.compile(this.getOption('styleWidth'), {\n\t\t\tid: this.factory.getOption('containerId'),\n\t\t\twidth: this.getOption('WIDTH_VALUE_WIDGET') || '282',\n\t\t});\n\n\t\treturn result;\n\t}\n\n\twidth() {\n\t\treturn 'MAX';\n\t}\n\n\tsetProperty(node) {\n\t\tconst typeWidget = this.getOption('TYPE_WIDGET');\n\t\tconst splitSelect = this.getOption('SPLIT_SELECT_WIDGET');\n\n\t\tif (typeWidget == null) { return; }\n\n\t\tif (typeWidget === 'BnplOffer') {\n\t\t\tif (splitSelect === '1') {\n\t\t\t\tnode.style.setProperty('min-height', '435px');\n\t\t\t} else {\n\t\t\t\tnode.style.setProperty('min-height', '301px');\n\t\t\t}\n\t\t} else if (typeWidget === 'Mini') {\n\t\t\tnode.style.setProperty('min-height', '80px');\n\t\t} else if (typeWidget === 'Compact') {\n\t\t\tnode.style.setProperty('min-height', '166px');\n\t\t} else if (typeWidget === 'Compact') {\n\t\t\tnode.style.setProperty('min-height', '166px');\n\t\t} else if (typeWidget === 'BnplRequired') {\n\t\t\tnode.style.setProperty('min-height', '435px');\n\t\t}\n\t}\n\n\tremoveProperty(node) {\n\t\tsetTimeout(() => {\n\t\t\tnode.style.removeProperty('min-height');\n\t\t}, 1200);\n\t}\n}","import Button from \"./button\";\r\nimport Widget from \"./widget\";\r\n\r\nexport default class Factory {\r\n\r\n\t/**\r\n\t * @param {string} type\r\n\t * @param {Factory} factory\r\n\t * @param {Object} options\r\n\t * @returns {Button|Widget}\r\n\t * @throws {Error}\r\n\t */\r\n\tstatic make(type, factory, options) {\r\n\t\tif (type === 'Button') {\r\n\t\t\treturn new Button(factory, options);\r\n\t\t} else if (type === 'Widget') {\r\n\t\t\treturn new Widget(factory, options);\r\n\t\t}\r\n\r\n\t\tthrow new Error('unknown display ' + type);\r\n\t}\r\n\r\n}","export class Concurrency {\n\n\tstatic elements = {};\n\n\tstatic push(mode: string, widget: Widget) : void {\n\t\tif (this.elements[mode] == null) {\n\t\t\tthis.elements[mode] = [];\n\t\t}\n\n\t\tthis.elements[mode].push(widget);\n\t}\n\n\tstatic pop(mode: string, widget: Widget) : void {\n\t\tconst index = this.elements[mode].indexOf(widget);\n\n\t\tif (index === -1) { return; }\n\n\t\tthis.elements[mode].splice(index, 1);\n\t}\n\n\tstatic same(mode: string) : Array {\n\t\treturn this.elements[mode] ?? [];\n\t}\n\n}","import SolutionRegistry from './solutionregistry';\nimport NodePreserver from \"./ui/nodepreserver\";\nimport Utils from './utils/template';\nimport {EventProxy} from \"./utils/eventproxy\";\nimport {Sdkloader} from \"./sdkloader\";\nimport {Intersection} from \"./intersection\";\nimport Display from \"./ui/display/factory\";\nimport {Concurrency} from \"./concurrency\";\n\nexport default class Factory {\n\n\tstatic defaults = {\n\t\tsolution: null,\n\t\ttemplate:\n\t\t\t'<div id=\"#ID#\" ' +\n\t\t\t\t'class=\"bx-yapay-drawer-container ' +\n\t\t\t\t'yapay-behavior--#MODE# ' +\n\t\t\t\t'yapay-display--#DISPLAY# #WIDGET_TYPE# '+\n\t\t\t\t'yapay-width--#WIDTH# ' +\n\t\t\t\t'yapay-solution--#SOLUTION#\">' +\n\t\t\t\t'#STYLE#' +\n\t\t\t\t'<div class=\"bx-yapay-drawer\"></div>' +\n\t\t\t'</div>',\n\t\tuseDivider: false,\n\t\tcontainerSelector: '.bx-yapay-drawer',\n\t\tevent: null,\n\t\teventConfig: {},\n\t\tpreserve: {\n\t\t\tcomposite: true,\n\t\t},\n\t\twaitLimit: 30,\n\t\twaitTimeout: 1000,\n\t}\n\n\tdefaults;\n\toptions;\n\twaitCount = 0;\n\tsolution;\n\n\tconstructor(options = {}) {\n\t\tthis.defaults = Object.assign({}, this.constructor.defaults);\n\t\tthis.options = {};\n\n\t\tthis.setOptions(options);\n\t\tthis.createSolution();\n\t\tthis.bootSolution();\n\t\tthis.bootLocal();\n\t}\n\n\tinject(selector, position) {\n\t\tlet selectorSanitized;\n\n\t\treturn Promise.resolve()\n\t\t\t.then(() => {\n\t\t\t\tselectorSanitized = this.filterMedia(selector);\n\t\t\t})\n\t\t\t.then(() => this.waitEvent())\n\t\t\t.then(() => this.waitElement(selectorSanitized))\n\t\t\t.then((anchor) => this.checkElement(anchor))\n\t\t\t.then((anchor) => this.renderElement(anchor, position))\n\t\t\t.then((element) => this.install(element))\n\t\t\t.then((widget) => this.insertToolsDisplay(widget))\n\t\t\t.then((widget) => {\n\t\t\t\tconst intersection = new Intersection(widget.el);\n\t\t\t\t\n\t\t\t\tif (this.getOption('preserve')) {\n\t\t\t\t\tthis.preserve(selectorSanitized, position, widget, intersection);\n\t\t\t\t}\n\n\t\t\t\treturn intersection.wait().then(() => widget);\n\t\t\t})\n\t\t\t.then((widget) => this.testConcurrency(widget))\n\t\t\t.then((widget) => Sdkloader.getInstance().load().then(() => widget));\n\t}\n\n\tfilterMedia(selector: string) : string {\n\t\tconst resultParts = [];\n\n\t\tfor (const part of selector.split(',')) {\n\t\t\tconst partSanitized = part.trim();\n\n\t\t\tif (partSanitized === '') { continue; }\n\n\t\t\tconst [partSelector, matchMedia] = this.testSelectorMedia(partSanitized);\n\n\t\t\tif (!matchMedia) { continue; }\n\n\t\t\tresultParts.push(partSelector);\n\t\t}\n\n\t\tif (resultParts.length === 0) {\n\t\t\tthrow new Error('widget not matched any media of ' + selector);\n\t\t}\n\n\t\treturn resultParts.join(',');\n\t}\n\n\tcheckElement(anchor) {\n\t\tconst selector = this.containerSelector();\n\t\tconst contains = (\n\t\t\t!!anchor.querySelector(selector)\n\t\t\t|| this.containsSiblingElement(anchor, selector)\n\t\t);\n\n\t\tif (contains) {\n\t\t\tthrow new Error('the element already has a container');\n\t\t}\n\n\t\treturn anchor;\n\t}\n\n\tcontainerSelector() {\n\t\treturn '#' + this.getOption('containerId') + ' ' + this.getOption('containerSelector');\n\t}\n\n\tcontainsSiblingElement(anchor, selector) {\n\t\tlet result = false;\n\t\tlet next = anchor.parentElement?.firstElementChild;\n\n\t\twhile (next) {\n\t\t\tif (next.matches(selector) || next.querySelector(selector)) {\n\t\t\t\tresult = true;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tnext = next.nextElementSibling;\n\t\t}\n\n\t\treturn result;\n\t}\n\t\n\tpreserve(selector, position, widget, intersection) {\n\t\tconst preserver = new NodePreserver(widget.el, Object.assign({}, this.preserveOptions(), {\n\t\t\trestore: () => {\n\t\t\t\tpreserver.destroy();\n\t\t\t\t// noinspection JSIgnoredPromiseFromCall\n\t\t\t\tthis.restore(selector, position, widget, intersection);\n\t\t\t},\n\t\t}));\n\n\t\twidget.setPreserver(preserver);\n\t}\n\n\tpreserveOptions() {\n\t\tconst preserveOption = this.getOption('preserve');\n\n\t\treturn typeof preserveOption === 'object' ? preserveOption : {};\n\t}\n\n\trestore(selector, position, widget, intersection) {\n\t\treturn Promise.resolve()\n\t\t\t.then(() => this.waitElement(selector))\n\t\t\t.then((anchor) => {\n\t\t\t\tconst element = this.renderElement(anchor, position);\n\n\t\t\t\twidget.restore(element);\n\t\t\t\tintersection?.restore(element);\n\n\t\t\t\tif (this.getOption('preserve')) {\n\t\t\t\t\tthis.preserve(selector, position, widget, intersection);\n\t\t\t\t}\n\n\t\t\t\treturn widget;\n\t\t\t});\n\t}\n\n\ttestConcurrency(widget) {\n\t\tconst mode = this.getOption('mode');\n\n\t\tif (mode == null) { return widget; }\n\n\t\tfor (const sibling of Concurrency.same(mode)) {\n\t\t\tif (document.documentElement.contains(sibling.el)) { continue; }\n\n\t\t\tsibling.destroy();\n\t\t\tConcurrency.pop(mode, sibling);\n\t\t}\n\n\t\tConcurrency.push(mode, widget);\n\n\t\treturn widget;\n\t}\n\n\tinstall(element) {\n\t\tconst widget = new BX.YandexPay.Widget(element, this.options);\n\n\t\twidget.setSolution(this.solution);\n\t\twidget.boot();\n\n\t\treturn widget;\n\t}\n\n\tinsertToolsDisplay(widget) {\n\t\twidget.bootToolsDisplay();\n\t\treturn widget;\n\t}\n\n\twaitEvent() {\n\t\tconst name = this.getOption('event');\n\n\t\tif (name == null) { return null; }\n\n\t\treturn new Promise((resolve) => {\n\t\t\tconst eventProxy = EventProxy.make(this.getOption('eventConfig'));\n\t\t\tconst callback = () => {\n\t\t\t\teventProxy.off(name, callback);\n\t\t\t\tresolve();\n\t\t\t};\n\n\t\t\teventProxy.on(name, callback);\n\t\t});\n\t}\n\n\twaitElement(selector) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.waitCount = 0;\n\t\t\tthis.waitElementLoop(selector, resolve, reject);\n\t\t});\n\t}\n\n\twaitElementLoop(selector, resolve, reject) {\n\t\tconst anchor = this.findElement(selector);\n\n\t\tif (anchor) {\n\t\t\tresolve(anchor);\n\t\t\treturn;\n\t\t}\n\n\t\t++this.waitCount;\n\n\t\tif (this.waitCount >= this.getOption('waitLimit')) {\n\t\t\treject('cant find element by selector ' + selector);\n\t\t\treturn;\n\t\t}\n\n\t\tsetTimeout(this.waitElementLoop.bind(this, selector, resolve, reject), this.getOption('waitTimeout'));\n\t}\n\n\tfindElement(selector) {\n\t\tlet elementList;\n\t\tlet variant = selector.trim();\n\t\tlet result;\n\n\t\tif (variant === '') { throw new Error('widget selector is empty'); }\n\n\t\telementList = this.searchBySelector(variant) ?? this.searchById(selector) ?? this.searchByClassName(selector);\n\n\t\tif (elementList == null) { return null; }\n\n\t\tif (elementList.length > 1) {\n\t\t\tresult = this.reduceVisible(elementList);\n\t\t}\n\n\t\tif (result == null) {\n\t\t\tresult = elementList[0];\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tsearchBySelector(selector) {\n\t\ttry {\n\t\t\tconst result = [];\n\n\t\t\tfor (const part of selector.split(',')) { // first selector\n\t\t\t\tconst partSanitized = part.trim();\n\n\t\t\t\tif (partSanitized === '' || !this.isCssSelector(partSanitized)) { continue; }\n\n\t\t\t\tconst collection = document.querySelectorAll(partSanitized);\n\n\t\t\t\tfor (const element of collection) {\n\t\t\t\t\tresult.push(element);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn result.length > 0 ? result : null;\n\t\t} catch (e) {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tsearchById(selector) {\n\t\ttry {\n\t\t\tconst element = document.getElementById(selector);\n\n\t\t\treturn element != null ? [element] : null;\n\t\t} catch (e) {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tsearchByClassName(selector) {\n\t\ttry {\n\t\t\tconst collection = document.getElementsByClassName(selector);\n\n\t\t\treturn collection.length > 0 ? collection : null;\n\t\t} catch (e) {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\treduceVisible(collection) {\n\t\tlet result = null;\n\t\t\n\t\tfor (const element of collection) {\n\t\t\tif (this.testVisible(element)) {\n\t\t\t\tresult = element;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\t\n\ttestVisible(element) {\n\t\treturn (element.offsetWidth || element.offsetHeight || element.getClientRects().length );\n\t}\n\n\tisCssSelector(selector) {\n\t\treturn /^[.#]/.test(selector);\n\t}\n\n\ttestSelectorMedia(selector) {\n\t\tconst partials = /^(.*):media(\\(.*\\))$/.exec(selector);\n\n\t\tif (partials == null) { return [ selector, true ]; }\n\n\t\treturn [\n\t\t\tpartials[1],\n\t\t\twindow.matchMedia(partials[2]).matches,\n\t\t];\n\t}\n\n\trenderElement(anchor, position) {\n\t\tconst selector = this.containerSelector();\n\t\tconst display = this.getDisplay();\n\t\tconst displayType = this.getOption('displayType')?.toLowerCase();\n\t\tlet widgetType = '';\n\n\t\tif (displayType === 'widget') {\n\t\t\twidgetType = display.getOption('TYPE_WIDGET')?.toLowerCase();\n\t\t}\n\n\t\tconst html = Utils.compile(this.getOption('template'), {\n\t\t\tstyle: display != null ? display.style() : '',\n\t\t\twidth: display != null ? display.width().toLowerCase() : 'auto',\n\t\t\tid: this.getOption('containerId'),\n\t\t\tmode: this.getOption('mode') || 'payment',\n\t\t\tdisplay: this.getOption('displayType')?.toLowerCase() || 'button',\n\t\t\tsolution: this.getOption('solution')?.toLowerCase(),\n\t\t\twidget_type: widgetType,\n\t\t});\n\n\t\tlet elements = Utils.toElements(html);\n\t\tlet result = null;\n\n\t\tif (position.indexOf('after') === 0) { elements = elements.reverse(); }\n\n\t\tfor (const element of elements) {\n\t\t\tanchor.insertAdjacentElement(position, element);\n\n\t\t\tif (result != null) { continue; }\n\n\t\t\tresult = element.matches(selector) ? element : element.querySelector(selector);\n\t\t}\n\n\t\tif (result == null) {\n\t\t\tthrow new Error(`cant find template container by selector ${selector}`);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tcreateSolution() {\n\t\tconst name = this.getOption('solution');\n\t\tconst mode = this.getOption('mode');\n\n\t\tthis.solution = SolutionRegistry.createPage(name, mode);\n\t}\n\n\tbootSolution() {\n\t\tthis.solution?.bootFactory(this);\n\t}\n\n\tgetDisplay() {\n\t\tconst type = this.getOption('displayType');\n\t\tconst options = this.getOption('displayParameters');\n\n\t\tif (type == null) { return null; }\n\n\t\treturn Display.make(type, this, options);\n\t}\n\n\tgetDivider() {\n\t\treturn this.getOption('useDivider')\n\t\t\t? Utils.compile(this.getOption('divider'), {label: this.getOption('label')})\n\t\t\t: '';\n\t}\n\n\tbootLocal() {\n\t\tEventProxy.make().fire('bxYapayFactoryInit', {\n\t\t\tfactory: this,\n\t\t});\n\t}\n\n\textendDefaults(options) {\n\t\tthis.defaults = Object.assign(this.defaults, options);\n\t}\n\n\tsetOptions(options) {\n\t\tthis.options = Object.assign(this.options, options);\n\t}\n\n\tgetOption(name) {\n\t\treturn this.options[name] ?? this.defaults[name];\n\t}\n}","export default class SolutionRegistry {\n\n\tstatic getFactory(name) {\n\t\tif (name == null) { return null; }\n\n\t\tlet namespace, type;\n\n\t\t[namespace, type] = name.split('.');\n\n\t\tlet factory = window?.BX?.YandexPay?.Solution?.[namespace]?.factory;\n\n\t\tif (type != null)\n\t\t{\n\t\t\tfactory = window?.BX?.YandexPay?.Solution?.[namespace]?.[type]?.factory;\n\t\t}\n\n\t\tif (factory == null) {\n\t\t\tconsole?.warn(`cant find solution ${name}`);\n\t\t\treturn;\n\t\t}\n\n\t\treturn factory;\n\t}\n\n\tstatic createPage(name, mode) {\n\t\tconst factory = this.getFactory(name);\n\n\t\tif (factory == null) { return null; }\n\n\t\treturn factory.create(mode);\n\t}\n\n}","import Template from '../utils/template';\n\nexport default class AbstractStep {\n\n\tstatic defaults = {\n\t\ttemplate: '',\n\t}\n\n\tdefaults;\n\toptions;\n\twidget;\n\tdelayTimeouts = {};\n\n\t/**\n\t * @param {Widget} widget\n\t * @param {Object} options\n\t */\n\tconstructor(widget, options = {}) {\n\t\tthis.widget = widget;\n\t\tthis.defaults = Object.assign({}, this.constructor.defaults);\n\t\tthis.options = Object.assign({}, options);\n\t}\n\n\tdestroy() {\n\t\t// nothing by default\n\t}\n\n\t/**\n\t *\n\t * @param {string} name\n\t * @returns {*}\n\t */\n\tgetOption(name) {\n\t\treturn this.options[name] ?? this.widget.getOption(name) ?? this.defaults[name];\n\t}\n\n\t/**\n\t * @param {Object<Element>} node Element\n\t * @param {Object} data Options\n\t */\n\trender(node, data = {}) {\n\t\tnode.innerHTML = this.compile(data);\n\t}\n\n\t/**\n\t * @param {Object} data\n\t * @returns {string}\n\t */\n\tcompile(data) {\n\t\treturn Template.compile(this.getOption('template'), data);\n\t}\n\n\t/**\n\t * @param {Object<Element>} node\n\t */\n\trestore(node) {\n\t\t// nothing by default\n\t}\n\n\t/**\n\t * @param {string} url\n\t * @param {Object} data\n\t * @returns {Promise.<Object>}\n\t */\n\tquery(url, data) {\n\t\treturn fetch(url, {\n\t\t\tmethod: 'POST',\n\t\t\theaders: { 'Content-Type': 'application/json' },\n\t\t\tbody: JSON.stringify(data)\n\t\t})\n\t\t\t.then(response => {return response.json()})\n\t}\n\n\tisRest() : boolean {\n\t\treturn this.getOption('isRest');\n\t}\n\n\tgetElement(key, context, method) {\n\t\tlet selector = this.getElementSelector(key);\n\n\t\treturn this.getNode(selector, context, method || 'querySelector');\n\t}\n\n\tgetElementSelector(key) {\n\t\tlet optionKey = key + 'Element';\n\n\t\treturn this.options[optionKey];\n\t}\n\n\tgetNode(selector, context, method) {\n\t\tif (selector.substr(0, 1) === '#') { // is id query\n\t\t\tcontext = document;\n\t\t} else if (!context) {\n\t\t\tcontext = this.el;\n\t\t}\n\n\t\treturn context[method](selector);\n\t}\n\n\tclearDelay(name) {\n\t\tif (this.delayTimeouts[name] == null) { return; }\n\n\t\tclearTimeout(this.delayTimeouts[name]);\n\t\tthis.delayTimeouts[name] = null;\n\t}\n\n\tdelay(name, args = [], timeout = 300) {\n\t\tthis.clearDelay(name);\n\t\tthis.delayTimeouts[name] = setTimeout(this[name].bind(this, ...args), timeout);\n\t}\n\n\tshowError(type, message, err = null) {\n\t\tlet notify = type + ' - ' + message;\n\n\t\tif (err) {\n\t\t\tnotify += ' ' + err;\n\t\t}\n\n\t\tconsole.error(notify);\n\t}\n}","import Template from \"../utils/template\";\r\n\r\nexport default class Base {\r\n\tstatic defaults = {\r\n\t\ttemplate: null,\r\n\t}\r\n\r\n\tconstructor(options = {}) {\r\n\t\tthis.options = Object.assign({}, this.constructor.defaults, options);\r\n\t\tthis.widget = null;\r\n\t}\r\n\r\n\trender(node, data = {}) {\r\n\t\tnode.innerHTML = this.compile(data);\r\n\t}\r\n\r\n\tcompile(data) {\r\n\t\treturn Template.compile(this.options.template, data);\r\n\t}\r\n\r\n\tsetWidget(widget) {\r\n\t\tthis.widget = widget;\r\n\t}\r\n\r\n\tgetOption(key) {\r\n\t\tif (key in this.options) {\r\n\t\t\treturn this.options[key];\r\n\t\t} else {\r\n\t\t\treturn this.widget.options[key];\r\n\t\t}\r\n\t}\r\n}","import Base from \"./base\";\r\nimport Template from \"../utils/template\";\r\n\r\nexport default class Form extends Base {\r\n\r\n\tstatic defaults = {\r\n\t\ttemplate: '<form name=\"form\" action=\"#ACTION#\" method=\"#METHOD#\">'\r\n\t\t\t+ '#INPUTS#'\r\n\t\t\t+ '</form>',\r\n\t}\r\n\r\n\trender(node, data) {\r\n\t\tsuper.render(node, data);\r\n\t\tthis.autosubmit(node);\r\n\t}\r\n\r\n\tcompile(data) {\r\n\t\tconst template = this.options.template;\r\n\t\tconst vars = Object.assign(data, {\r\n\t\t\t'inputs': this.makeInputs(data)\r\n\t\t});\r\n\r\n\t\treturn Template.compile(template, vars);\r\n\t}\r\n\r\n\tmakeInputs(data) {\r\n\t\tlet key;\r\n\t\tlet vars = data.params;\r\n\t\tlet value;\r\n\t\tlet template;\r\n\r\n\t\tif (Object.keys(vars).length === 0) { return ''; }\r\n\r\n\t\ttemplate = data.termUrl ? '<input type=\"hidden\" name=\"TermUrl\" value=\"' + vars.termUrl + '\">' : '';\r\n\r\n\t\tfor (key in vars)\r\n\t\t{\r\n\t\t\tif (!vars.hasOwnProperty(key)) { continue; }\r\n\r\n\t\t\tvalue = vars[key];\r\n\r\n\t\t\ttemplate += '<input type=\"hidden\" name=\"' + key + '\" value=\"' + value + '\">';\r\n\t\t}\r\n\r\n\t\treturn template;\r\n\t}\r\n\r\n\tmakeTermUrl() {\r\n\t\tlet result = this.getOption('notifyUrl');\r\n\t\tlet backUrl = window.location.href;\r\n\r\n\t\tresult +=\r\n\t\t\t(result.indexOf('?') === -1 ? '?' : '&')\r\n\t\t\t+ 'backurl=' + encodeURIComponent(backUrl)\r\n\t\t\t+ '&service=' + this.getOption('requestSign')\r\n\t\t\t+ '&paymentId=' + this.getOption('externalId');\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tautosubmit(node) {\r\n\t\tconst form = node.querySelector('form');\r\n\r\n\t\tform.submit();\r\n\t}\r\n}","import Base from \"./base\";\r\nimport Template from \"../utils/template\";\r\n\r\nexport default class Iframe extends Base {\r\n\r\n\tstatic defaults = {\r\n\t\ttemplate: '<iframe style=\"display: none;\"></iframe>',\r\n\t}\r\n\r\n\trender(node, data) {\r\n\t\tthis.insertIframe(node, data);\r\n\t}\r\n\r\n\tinsertIframe(node, data) {\r\n\t\tnode.innerHTML = Template.compile(this.options.template, data);\r\n\t\tthis.compile(node, data);\r\n\t}\r\n\r\n\tcompile(node, data) {\r\n\t\tlet iframe = node.querySelector('iframe');\r\n\t\tlet contentIframe = iframe.contentWindow || ( iframe.contentDocument.document || iframe.contentDocument);\r\n\t\tlet html = data.params;\r\n\r\n\t\tcontentIframe.document.open();\r\n\t\tcontentIframe.document.write(html);\r\n\t\tcontentIframe.document.close();\r\n\t}\r\n}","import Base from \"./base\";\r\nimport Template from \"../utils/template\";\r\n\r\nexport default class IframeRbs extends Base {\r\n\r\n\tstatic defaults = {\r\n\t\ttemplate: '<iframe style=\"display: none;\"></iframe>',\r\n\t}\r\n\r\n\trender(node, data) {\r\n\t\tthis.insertIframe(node, data);\r\n\t}\r\n\r\n\tinsertIframe(node, data) {\r\n\t\tnode.innerHTML = Template.compile(this.options.template, data);\r\n\t\tthis.compile(node, data);\r\n\t}\r\n\r\n\tcompile(node, data) {\r\n\t\tPromise.resolve()\r\n\t\t\t.then(() => this.renderIframe(node, data))\r\n\t\t\t.then(() => this.query(data));\r\n\t}\r\n\r\n\tquery (data) {\r\n\t\tfetch(this.getOption('notifyUrl'), {\r\n\t\t\tmethod: 'POST',\r\n\t\t\theaders: {\r\n\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t},\r\n\t\t\tbody: JSON.stringify({\r\n\t\t\t\tservice: this.getOption('requestSign'),\r\n\t\t\t\taccept: 'json',\r\n\t\t\t\tsecure: data.params.secure,\r\n\t\t\t\texternalId: data.params.notify.externalId,\r\n\t\t\t\tpaySystemId: data.params.notify.paySystemId\r\n\t\t\t})\r\n\t\t})\r\n\t\t\t.then(response => response.json())\r\n\t\t\t.then(result => {\r\n\t\t\t\tif (result.success === true) {\r\n\t\t\t\t\tthis.widget.go(result.state, result);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.widget.go('error', result);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.catch(error => console.log(error) );\r\n\t}\r\n\r\n\trenderIframe(node, data) {\r\n\t\tlet iframe = node.querySelector('iframe');\r\n\t\tlet contentIframe = iframe.contentWindow || ( iframe.contentDocument.document || iframe.contentDocument);\r\n\t\tlet html = `<form name=\"form\" action=\"${data.action}\" method=\"POST\">`;\r\n\r\n\t\tcontentIframe.document.open();\r\n\t\tcontentIframe.document.write(html);\r\n\t\tcontentIframe.document.close();\r\n\r\n\t\tcontentIframe.document.querySelector('form').submit();\r\n\t}\r\n}\r\n","import AbstractStep from \"./abstractstep\";\r\nimport SecureForm from \"../secure3d/form\";\r\nimport SecureIframe from \"../secure3d/iframe\";\r\nimport SecureRbs from \"../secure3d/iframerbs\";\r\n\r\nexport default class Step3ds extends AbstractStep {\r\n\r\n\trender(node, data) {\r\n\t\tconst view = this.makeView(data);\r\n\t\tview.setWidget(this.widget);\r\n\t\tview.render(node, data);\r\n\t}\r\n\r\n\tmakeView(data) {\r\n\t\tlet view = data.view;\r\n\r\n\t\tif (view === 'form') {\r\n\t\t\treturn new SecureForm();\r\n\t\t} else if (view === 'iframe') {\r\n\t\t\treturn new SecureIframe();\r\n\t\t} else if (view === 'iframerbs') {\r\n\t\t\treturn new SecureRbs();\r\n\t\t}\r\n\r\n\t\tthrow new Error('view secure3d missing')\r\n\t}\r\n}","import AbstractStep from './abstractstep';\r\n\r\nexport default class Finish extends AbstractStep {\r\n\r\n\tstatic defaults = {\r\n\t\ttemplate: '<div class=\"alert alert-success\" role=\"alert\"><strong>#MESSAGE#</strong></div>'\r\n\t}\r\n\r\n}","import AbstractStep from './abstractstep';\r\n\r\nexport default class Failure extends AbstractStep {\r\n\r\n\tstatic defaults = {\r\n\t\ttemplate: '<div class=\"alert alert-danger\" role=\"alert\"><strong>#MESSAGE#</strong></div>'\r\n\t}\r\n\r\n}","import AbstractStep from './abstractstep';\nimport Utils from \"../utils/template\";\n\nexport default class Loader extends AbstractStep {\n\n\tstatic defaults = {\n\t\ttemplate: '<div class=\"bx-yapay-skeleton-loading\"></div>',\n\t\tloaderSelector: '.bx-yapay-skeleton-loading',\n\t}\n\n\trender(node, data = {}) {\n\t\tif (node.querySelector(this.getOption('loaderSelector')) != null) { return; }\n\n\t\tconst html = this.compile(data);\n\t\tconst element = Utils.toElement(html);\n\n\t\tnode.insertAdjacentElement('beforeend', element);\n\t\tthis.restoreElement = element;\n\t}\n\n\trestore(node) {\n\t\tif (this.restoreElement == null) { return; }\n\n\t\tnode.insertAdjacentElement('beforeend', this.restoreElement);\n\t}\n\n\tremove(node) {\n\t\tconst loader = node.querySelector(this.getOption('loaderSelector'));\n\t\tloader?.remove();\n\t}\n\n}\n","import AbstractStep from './abstractstep';\nimport Utils from \"../utils/template\";\n\nexport default class Divider extends AbstractStep {\n\n\tstatic defaults = {\n\t\ttemplate: '<div class=\"bx-yapay-divider\"> ' +\n\t\t\t'<span class=\"bx-yapay-divider__corner\"></span> ' +\n\t\t\t'<span class=\"bx-yapay-divider__text\">#LABEL#</span> ' +\n\t\t\t'<span class=\"bx-yapay-divider__corner at--right\"></span> ' +\n\t\t\t'</div>',\n\t\tdividerSelector: '.bx-yapay-divider',\n\t}\n\n\trender(node, data = {}) {\n\t\tconst parentNode = node.parentElement;\n\t\tconst isRender = parentNode?.querySelector(this.getOption('dividerSelector'));\n\n\t\tif (\n\t\t\t!this.getOption('useDivider')\n\t\t\t|| isRender != null\n\t\t) { return; }\n\n\t\tconst html = this.compile({label: this.getOption('label')});\n\t\tconst element = Utils.toElement(html);\n\n\t\tnode.insertAdjacentElement('beforebegin', element);\n\t\tthis.restoreElement = element;\n\t}\n\n\trestore(node) {\n\t\tif (this.restoreElement == null) { return; }\n\t\tnode.insertAdjacentElement('beforebegin', this.restoreElement);\n\t}\n\n\tremove(node) {\n\t\tconst parentNode = node.parentElement;\n\t\tconst divider = parentNode?.querySelector(this.getOption('dividerSelector'));\n\t\tdivider?.remove();\n\t}\n\n}\n","export default class Proxy {\r\n\r\n\tpaymentData;\r\n\tcart;\r\n\twidget;\r\n\r\n\tconstructor(cart) {\r\n\t\tthis.cart = cart;\r\n\t\tthis.widget = cart.widget;\r\n\t\tthis.paymentData = this.getPaymentData();\r\n\t}\r\n\r\n\tgetOption(name) {\r\n\t\treturn this.cart.getOption(name);\r\n\t}\r\n\r\n\tbootstrap() {\r\n\r\n\t}\r\n\r\n\tcreatePayment(node, paymentData) {\r\n\r\n\t}\r\n\r\n\tgetPaymentData() {\r\n\r\n\t}\r\n\r\n\trestore(node) {\r\n\r\n\t}\r\n\r\n\tmount(node, payment) {\r\n\r\n\t}\r\n}","import Proxy from \"./proxy\";\nimport {EventProxy} from \"../../utils/eventproxy\";\n\nexport default class Rest extends Proxy {\n\n\tbootstrap() {\n\t\tthis.widget.bootToolsDisplay();\n\t\tthis.getButtonData()\n\t\t\t.then((result) => {\n\t\t\t\tif (result.status === 'fail') { throw new Error(result.reason); }\n\t\t\t\tthis.combineOrderWithData(result.data);\n\t\t\t\tthis.createPayment(this.cart.element, this.paymentData);\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tthis.widget.removeToolsDisplay();\n\t\t\t});\n\t}\n\n\tgetButtonData() {\n\n\t\tlet data = {\n\t\t\tproductId: this.getOption('productId'),\n\t\t\tmode: this.getOption('mode'),\n\t\t\tcurrencyCode: this.getOption('currencyCode'),\n\t\t\tsetupId: this.getOption('setupId'),\n\t\t\tproducts: this.getOption('products'),\n\t\t};\n\n\t\treturn this.cart.query(this.getOption('restUrl') + 'button/data', data);\n\t}\n\n\tgetPaymentData() {\n\t\treturn {\n\t\t\tenv: this.getOption('env'),\n\t\t\tversion: 3,\n\t\t\tmerchantId: this.getOption('merchantId'),\n\t\t\tcart: { externalId: \"checkout-b2b-test-order-id\", },\n\t\t\tcurrencyCode: this.getOption('currencyCode'),\n\t\t}\n\t}\n\n\tonPaymentSuccess(event) {\n\t\tthis.authorize(event)\n\t\t\t.then((result) => {\n\t\t\t\tif (result.status === 'success') {\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\twindow.location.href = result.data.redirect;\n\t\t\t\t\t}, 1000);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.cart.showError('authorize', result.reasonCode, result.reason);\n\t\t\t\t}\n\t\t\t});\n\n\t\tEventProxy.make().fire('bxYapayPaymentSuccess', event);\n\t}\n\n\tonPaymentAbort(event) {\n\t\tEventProxy.make().fire('bxYapayPaymentAbort', event);\n\t}\n\n\tonPaymentError(event) {\n\t\tEventProxy.make().fire('bxYapayPaymentError', event);\n\t\tthis.cart.showError('yapayPayment','payment not created', event.reason);\n\t}\n\n\tcreatePayment(node, paymentData) {\n\t\tif (this._mounted != null) { return; }\n\n\t\tthis._mounted = false;\n\n\t\tYaPay.createSession(paymentData, {\n\t\t\tonSuccess: this.onPaymentSuccess.bind(this),\n\t\t\tonAbort: this.onPaymentAbort.bind(this),\n\t\t\tonError: this.onPaymentError.bind(this),\n\t\t\tagent: { name: \"CMS-Bitrix\", version: \"1.0\" }\n\t\t})\n\t\t\t.then((paymentSession) => {\n\t\t\t\tthis._mounted = true;\n\t\t\t\tthis.cart.display.setProperty(node);\n\t\t\t\tthis.widget.removeLoader();\n\t\t\t\tthis.mount(paymentSession);\n\t\t\t\tthis.cart.display.removeProperty(node);\n\t\t\t})\n\t\t\t.catch((err) => {\n\t\t\t\tthis._mounted = null;\n\t\t\t\tnode.remove();\n\t\t\t\tthis.cart.showError('yapayPayment', 'payment not created', err);\n\t\t\t});\n\t}\n\n\tauthorize(event) {\n\t\tlet data = {\n\t\t\torderId: event.orderId,\n\t\t\thash: event.metadata,\n\t\t\tsuccessUrl: this.getOption('successUrl'),\n\t\t};\n\n\t\treturn this.cart.query(this.getOption('restUrl') + 'authorize', data);\n\t}\n\n\tbindDebug(payment) {\n\t\tfor (const key in YaPay.CheckoutEventType) {\n\t\t\tif (!YaPay.CheckoutEventType.hasOwnProperty(key)) { continue; }\n\n\t\t\tpayment.on(YaPay.CheckoutEventType[key], function() {\n\t\t\t\tconsole.log(arguments);\n\t\t\t});\n\t\t}\n\t}\n\n\tmount(payment) {\n\t\tthis.cart.initialContent = null;\n\t\tthis.payment = payment;\n\t\tthis.cart.display.mount(this.cart.element, payment, YaPay.ButtonType.Checkout);\n\t\tEventProxy.make().fire('bxYapayMountButton');\n\t}\n\n\tunmount() {\n\t\tthis._mounted = null;\n\t\tthis.cart.display.unmount(this.cart.element, this.payment);\n\t\tthis.widget.removeToolsDisplay();\n\t}\n\n\trestore(node) {\n\t\tif (this.payment == null) { return; }\n\t\tthis.cart.display.mount(node, this.payment, YaPay.ButtonType.Checkout);\n\t\tEventProxy.make().fire('bxYapayRestoreButton');\n\t}\n\n\tcombineOrderWithData(data) {\n\t\tconst { cart } = this.paymentData;\n\n\t\tlet exampleData = {\n\t\t\tcart: {\n\t\t\t\t...cart,\n\t\t\t\titems: data.items,\n\t\t\t\ttotal: {\n\t\t\t\t\tamount: data.total.amount,\n\t\t\t\t},\n\t\t\t},\n\t\t\tmetadata: data.metadata\n\t\t};\n\n\t\tObject.assign(this.paymentData, exampleData);\n\t}\n\n\tchangeOffer(newProductId) {\n\t\tlet productId = this.getOption('productId');\n\n\t\tif (productId === newProductId) { return; }\n\n\t\tthis.widget.setOptions({productId: newProductId});\n\n\t\tif (!this.validateProduct(newProductId)) { return; }\n\n\t\tif (this._mounted == null) {\n\t\t\tthis.bootstrap();\n\t\t}\n\t\telse {\n\t\t\tthis.update();\n\t\t}\n\t}\n\n\tchangeBasket() {\n\t\tthis.update();\n\t}\n\n\tupdate() {\n\t\tthis.payment.update(async () => {\n\t\t\tconst result = await this.getButtonData()\n\t\t\t\t.then(result => result)\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tthis.unmount();\n\t\t\t\t\tthis.cart.showError('getButtonData','get not button data', error);\n\t\t\t\t});\n\n\t\t\tif (result.status === 'fail') {\n\t\t\t\tthis.unmount();\n\t\t\t\tthrow new Error(result.reason);\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tcart: {\n\t\t\t\t\titems: result.data.items\n\t\t\t\t},\n\t\t\t\ttotal: {\n\t\t\t\t\tamount: result.data.total.amount,\n\t\t\t\t},\n\t\t\t\tmetadata: result.data.metadata,\n\t\t\t}\n\t\t});\n\t}\n\n\tvalidateProduct(productId) {\n\t\tconst products = this.getOption('products');\n\n\t\tif (productId != null && products != null && products.length !== 0)\n\t\t{\n\t\t\tif (!products.hasOwnProperty(productId)) { return false; }\n\n\t\t\tif (this.getOption('checkAvailable') && products[productId].AVAILABLE === 'N') {\n\t\t\t\tthis.unmount();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n}","import Proxy from \"./proxy\";\r\n\r\nexport default class Site extends Proxy {\r\n\r\n\tbootstrap() {\r\n\t\tthis.reflow();\r\n\t}\r\n\r\n\tgetPaymentData() {\r\n\t\tlet paymentData = {\r\n\t\t\tenv: this.getOption('env'),\r\n\t\t\tversion: 2,\r\n\t\t\tcountryCode: YaPay.CountryCode.Ru,\r\n\t\t\tcurrencyCode: YaPay.CurrencyCode.Rub,\r\n\t\t\tmerchant: {\r\n\t\t\t\tid: this.getOption('merchantId'),\r\n\t\t\t\tname: this.getOption('merchantName'),\r\n\t\t\t\turl: this.getOption('siteUrl')\r\n\t\t\t},\r\n\t\t\torder: { id: '0' },\r\n\t\t\tpaymentMethods: [\r\n\t\t\t\t{\r\n\t\t\t\t\ttype: YaPay.PaymentMethodType.Card,\r\n\t\t\t\t\tgateway: this.getOption('gateway'),\r\n\t\t\t\t\tgatewayMerchantId: this.getOption('gatewayMerchantId'),\r\n\t\t\t\t\tallowedAuthMethods: [YaPay.AllowedAuthMethod.PanOnly],\r\n\t\t\t\t\tallowedCardNetworks: [\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.UnionPay,\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.Uzcard,\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.Discover,\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.AmericanExpress,\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.Visa,\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.Mastercard,\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.Mir,\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.Maestro,\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.VisaElectron\r\n\t\t\t\t\t]\r\n\t\t\t\t}\r\n\t\t\t],\r\n\r\n\t\t\trequiredFields: {\r\n\r\n\t\t\t\tbillingContact: {\r\n\t\t\t\t\temail: this.getOption('useEmail') || false\r\n\t\t\t\t},\r\n\r\n\t\t\t\tshippingContact: {\r\n\t\t\t\t\tname: this.getOption('useName') || false,\r\n\t\t\t\t\temail: this.getOption('useEmail') || false,\r\n\t\t\t\t\tphone: this.getOption('usePhone') || false,\r\n\t\t\t\t},\r\n\r\n\t\t\t\tshippingTypes: {\r\n\t\t\t\t\tdirect: true,\r\n\t\t\t\t\tpickup: true,\r\n\t\t\t\t},\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.getOption('paymentCash') != null) {\r\n\t\t\tpaymentData.paymentMethods.push({\r\n\t\t\t\ttype: YaPay.PaymentMethodType.Cash,\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn paymentData;\r\n\t}\r\n\r\n\tgetProducts(){\r\n\r\n\t\tlet data = {\r\n\t\t\tyapayAction: 'getProducts',\r\n\t\t\tproductId: this.getOption('productId'),\r\n\t\t\tmode: this.getOption('mode'),\r\n\t\t\tsetupId: this.getOption('setupId')\r\n\t\t};\r\n\r\n\t\treturn this.cart.query(this.getOption('purchaseUrl'), data);\r\n\t}\r\n\r\n\tgetShippingOptions(address) {\r\n\r\n\t\tlet data = {\r\n\t\t\taddress: address,\r\n\t\t\tyapayAction: 'deliveryOptions',\r\n\t\t\titems: this.paymentData.order.items,\r\n\t\t\tsetupId: this.getOption('setupId'),\r\n\t\t\tpaySystemId: this.getOption('paySystemId'),\r\n\t\t};\r\n\r\n\t\treturn this.cart.query(this.getOption('purchaseUrl'), data);\r\n\t}\r\n\r\n\tgetPickupOptions(bounds) {\r\n\r\n\t\tlet data = {\r\n\t\t\tbounds: bounds,\r\n\t\t\tyapayAction: 'pickupOptions',\r\n\t\t\titems: this.paymentData.order.items,\r\n\t\t\tsetupId: this.getOption('setupId'),\r\n\t\t\tpaySystemId: this.getOption('paySystemId'),\r\n\t\t};\r\n\r\n\t\treturn this.cart.query(this.getOption('purchaseUrl'), data);\r\n\t}\r\n\r\n\tcreatePayment(node, paymentData) {\r\n\t\tif (this._mounted != null) { return; }\r\n\r\n\t\tthis._mounted = false;\r\n\r\n\t\tYaPay.createPayment(paymentData, { agent: { name: \"CMS-Bitrix\", version: \"1.0\" } })\r\n\t\t\t.then((payment) => {\r\n\t\t\t\tthis._mounted = true;\r\n\r\n\t\t\t\tthis.widget.removeLoader();\r\n\t\t\t\tthis.mountButton(node, payment);\r\n\r\n\t\t\t\tpayment.on(YaPay.PaymentEventType.Process, (event) => {\r\n\r\n\t\t\t\t\tthis.orderAccept(event).then((result) => {\r\n\r\n\t\t\t\t\t\tif (result.error) { throw new Error(result.error.message, result.error.code); }\r\n\r\n\t\t\t\t\t\tif(!this.isPaymentTypeCash(event)) {\r\n\t\t\t\t\t\t\tthis.notify(result, event).then(result => {\r\n\t\t\t\t\t\t\t\tif (result.success === true) {\r\n\t\t\t\t\t\t\t\t\tthis.widget.go(result.state, result);\r\n\t\t\t\t\t\t\t\t\tpayment.complete(YaPay.CompleteReason.Success);\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tthis.widget.go('error', result);\r\n\t\t\t\t\t\t\t\t\tpayment.complete(YaPay.CompleteReason.Error);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tpayment.complete(YaPay.CompleteReason.Success);\r\n\r\n\t\t\t\t\t\t\t\tif (result.redirect != null) {\r\n\t\t\t\t\t\t\t\t\twindow.location.href = result.redirect;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.catch((error) => {\r\n\t\t\t\t\t\t\tthis.cart.showError('yapayProcess', '', error); // todo test it\r\n\t\t\t\t\t\t\tpayment.complete(YaPay.CompleteReason.Error);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t});\r\n\r\n\t\t\t\tpayment.on(YaPay.PaymentEventType.Error, (event) => {\r\n\t\t\t\t\tthis.cart.showError('yapayError', 'service temporary unavailable');\r\n\t\t\t\t\tpayment.complete(YaPay.CompleteReason.Error);\r\n\t\t\t\t});\r\n\r\n\t\t\t\tpayment.on(YaPay.PaymentEventType.Change, (event) => {\r\n\t\t\t\t\t//    ,   \r\n\t\t\t\t\tif (event.shippingAddress) {\r\n\t\t\t\t\t\tthis.getShippingOptions(event.shippingAddress).then((result) => {\r\n\t\t\t\t\t\t\tpayment.update({shippingOptions: result})\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t//   \r\n\t\t\t\t\tif (event.shippingOption){\r\n\t\t\t\t\t\tpayment.update({\r\n\t\t\t\t\t\t\torder: this.combineOrderWithDirectShipping(event.shippingOption),\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t//   ,   \r\n\t\t\t\t\tif (event.pickupBounds) {\r\n\t\t\t\t\t\tthis.getPickupOptions(event.pickupBounds).then((result) => {\r\n\t\t\t\t\t\t\tpayment.update({pickupPoints: result})\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (event.pickupInfo) {\r\n\t\t\t\t\t\tthis.getPickupDetail(event.pickupInfo.pickupPointId).then((result) => {\r\n\t\t\t\t\t\t\tpayment.update({\r\n\t\t\t\t\t\t\t\tpickupPoint: result\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t//   \r\n\t\t\t\t\tif (event.pickupPoint) {\r\n\t\t\t\t\t\tpayment.update({\r\n\t\t\t\t\t\t\torder: this.combineOrderWithPickupShipping(event.pickupPoint),\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t})\r\n\t\t\t.catch((err) => {\r\n\t\t\t\tthis._mounted = null;\r\n\t\t\t\tthis.cart.showError('yapayPayment','payment not created', err);\r\n\t\t\t});\r\n\t}\r\n\r\n\tmountButton(node, payment) {\r\n\t\tthis.cart.initialContent = null;\r\n\r\n\t\tconst theme = this.cart.display.getOption('VARIANT_BUTTON') || YaPay.ButtonTheme.Black;\r\n\t\tconst width = this.cart.display.getOption('WIDTH_BUTTON') || YaPay.ButtonWidth.Auto;\r\n\r\n\t\tthis.paymentButton = payment.createButton({\r\n\t\t\ttype: YaPay.ButtonType.Checkout,\r\n\t\t\ttheme: theme,\r\n\t\t\twidth: width,\r\n\t\t});\r\n\r\n\t\tthis.paymentButton.mount(this.cart.element);\r\n\r\n\t\tthis.paymentButton.on(YaPay.ButtonEventType.Click, () => {\r\n\t\t\tpayment.checkout();\r\n\t\t});\r\n\t}\r\n\r\n\tgetPickupDetail(pickupId) {\r\n\t\tlet data = {\r\n\t\t\tpickupId: pickupId,\r\n\t\t\tyapayAction: 'pickupDetail',\r\n\t\t\titems: this.paymentData.order.items,\r\n\t\t\tsetupId: this.getOption('setupId'),\r\n\t\t\tpaySystemId: this.getOption('paySystemId'),\r\n\t\t};\r\n\r\n\t\treturn this.cart.query(this.getOption('purchaseUrl'), data);\r\n\t}\r\n\r\n\torderAccept(event) {\r\n\r\n\t\tlet deliveryType = event.shippingMethodInfo.shippingOption ? 'delivery' : 'pickup';\r\n\t\tlet delivery;\r\n\r\n\t\tif (deliveryType === 'pickup') {\r\n\t\t\tdelivery = {\r\n\t\t\t\taddress: event.shippingMethodInfo.pickupPoint.address,\r\n\t\t\t\tpickup: event.shippingMethodInfo.pickupPoint,\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tdelivery = {\r\n\t\t\t\taddress: event.shippingMethodInfo.shippingAddress,\r\n\t\t\t\tdelivery: event.shippingMethodInfo.shippingOption,\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet orderData = {\r\n\t\t\tsetupId: this.getOption('setupId'),\r\n\t\t\titems: this.paymentData.order.items,\r\n\t\t\tpayment: event.paymentMethodInfo,\r\n\t\t\tcontact: event.shippingContact,\r\n\t\t\tyapayAction: 'orderAccept',\r\n\t\t\tdeliveryType: deliveryType,\r\n\t\t\tpaySystemId: this.isPaymentTypeCash(event) ? this.getOption('paymentCash') : this.getOption('paySystemId'),\r\n\t\t\torderAmount: event.orderAmount\r\n\t\t};\r\n\r\n\t\tlet data = {...orderData, ...delivery };\r\n\r\n\t\treturn this.cart.query(this.getOption('purchaseUrl'), data);\r\n\t}\r\n\r\n\tisPaymentTypeCash(event) {\r\n\t\treturn (event.paymentMethodInfo.type === 'CASH');\r\n\t}\r\n\r\n\tnotify(payment, yandexPayData) {\r\n\r\n\t\tlet data = {\r\n\t\t\tservice: this.getOption('requestSign'),\r\n\t\t\taccept: 'json',\r\n\t\t\tyandexData: yandexPayData,\r\n\t\t\texternalId: payment.externalId,\r\n\t\t\tpaySystemId: payment.paySystemId\r\n\t\t};\r\n\r\n\t\treturn this.cart.query(this.getOption('notifyUrl'), data);\r\n\t}\r\n\r\n\tchangeOffer(newProductId) {\r\n\t\tlet productId = this.getOption('productId');\r\n\r\n\t\tif (productId !== newProductId) { // todo in items\r\n\t\t\tthis.widget.setOptions({productId: newProductId});\r\n\t\t\tthis.reflow();\r\n\t\t}\r\n\t}\r\n\r\n\tchangeBasket() {\r\n\t\tthis.reflow();\r\n\t}\r\n\r\n\treflow() {\r\n\t\tthis.getProducts()\r\n\t\t\t.then((result) => {\r\n\t\t\t\tif (result.error) { throw new Error(result.error.message); }\r\n\r\n\t\t\t\tthis.combineOrderWithProducts(result);\r\n\t\t\t\tthis.createPayment(this.cart.element, this.paymentData);\r\n\t\t\t})\r\n\t\t\t.catch((error) => {\r\n\t\t\t\tthis.widget.removeLoader();\r\n\t\t\t\t// todo this.showError();\r\n\t\t\t});\r\n\t}\r\n\r\n\tcombineOrderWithPickupShipping(pickupOption) {\r\n\t\tconst { order } = this.paymentData;\r\n\r\n\t\treturn {\r\n\t\t\t...order,\r\n\t\t\titems: [\r\n\t\t\t\t...order.items,\r\n\t\t\t\t{\r\n\t\t\t\t\ttype: 'SHIPPING',\r\n\t\t\t\t\tlabel: pickupOption.label,\r\n\t\t\t\t\tamount: pickupOption.amount,\r\n\t\t\t\t},\r\n\t\t\t],\r\n\t\t\ttotal: {\r\n\t\t\t\t...order.total,\r\n\t\t\t\tamount: this.amountSum(order.total.amount, pickupOption.amount),\r\n\t\t\t},\r\n\t\t};\r\n\t}\r\n\r\n\tcombineOrderWithDirectShipping(shippingOption) {\r\n\t\tconst { order } = this.paymentData;\r\n\r\n\t\treturn {\r\n\t\t\t...order,\r\n\t\t\titems: [\r\n\t\t\t\t...order.items,\r\n\t\t\t\t{\r\n\t\t\t\t\ttype: 'SHIPPING',\r\n\t\t\t\t\tlabel: shippingOption.label,\r\n\t\t\t\t\tamount: shippingOption.amount,\r\n\t\t\t\t},\r\n\t\t\t],\r\n\t\t\ttotal: {\r\n\t\t\t\t...order.total,\r\n\t\t\t\tamount: this.amountSum(order.total.amount, shippingOption.amount),\r\n\t\t\t},\r\n\t\t};\r\n\t}\r\n\r\n\tcombineOrderWithProducts(products) {\r\n\t\tconst { order } = this.paymentData;\r\n\r\n\t\tlet exampleOrder = {\r\n\t\t\t...order,\r\n\t\t\titems: products.items,\r\n\t\t\ttotal: {\r\n\t\t\t\tamount: products.amount,\r\n\t\t\t},\r\n\t\t};\r\n\r\n\t\tObject.assign(this.paymentData.order, exampleOrder);\r\n\t}\r\n\r\n\trestore(node) {\r\n\t\tif (this.paymentButton == null) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.paymentButton.mount(node);\r\n\t}\r\n\r\n\tamountSum(amountA, amountB) {\r\n\t\treturn (Number(amountA) + Number(amountB)).toFixed(2);\r\n\t}\r\n}","import AbstractStep from '../abstractstep';\nimport { ready } from \"../../utils/ready\";\nimport Display from \"../../ui/display/factory\";\nimport {EventProxy} from \"../../utils/eventproxy\";\nimport Rest from \"./rest\";\nimport Site from \"./site\";\n\nexport default class Cart extends AbstractStep {\n\n\tisBootstrap;\n\telement;\n\tdisplay;\n\tinitialContent;\n\n\trender(node, data) {\n\t\tthis.element = node;\n\t\tthis.display = this.getDisplay();\n\t\tthis.initialContent = this.element.innerHTML;\n\t\tthis.isBootstrap = false;\n\n\t\tthis.bootProxy();\n\t\tthis.bootSolution();\n\t\tthis.bootLocal();\n\t\tthis.delayBootstrap();\n\t}\n\n\tdestroy() {\n\t\tthis.destroyLocal()\n\t\tthis.destroySolution();\n\t}\n\n\tbootProxy() : Rest|Site{\n\t\tthis.proxy = this.isRest() ? new Rest(this) : new Site(this);\n\t}\n\n\trestore(node) {\n\t\tif (this.initialContent != null) {\n\t\t\tnode.innerHTML = this.initialContent;\n\t\t}\n\n\t\tthis.element = node;\n\t\tthis.proxy.restore(node);\n\t}\n\n\tbootstrap() {\n\t\tthis.isBootstrap = true;\n\t\tthis.proxy.bootstrap();\n\t}\n\n\tbootSolution() {\n\t\tthis.widget.getSolution()?.bootCart(this);\n\t}\n\n\tdestroySolution() {\n\t\tthis.widget.getSolution()?.destroyCart(this);\n\t}\n\n\tbootLocal() {\n\t\tEventProxy.make().fire('bxYapayCartInit', {\n\t\t\tcart: this,\n\t\t});\n\t}\n\n\tdestroyLocal() {\n\t\tEventProxy.make().fire('bxYapayCartDestroy', {\n\t\t\tcart: this,\n\t\t});\n\t}\n\n\tdelayChangeBasket() {\n\t\tthis.delay('changeBasket');\n\t}\n\n\tdelayChangeOffer(productId) {\n\t\tthis.delay('changeOffer', [productId]);\n\t}\n\n\tdelayBootstrap() {\n\t\tready(() => {\n\t\t\tthis.delay('bootstrap');\n\t\t});\n\t}\n\n\tchangeBasket() {\n\t\tif (!this.isBootstrap) { return; }\n\t\tthis.proxy?.changeBasket();\n\t}\n\n\tchangeOffer(newProductId) {\n\t\tif (this.isBootstrap) {\n\t\t\tthis.proxy?.changeOffer(newProductId);\n\t\t} else {\n\t\t\tthis.widget.setOptions({productId: newProductId});\n\t\t}\n\t}\n\n\tgetDisplay() {\n\t\tconst type = this.getOption('displayType');\n\t\tconst options = this.getOption('displayParameters');\n\t\treturn Display.make(type, this, options);\n\t}\n}","export function ready(callback) {\r\n\tif (document.readyState === 'complete' || document.readyState === 'interactive') {\r\n\t\tsetTimeout(callback, 1);\r\n\t} else {\r\n\t\tdocument.addEventListener('DOMContentLoaded', callback);\r\n\t}\r\n}","export default class Proxy {\r\n\r\n\tpayment;\r\n\twidget;\r\n\r\n\tconstructor(payment) {\r\n\t\tthis.payment = payment;\r\n\t\tthis.widget = payment.widget;\r\n\t}\r\n\r\n\tgetOption(name) {\r\n\t\treturn this.payment.getOption(name);\r\n\t}\r\n\r\n\tcreatePayment(node, paymentData) {\r\n\r\n\t}\r\n\r\n\tgetPaymentData(data) {\r\n\r\n\t}\r\n}","import Proxy from \"./proxy\";\nimport {EventProxy} from \"../../utils/eventproxy\";\n\nexport default class Rest extends Proxy {\n\n\tgetPaymentData(data) {\n\t\treturn {\n\t\t\tenv: this.getOption('env'),\n\t\t\tversion: 3,\n\t\t\tcurrencyCode: YaPay.CurrencyCode.Rub,\n\t\t\tmerchantId: this.getOption('merchantId'),\n\t\t\torderId: data.id,\n\t\t\tcart: {\n\t\t\t\titems: data.items,\n\t\t\t\ttotal: {\n\t\t\t\t\tamount: data.total,\n\t\t\t\t},\n\t\t\t},\n\t\t\tmetadata: this.getOption('metadata'),\n\t\t}\n\t}\n\n\tonPaymentSuccess(event) {\n\t\tthis.unmount();\n\t\tthis.authorize(event)\n\t\t\t.then((result) => {\n\t\t\t\tif (result.status === 'success') {\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\twindow.location.href = result.data.redirect;\n\t\t\t\t\t}, 1000);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.payment.showError('authorize', result.reasonCode, result.reason);\n\t\t\t\t}\n\t\t\t})\n\t}\n\n\tonPaymentAbort(event) {\n\t\tEventProxy.make().fire('bxYapayPaymentAbort', event);\n\t}\n\n\tonPaymentError(event) {\n\t\tsetTimeout(() => {\n\t\t\twindow.location.href = this.getOption('failUrl');\n\t\t}, 1000);\n\t}\n\n\tcreatePayment(node, paymentData) {\n\t\tYaPay.createSession(paymentData, {\n\t\t\tonSuccess: this.onPaymentSuccess.bind(this),\n\t\t\tonAbort: this.onPaymentAbort.bind(this),\n\t\t\tonError: this.onPaymentError.bind(this),\n\t\t\tagent: { name: 'CMS-Bitrix', version: '1.0' }\n\t\t})\n\t\t\t.then( (paymentSession) => {\n\t\t\t\tthis.widget.removeLoader();\n\t\t\t\tthis.mount(paymentSession);\n\t\t\t})\n\t\t\t.catch( (err) => {\n\t\t\t\tthis.payment.showError('yapayPayment','payment not created', err);\n\t\t\t});\n\t}\n\n\tmount(payment) {\n\t\tthis.paymentSession = payment;\n\t\tthis.payment.display.mount(this.payment.element, payment, YaPay.ButtonType.Pay);\n\t\tEventProxy.make().fire('bxYapayMountButton');\n\t}\n\n\tunmount() {\n\t\tthis.payment.display.unmount(this.payment.element, this.paymentSession);\n\t\tthis.widget.removeToolsDisplay();\n\t}\n\n\tauthorize(event) {\n\t\tlet data = {\n\t\t\torderId: event.orderId,\n\t\t\thash: event.metadata,\n\t\t\tsuccessUrl: this.getOption('successUrl'),\n\t\t};\n\n\t\treturn this.payment.query(this.getOption('restUrl') + 'authorize', data);\n\t}\n}","import Proxy from \"./proxy\";\r\n\r\nexport default class Site extends Proxy {\r\n\r\n\tgetPaymentData(data) {\r\n\t\treturn {\r\n\t\t\tenv: this.getOption('env'),\r\n\t\t\tversion: 2,\r\n\t\t\tcountryCode: YaPay.CountryCode.Ru,\r\n\t\t\tcurrencyCode: YaPay.CurrencyCode.Rub,\r\n\t\t\tmerchant: {\r\n\t\t\t\tid: this.getOption('merchantId'),\r\n\t\t\t\tname: this.getOption('merchantName')\r\n\t\t\t},\r\n\t\t\torder: {\r\n\t\t\t\tid: data.id,\r\n\t\t\t\ttotal: { amount: data.total },\r\n\t\t\t\titems: data.items\r\n\t\t\t},\r\n\t\t\tpaymentMethods: [\r\n\t\t\t\t{\r\n\t\t\t\t\ttype: YaPay.PaymentMethodType.Card,\r\n\t\t\t\t\tgateway: this.getOption('gateway'),\r\n\t\t\t\t\tgatewayMerchantId: this.getOption('gatewayMerchantId'),\r\n\t\t\t\t\tallowedAuthMethods: [YaPay.AllowedAuthMethod.PanOnly],\r\n\t\t\t\t\tallowedCardNetworks: [\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.UnionPay,\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.Uzcard,\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.Discover,\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.AmericanExpress,\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.Visa,\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.Mastercard,\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.Mir,\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.Maestro,\r\n\t\t\t\t\t\tYaPay.AllowedCardNetwork.VisaElectron\r\n\t\t\t\t\t]\r\n\t\t\t\t}\r\n\t\t\t],\r\n\t\t}\r\n\t}\r\n\r\n\tcreatePayment(node, paymentData) {\r\n\t\tYaPay.createPayment(paymentData, { agent: { name: \"CMS-Bitrix\", version: \"1.0\" } })\r\n\t\t\t.then( (payment) => {\r\n\t\t\t\tlet button = payment.createButton({\r\n\t\t\t\t\ttype: YaPay.ButtonType.Pay,\r\n\t\t\t\t\ttheme: this.getOption('buttonTheme') || YaPay.ButtonTheme.Black,\r\n\t\t\t\t\twidth: this.getOption('buttonWidth') || YaPay.ButtonWidth.Auto,\r\n\t\t\t\t});\r\n\r\n\t\t\t\tthis.widget.removeLoader();\r\n\t\t\t\tbutton.mount(node);\r\n\r\n\t\t\t\tbutton.on(YaPay.ButtonEventType.Click, function onPaymentButtonClick() {\r\n\t\t\t\t\tpayment.checkout();\r\n\t\t\t\t});\r\n\r\n\t\t\t\tpayment.on(YaPay.PaymentEventType.Process, (event) => {\r\n\r\n\t\t\t\t\tthis.notify(payment, event).then((result) => {});\r\n\r\n\t\t\t\t\tpayment.complete(YaPay.CompleteReason.Success);\r\n\t\t\t\t});\r\n\r\n\t\t\t\tpayment.on(YaPay.PaymentEventType.Error, function onPaymentError(event) {\r\n\t\t\t\t\tconsole.log({'errors': event});\r\n\t\t\t\t\tpayment.complete(YaPay.CompleteReason.Error);\r\n\t\t\t\t});\r\n\r\n\t\t\t\tpayment.on(YaPay.PaymentEventType.Abort, function onPaymentAbort(event) {});\r\n\t\t\t})\r\n\t\t\t.catch(function (err) {\r\n\t\t\t\tconsole.log({'payment not create': err});\r\n\t\t\t});\r\n\t}\r\n\r\n\tnotify(payment, yandexPayData) {\r\n\t\treturn fetch(this.getOption('notifyUrl'), {\r\n\t\t\tmethod: 'POST',\r\n\t\t\theaders: {\r\n\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t},\r\n\t\t\tbody: JSON.stringify({\r\n\t\t\t\tservice: this.getOption('requestSign'),\r\n\t\t\t\taccept: 'json',\r\n\t\t\t\tyandexData: yandexPayData,\r\n\t\t\t\texternalId: this.getOption('externalId'),\r\n\t\t\t\tpaySystemId: this.getOption('paySystemId')\r\n\t\t\t})\r\n\t\t})\r\n\t\t\t.then(response => response.json())\r\n\t\t\t.then(result => {\r\n\t\t\t\tif (result.success === true) {\r\n\t\t\t\t\tthis.widget.go(result.state, result);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.widget.go('error', result);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.catch(error => console.log(error) );\r\n\t}\r\n}","import AbstractStep from '../abstractstep';\nimport Rest from \"./rest\";\nimport Site from \"./site\";\nimport Display from \"../../ui/display/factory\";\n\nexport default class Payment extends AbstractStep {\n\n\tdisplay;\n\n\trender(node, data) {\n\t\tthis.element = node;\n\t\tthis.display = this.getDisplay();\n\n\t\tthis.bootProxy();\n\n\t\tconst paymentData = this.getPaymentData(data);\n\t\tthis.createPayment(node, paymentData);\n\t}\n\n\tbootProxy() : Rest|Site {\n\t\tthis.proxy = this.isRest() ? new Rest(this) : new Site(this);\n\t}\n\n\tgetPaymentData(data) {\n\t\treturn this.proxy.getPaymentData(data);\n\t}\n\n\tcreatePayment(node, paymentData) {\n\t\tthis.proxy.createPayment(node, paymentData);\n\t}\n\n\tgetDisplay() {\n\t\tconst type = this.getOption('displayType');\n\t\tconst options = this.getOption('displayParameters');\n\n\t\treturn Display.make(type, this, options);\n\t}\n}","import Utils from \"../../utils/template\";\nimport Template from \"../../utils/template\";\n\nexport default class Loader {\n\n\tstatic defaults = {\n\t\ttemplate: '',\n\t}\n\n\tconstructor(widget, options) {\n\t\tthis.widget = widget;\n\t\tthis.options = Object.assign({}, this.constructor.defaults, options);\n\t\tthis.options.loaderSelector = '.bx-yapay-skeleton-loading';\n\t}\n\n\trender(node, data = {}) {\n\t\tif (node.querySelector(this.getOption('loaderSelector')) != null) { return; }\n\n\t\tconst html = Template.compile(this.getOption('template'), data);\n\t\tconst element = Utils.toElement(html);\n\n\t\tnode.insertAdjacentElement('beforeend', element);\n\t\tthis.restoreElement = element;\n\t}\n\n\trestore(node) {\n\t\tif (this.restoreElement == null) { return; }\n\n\t\tnode.insertAdjacentElement('beforeend', this.restoreElement);\n\t}\n\n\tremove(node) {\n\t\tconst loader = node.querySelector(this.getOption('loaderSelector'));\n\t\tloader?.remove();\n\t}\n\n\t/**\n\t *\n\t * @param {string} name\n\t * @returns {*}\n\t */\n\tgetOption(name) {\n\t\treturn this.options[name] ?? this.widget.getOption(name) ?? this.defaults[name];\n\t}\n}","import Loader from './loader';\n\nexport default class Button extends Loader {\n\n\tstatic defaults = {\n\t\ttemplate: '<div class=\"bx-yapay-skeleton-loading\"><div class=\"bx-yapay-skeleton-load\"></div></div>',\n\t}\n}\n","import Loader from '../loader';\nimport Template from \"../../../utils/template\";\nimport Utils from \"../../../utils/template\";\n\nexport default class Compact extends Loader {\n\n\tstatic defaults = {\n\t\ttemplate: `\n\t\t\t<div class=\"bx-yapay-skeleton-loading\">\n\t\t\t\t#USER_DESCRIPTION#\n\t\t\t\t<div class=\"bx-yapay-skeleton-load bx-yapay-skeleton-loading-button\"></div>\n\t\t\t\t<div class=\"bx-yapay-skeleton-load bx-yapay-skeleton-loading-description\"></div>\n\t\t\t</div>\n\t\t`\n\t}\n\n\trender(node, data: {} = {}) {\n\t\tif (node.querySelector(this.getOption('loaderSelector')) != null) { return; }\n\n\t\tconst mode = this.getOption('mode');\n\t\tlet compileData = {\n\t\t\tuser_description: '',\n\t\t};\n\n\t\tif (mode !== 'payment') {\n\t\t\tcompileData.user_description = `<div class=\"bx-yapay-skeleton-user\">\n\t\t\t\t\t<div class=\"bx-yapay-skeleton-load bx-yapay-skeleton-loading-circle\"></div>\n\t\t\t\t\t<div class=\"bx-yapay-skeleton-load bx-yapay-skeleton-loading-line\"></div>\n\t\t\t\t\t<div class=\"bx-yapay-skeleton-load bx-yapay-skeleton-loading-circle\"></div>\n\t\t\t\t</div>`;\n\t\t}\n\n\t\tconst html = Template.compile(this.getOption('template'), compileData);\n\t\tconst element = Utils.toElement(html);\n\n\t\tnode.insertAdjacentElement('beforeend', element);\n\t\tthis.restoreElement = element;\n\t}\n}","import Loader from '../loader';\n\nexport default class Compact extends Loader {\n\n\tstatic defaults = {\n\t\ttemplate: `\n\t\t<div class=\"bx-yapay-skeleton-loading bx-yapay-skeleton-type-mini\">\n\t\t\t<div class=\"bx-yapay-skeleton-load bx-yapay-skeleton-loading-button\"></div>\n\t\t\t<div class=\"bx-yapay-skeleton-load bx-yapay-skeleton-loading-description\"></div>\n\t\t</div>\n\t\t`\n\t}\n}","import Loader from '../loader';\nimport Template from \"../../../utils/template\";\nimport Utils from \"../../../utils/template\";\n\nexport default class Split extends Loader {\n\n\tstatic defaults = {\n\t\ttemplate: `\n\t\t<div class=\"bx-yapay-skeleton-loading\">\n\t\t\t\n\t\t\t#USER_DESCRIPTION#\n\n\t\t\t<div class=\"bx-yapay-skeleton-user bx-yapay-skeleton-split\">\n\t\t\t\t<div class=\"bx-yapay-skeleton-load bx-yapay-skeleton-loading-circle\"></div>\n\t\t\t\t<div class=\"bx-yapay-skeleton-load bx-yapay-skeleton-loading-line\"></div>\n\t\t\t\t<div class=\"bx-yapay-skeleton-load bx-yapay-skeleton-loading-#TYPE#\"></div>\n\t\t\t</div>\n\t\t\t\n\t\t\t#SPLIT_NOW#\n\n\t\t\t<div class=\"bx-yapay-skeleton-user bx-yapay-skeleton-split-plan\">\n\n\t\t\t<div class=\"bx-yapay-skeleton-split-plan-list\">\n\t\t\t\n\t\t\t\t<div class=\"bx-yapay-skeleton-split-plan-item\">\n\t\t\t\t\t<div class=\"bx-yapay-skeleton-load bx-yapay-skeleton-loading-split-plan-payline\"></div>\n\t\t\t\t\t<div class=\"bx-yapay-skeleton-load bx-yapay-skeleton-loading-split-plan-pay\"></div>\n\t\t\t\t</div>\n\t\t\t\n\t\t\t\t<div class=\"bx-yapay-skeleton-split-plan-item\">\n\t\t\t\t\t<div class=\"bx-yapay-skeleton-split-plan-item-group\">\n\t\t\t\t\t\t<div class=\"bx-yapay-skeleton-load bx-yapay-skeleton-loading-split-plan-payline\"></div>\n\t\t\t\t\t\t<div class=\"bx-yapay-skeleton-load bx-yapay-skeleton-loading-split-plan-payline\"></div>\n\t\t\t\t\t\t<div class=\"bx-yapay-skeleton-load bx-yapay-skeleton-loading-split-plan-payline\"></div>\n\t\t\t\t\t\t<div class=\"bx-yapay-skeleton-load bx-yapay-skeleton-loading-split-plan-payline\"></div>\n\t\t\t\t\t\t<div class=\"bx-yapay-skeleton-load bx-yapay-skeleton-loading-split-plan-payline\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"bx-yapay-skeleton-load bx-yapay-skeleton-split-plan-pay-date\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\n\t\t\t</div>\n\t\t\t\n\t\t\t#SPLIT_FEE#\n\n\t\t\t<div class=\"bx-yapay-skeleton-load bx-yapay-skeleton-loading-button\"></div>\n\t\t\t<div class=\"bx-yapay-skeleton-load bx-yapay-skeleton-loading-description\"></div>\n\t\t</div>\n\t\t`\n\t}\n\n\trender(node, data = {}) {\n\t\tif (node.querySelector(this.getOption('loaderSelector')) != null) { return; }\n\n\t\tconst displayParameters = this.getOption('displayParameters');\n\t\tconst mode = this.getOption('mode');\n\t\tlet compileData;\n\n\t\tif (displayParameters?.TYPE_WIDGET === 'BnplRequired') {\n\t\t\tcompileData = {\n\t\t\t\ttype: 'circle-info',\n\t\t\t\tsplit_now: '<div class=\"bx-yapay-skeleton-load bx-yapay-skeleton-loading-split-plan-plans\"></div>' +\n\t\t\t\t\t'<div class=\"bx-yapay-skeleton-load bx-yapay-skeleton-loading-split-plan-pay-now\"></div>',\n\t\t\t\tsplit_fee: '<div class=\"bx-yapay-skeleton-load bx-yapay-skeleton-loading-split-fee\"></div>',\n\t\t\t};\n\t\t} else if (displayParameters?.SPLIT_SELECT_WIDGET === '1') {\n\t\t\tcompileData = {\n\t\t\t\ttype: 'ellipse-selected',\n\t\t\t\tsplit_now: '<div class=\"bx-yapay-skeleton-load bx-yapay-skeleton-loading-split-plan-plans\"></div>' +\n\t\t\t\t\t'<div class=\"bx-yapay-skeleton-load bx-yapay-skeleton-loading-split-plan-pay-now\"></div>',\n\t\t\t\tsplit_fee: '<div class=\"bx-yapay-skeleton-load bx-yapay-skeleton-loading-split-fee\"></div>',\n\t\t\t};\n\t\t} else {\n\t\t\tcompileData = {\n\t\t\t\ttype: 'ellipse',\n\t\t\t\tsplit_now: '',\n\t\t\t\tsplit_fee: '',\n\t\t\t};\n\t\t}\n\n\t\tif (mode !== 'payment') {\n\t\t\tcompileData.user_description = `<div class=\"bx-yapay-skeleton-user\">\n\t\t\t\t\t<div class=\"bx-yapay-skeleton-load bx-yapay-skeleton-loading-circle\"></div>\n\t\t\t\t\t<div class=\"bx-yapay-skeleton-load bx-yapay-skeleton-loading-line\"></div>\n\t\t\t\t\t<div class=\"bx-yapay-skeleton-load bx-yapay-skeleton-loading-circle\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-yapay-skeleton-divider\"></div>`;\n\t\t} else {\n\t\t\tcompileData.user_description = '';\n\t\t}\n\n\t\tconst html = Template.compile(this.getOption('template'), compileData);\n\t\tconst element = Utils.toElement(html);\n\n\t\tnode.insertAdjacentElement('beforeend', element);\n\t\tthis.restoreElement = element;\n\t}\n}","import StepFactory from './step/factory';\nimport Divider from \"./step/divider\";\nimport Page from \"../solution/reference/page\";\nimport NodePreserver from \"./ui/nodepreserver\";\nimport Loader from \"./ui/loader/factory\";\n\nexport default class Widget {\n\n\tstatic defaults = {}\n\n\tdefaults;\n\toptions;\n\tloader;\n\tdivider;\n\tel;\n\tstep;\n\t/** @var Page|null */\n\tsolution;\n\t/** @var NodePreserver|null */\n\tpreserver;\n\n\t/**\n\t * @param {Object<Element>} element\n\t * @param {Object} options\n\t */\n\tconstructor(element, options = {}) {\n\t\tthis.defaults = Object.assign({}, this.constructor.defaults);\n\t\tthis.options = {};\n\t\tthis.el = element;\n\n\t\tthis.setOptions(options);\n\t}\n\n\tboot() {\n\t\tthis.bootSolution();\n\t}\n\n\tdestroy() {\n\t\tthis.destroyStep()\n\t\tthis.destroySolution();\n\t\tthis.destroyPreserver();\n\t}\n\n\t/**\n\t * @param {Object} data\n\t */\n\tpayment(data) {\n\t\tthis.go('payment', data);\n\t}\n\n\t/**\n\t * @param {Object} data\n\t */\n\tcart(data){\n\t\tthis.go('cart', data);\n\t}\n\n\trestore(element) {\n\t\tthis.el = element;\n\t\tthis.step?.restore(element);\n\t\tthis.restoreToolsDisplay(element);\n\t}\n\n\t/**\n\t * @param {string} type\n\t * @param {Object} data\n\t */\n\tgo(type, data) {\n\t\tthis.step = this.makeStep(type);\n\t\tthis.step.render(this.el, data);\n\t}\n\n\tdestroyStep() {\n\t\tthis.step?.destroy();\n\t}\n\n\tbootToolsDisplay() {\n\t\tthis.bootDivider();\n\t\tthis.bootLoader();\n\t}\n\n\trestoreToolsDisplay(element) {\n\t\tthis.divider?.restore(element);\n\t}\n\n\tremoveToolsDisplay() {\n\t\tthis.removeDivider();\n\t\tthis.removeLoader();\n\t}\n\n\tbootDivider() {\n\t\tif (this.divider == null)\n\t\t{\n\t\t\tthis.divider = new Divider(this);\n\t\t}\n\n\t\tthis.divider.render(this.el);\n\t}\n\n\tremoveDivider() {\n\t\tif (this.divider == null) { return; }\n\t\tthis.divider.remove(this.el);\n\t\tthis.divider = null;\n\t}\n\n\tbootLoader() {\n\t\tif (this.loader == null) {\n\t\t\tthis.loader = Loader.make(this.getOption('displayType'), this, this.options);\n\t\t}\n\n\t\tthis.loader.render(this.el);\n\t}\n\n\tremoveLoader() {\n\t\tif (this.loader == null) { return; }\n\t\tthis.loader.remove(this.el);\n\t\tthis.loader = null;\n\t}\n\n\t/**\n\t * @param {String} type\n\t * @returns {Cart|Finish|Step3ds|Payment|Failure}\n\t * @throws {Error}\n\t */\n\tmakeStep(type) {\n\t\tconst options = this.getOption(type) || {};\n\n\t\treturn StepFactory.make(type, this, options);\n\t}\n\n\tsetPreserver(preserver: NodePreserver) : void {\n\t\tthis.preserver = preserver;\n\t}\n\n\tdestroyPreserver() : void {\n\t\tthis.preserver?.destroy();\n\t}\n\n\tsetSolution(solution: Page) : void {\n\t\tthis.solution = solution;\n\t}\n\n\tgetSolution() : Page {\n\t\treturn this.solution;\n\t}\n\n\tbootSolution() {\n\t\tthis.getSolution()?.bootWidget(this);\n\t}\n\n\tdestroySolution() {\n\t\tthis.getSolution()?.destroyWidget(this);\n\t}\n\n\textendDefaults(options) {\n\t\tthis.defaults = Object.assign(this.defaults, options);\n\t}\n\n\tsetOptions(options) {\n\t\tthis.options = Object.assign(this.options, options);\n\t}\n\n\tgetOption(name) {\n\t\treturn this.options[name] ?? this.defaults[name];\n\t}\n}\n","import Button from \"./button\";\nimport FactoryWidget from \"./widget/factory\";\n\nexport default class Factory {\n\n\tstatic make(type, widget, options) {\n\t\tif (type === 'Button') {\n\t\t\treturn new Button(widget, options);\n\t\t} else if (type === 'Widget') {\n\t\t\tconst widgetType = options['displayParameters'].TYPE_WIDGET;\n\t\t\treturn FactoryWidget.make(widgetType, widget, options);\n\t\t}\n\n\t\tthrow new Error('unknown loader ' + type);\n\t}\n\n}","import Compact from \"./compact\";\nimport Mini from \"./mini\";\nimport Split from \"./split\";\n\nexport default class Factory {\n\n\tstatic make(type, widget, options) {\n\t\tif (type === 'Compact') {\n\t\t\treturn new Compact(widget, options);\n\t\t} else if (type === 'Mini') {\n\t\t\treturn new Mini(widget, options);\n\t\t} else if (type === 'BnplOffer' || type === 'BnplRequired') {\n\t\t\treturn new Split(widget, options);\n\t\t}\n\n\t\tthrow new Error('unknown loader widget type: ' + type);\n\t}\n\n}","import Secure3d from './secure3d';\nimport Finish from './finish';\nimport Failure from './failure';\nimport Loader from './loader';\nimport Divider from './divider';\nimport Cart from './cart/cart';\nimport Payment from './payment/payment';\n\nexport default class Factory {\n\n\t/**\n\t * @param {string} type\n\t * @param {Widget} widget\n\t * @param {Object} options\n\t * @returns {Cart|Finish|Step3ds|Payment|Failure}\n\t * @throws {Error}\n\t */\n\tstatic make(type, widget, options = {}) {\n\t\tif (type === '3ds') {\n\t\t\treturn new Secure3d(widget, options);\n\t\t} else if (type === 'finished') {\n\t\t\treturn new Finish(widget, options);\n\t\t} else if (type === 'error') {\n\t\t\treturn new Failure(widget, options);\n\t\t} else if (type === 'payment') {\n\t\t\treturn new Payment(widget, options);\n\t\t} else if (type === 'cart') {\n\t\t\treturn new Cart(widget, options);\n\t\t} else if (type === 'loader') {\n\t\t\treturn new Loader(widget, options);\n\t\t}\n\n\t\tthrow new Error('unknown step ' + type);\n\t}\n\n}","import FactoryClass from './factory';\nimport WidgetClass from './widget';\n\nconst previousFactory = window.BX?.YandexPay?.Factory;\nconst previousWidget = window.BX?.YandexPay?.Widget;\n\nexport const Factory = previousFactory ?? FactoryClass;\nexport const Widget = previousWidget ?? WidgetClass;"],"names":["MutationSkeleton","constructor","element","options","el","Object","assign","this","defaults","destroy","check","MutationLoop","loop","loopTimeout","loopCancel","clearTimeout","_loopTimeout","setTimeout","timeout","MutationObserver","listener","mutations","mutation","removedNodes","removedNode","HTMLElement","contains","runCheck","observe","disconnect","anchor","getAnchor","observer","window","childList","subtree","console","warn","delay","_checkTimeout","document","body","matched","selector","split","trim","closest","EventProxy","config","callbackMap","on","name","callback","matchEvent","onBxEvent","onJQueryEvent","onPlainEvent","off","offBxEvent","offJQueryEvent","offPlainEvent","fire","data","fireBxEvent","fireJQueryEvent","firePlainEvent","type","BX","addCustomEvent","removeCustomEvent","onCustomEvent","jQuery","selfConfig","typeConfig","canProxyCallback","originalCallback","args","pushCallbackVariation","popCallbackVariation","hasPlainAndJQueryCollision","triggerHandler","CustomEvent","evt","detail","addEventListener","removeEventListener","dispatchEvent","proxy","WeakMap","set","map","result","get","delete","Subscriber","eventProxy","bind","unbind","bindOn","bindEvent","unbindOff","unbindEvent","event","Array","isArray","forEach","one","Composite","onFrameReady","boot","parent","parentElement","start","nodes","child","children","id","test","node","push","NodePreserver","found","restore","install","uninstall","installMutation","installSubscriber","installComposite","uninstallMutation","uninstallSubscriber","uninstallComposite","isEnabled","make","driverOptions","subscriber","composite","option","overrides","Template","template","vars","key","replaceKey","replaceValue","hasOwnProperty","toUpperCase","replace","indexOf","html","context","createElement","innerHTML","firstElementChild","Sdkloader","instance","load","_loadPromise","Promise","resolve","reject","testGlobal","script","getElementsByTagName","async","src","onload","loopGlobal","onerror","remove","Error","parentNode","insertBefore","YaPay","createPayment","Intersection","wait","IntersectionObserver","entries","entry","isIntersecting","target","unobserve","Display","factory","style","mount","payment","unmount","getOption","setProperty","removeProperty","Button","collectHeight","collectBorder","collectWidth","Utils","compile","theme","ButtonTheme","Black","width","ButtonWidth","Max","mountButton","unmountButton","height","border","styleHeight","styleBorder","styleWidth","Widget","borderType","borderValue","mountWidget","widgetType","WidgetType","Compact","widgetTheme","WidgetTheme","Dark","buttonTheme","borderRadius","bnplSelected","Number","unmountWidget","typeWidget","splitSelect","Factory","Concurrency","mode","widget","elements","index","splice","waitCount","setOptions","createSolution","bootSolution","bootLocal","inject","position","selectorSanitized","then","filterMedia","waitEvent","waitElement","checkElement","renderElement","insertToolsDisplay","intersection","preserve","testConcurrency","getInstance","resultParts","part","partSanitized","partSelector","matchMedia","testSelectorMedia","length","join","containerSelector","querySelector","containsSiblingElement","next","_anchor$parentElement","matches","nextElementSibling","preserver","preserveOptions","setPreserver","preserveOption","sibling","same","documentElement","pop","YandexPay","setSolution","solution","bootToolsDisplay","waitElementLoop","findElement","elementList","variant","searchBySelector","searchById","searchByClassName","reduceVisible","isCssSelector","collection","querySelectorAll","e","getElementById","getElementsByClassName","testVisible","offsetWidth","offsetHeight","getClientRects","partials","exec","display","getDisplay","_this$getOption","toLowerCase","_display$getOption","_this$getOption3","widget_type","toElements","reverse","insertAdjacentElement","namespace","_window","_window$BX","_window$BX$YandexPay","Solution","_window$BX$YandexPay$","_window$BX$YandexPay$2","_window2","_window2$BX","_window2$BX$YandexPay","_window2$BX$YandexPay2","_window2$BX$YandexPay3","_window2$BX$YandexPay4","getFactory","create","createPage","bootFactory","getDivider","label","extendDefaults","useDivider","eventConfig","waitLimit","waitTimeout","AbstractStep","delayTimeouts","render","query","url","fetch","method","headers","JSON","stringify","response","json","isRest","getElement","getElementSelector","getNode","optionKey","substr","clearDelay","showError","message","err","notify","error","Base","setWidget","Form","autosubmit","makeInputs","value","params","keys","termUrl","makeTermUrl","backUrl","location","href","encodeURIComponent","submit","Iframe","insertIframe","iframe","contentIframe","contentWindow","contentDocument","open","write","close","IframeRbs","renderIframe","service","accept","secure","externalId","paySystemId","success","go","state","catch","log","action","Step3ds","view","makeView","SecureForm","SecureIframe","SecureRbs","Finish","Failure","Loader","toElement","restoreElement","loader","loaderSelector","Divider","isRender","divider","dividerSelector","Proxy","cart","paymentData","getPaymentData","bootstrap","Rest","getButtonData","status","reason","combineOrderWithData","removeToolsDisplay","productId","currencyCode","setupId","products","env","version","merchantId","onPaymentSuccess","authorize","redirect","reasonCode","onPaymentAbort","onPaymentError","_mounted","createSession","onSuccess","onAbort","onError","agent","paymentSession","removeLoader","orderId","hash","metadata","successUrl","bindDebug","CheckoutEventType","arguments","initialContent","ButtonType","Checkout","exampleData","items","total","amount","changeOffer","newProductId","validateProduct","update","changeBasket","AVAILABLE","Site","reflow","countryCode","CountryCode","Ru","CurrencyCode","Rub","merchant","order","paymentMethods","PaymentMethodType","Card","gateway","gatewayMerchantId","allowedAuthMethods","AllowedAuthMethod","PanOnly","allowedCardNetworks","AllowedCardNetwork","UnionPay","Uzcard","Discover","AmericanExpress","Visa","Mastercard","Mir","Maestro","VisaElectron","requiredFields","billingContact","email","shippingContact","phone","shippingTypes","direct","pickup","Cash","getProducts","yapayAction","getShippingOptions","address","getPickupOptions","bounds","PaymentEventType","Process","orderAccept","code","isPaymentTypeCash","complete","CompleteReason","Success","Change","shippingAddress","shippingOptions","shippingOption","combineOrderWithDirectShipping","pickupBounds","pickupPoints","pickupInfo","getPickupDetail","pickupPointId","pickupPoint","combineOrderWithPickupShipping","Auto","paymentButton","createButton","ButtonEventType","Click","checkout","pickupId","delivery","deliveryType","shippingMethodInfo","paymentMethodInfo","contact","orderAmount","yandexPayData","yandexData","combineOrderWithProducts","pickupOption","amountSum","exampleOrder","amountA","amountB","toFixed","Cart","isBootstrap","bootProxy","delayBootstrap","destroyLocal","destroySolution","getSolution","bootCart","destroyCart","delayChangeBasket","delayChangeOffer","readyState","Pay","button","Abort","Payment","compileData","user_description","Split","displayParameters","TYPE_WIDGET","split_now","split_fee","SPLIT_SELECT_WIDGET","destroyStep","destroyPreserver","step","restoreToolsDisplay","makeStep","bootDivider","bootLoader","removeDivider","Mini","Secure3d","bootWidget","destroyWidget","previousFactory","previousWidget","_window$BX2","_window$BX2$YandexPay","FactoryClass","WidgetClass"],"mappings":"mDAAqBA,EAMpBC,YAAYC,EAASC,EAAU,SACzBC,GAAKF,OACLC,QAAUE,OAAOC,OAAO,GAAIC,KAAKN,YAAYO,SAAUL,GAG7DM,YAXoBT,EAEbQ,SAAW,CACjBE,MAAO,MCDM,MAAMC,UAAqBX,EAMzCC,YAAYC,EAASC,EAAU,UACxBD,EAASC,QAiBhBS,KAAO,UACDT,QAAQO,SAAWH,KAAKM,oBAjBxBA,cAGNJ,eACMK,aAGND,cACCE,aAAaR,KAAKS,mBACbA,aAAeC,WAAWV,KAAKK,KAAML,KAAKJ,QAAQe,SAGxDJ,aACCC,aAAaR,KAAKS,eArBCL,EAEbH,SAAWH,OAAOC,OAAO,GAAIN,EAAiBQ,SAAU,CAC9DU,QAAS,MCHI,MAAMC,UAAyBnB,EAO7CC,YAAYC,EAASC,EAAU,UACxBD,EAASC,QA8BhBiB,SAAYC,QACN,MAAMC,KAAYD,KACO,MAAzBC,EAASC,iBAER,MAAMC,KAAeF,EAASC,gBAC5BC,aAAuBC,cAEzBD,IAAgBjB,KAAKH,IAAMoB,EAAYE,SAASnB,KAAKH,sBACnDuB,iBArCHC,UAGNnB,eACMoB,aAGND,gBACOE,EAASvB,KAAKwB,kBAEN,MAAVD,QAKCE,SAAW,IAAIC,OAAOd,iBAAiBZ,KAAKa,eAC5CY,SAASJ,QAAQE,EAAQ,CAC7BI,WAAW,EACXC,SAAS,cAPTC,YAASC,KAAK,uCAWhBR,aACsB,MAAjBtB,KAAKyB,gBAEJA,SAASH,kBACTG,SAAW,MAkBjBL,iBACOW,EAAQ/B,KAAKJ,QAAQmC,MAEd,MAATA,OACEnC,QAAQO,SAEbK,aAAaR,KAAKgC,oBACbA,cAAgBtB,YAAW,UAAad,QAAQO,UAAY4B,IAInEP,eAC4B,MAAvBxB,KAAKJ,QAAQ2B,cAAyBU,SAASC,SAE/CC,EAAU,SAET,IAAIC,KAAYpC,KAAKJ,QAAQ2B,OAAOc,MAAM,QAC9CD,EAAWA,EAASE,OAEH,KAAbF,IAEJD,EAAUnC,KAAKH,GAAG0C,QAAQH,GAEX,MAAXD,gBAGEA,GA/EYvB,EAEbX,SAAWH,OAAOC,OAAO,GAAIN,EAAiBQ,SAAU,CAC9DsB,OAAQ,KACRQ,MAAO,UCNIS,cAEAC,EAAS,WACb,IAAID,EAAWC,GAGvB/C,YAAY+C,EAAS,SACfA,OAASA,OACTC,YAAc,GAGpBC,GAAGC,EAAMC,QACHC,WAAW,OAAS9C,KAAK+C,UAAUH,EAAMC,QACzCC,WAAW,WAAa9C,KAAKgD,cAAcJ,EAAMC,QACjDC,WAAW,UAAY9C,KAAKiD,aAAaL,EAAMC,GAGrDK,IAAIN,EAAMC,QACJC,WAAW,OAAS9C,KAAKmD,WAAWP,EAAMC,QAC1CC,WAAW,WAAa9C,KAAKoD,eAAeR,EAAMC,QAClDC,WAAW,UAAY9C,KAAKqD,cAAcT,EAAMC,GAGtDS,KAAKV,EAAMW,EAAO,SACZT,WAAW,OAAS9C,KAAKwD,YAAYZ,EAAMW,QAC3CT,WAAW,WAAa9C,KAAKyD,gBAAgBb,EAAMW,QACnDT,WAAW,UAAY9C,KAAK0D,eAAed,EAAMW,GAGvDT,WAAWa,UACkB,MAArB3D,KAAKyC,OAAOkB,KAAkB3D,KAAKyC,OAAOkB,IAAS3D,KAAKyC,OAAL,OAG3DM,UAAUH,EAAMC,GACG,oBAAPe,IAA2C,MAArBA,GAAGC,gBAEpCD,GAAGC,eAAejB,EAAMC,GAGzBM,WAAWP,EAAMC,GACE,oBAAPe,IAA8C,MAAxBA,GAAGE,mBAEpCF,GAAGE,kBAAkBlB,EAAMC,GAG5BW,YAAYZ,EAAMW,GACC,oBAAPK,IAA0C,MAApBA,GAAGG,eAEpCH,GAAGG,cAAcnB,EAAM,CAACW,IAGzBP,cAAcJ,EAAMC,MACG,oBAAXmB,oBAELC,EAAajE,KAAKkE,WAAW,aAE/BlE,KAAKmE,iBAAiBF,GAAa,OAChCG,EAAmBvB,EAEzBA,EAAW,IAAIwB,KACdD,KAAoBC,SAGhBC,sBAAsB,SAAUF,EAAkBvB,GAGxDmB,OAAO/B,UAAUU,GAAGC,EAAMC,GAG3BO,eAAeR,EAAMC,MACE,oBAAXmB,oBAELC,EAAajE,KAAKkE,WAAW,UAE/BlE,KAAKmE,iBAAiBF,IAGT,OAFhBpB,EAAW7C,KAAKuE,qBAAqB,SAAU1B,KAKhDmB,OAAO/B,UAAUiB,IAAIN,EAAMC,GAG5BY,gBAAgBb,EAAMW,GACC,oBAAXS,SACPhE,KAAKwE,8BAETR,OAAO/B,UAAUwC,eAAe,IAAIC,YAAY9B,EAAM,QAAYW,MAGnEN,aAAaL,EAAMC,MACd7C,KAAKwE,0CAEHP,EAAajE,KAAKkE,WAAW,YAE/BlE,KAAKmE,iBAAiBF,GAAa,OAChCG,EAAmBvB,EAEzBA,EAAY8B,IACXP,EAAiBO,EAAIC,cAGjBN,sBAAsB,QAASF,EAAkBvB,GAGvDZ,SAAS4C,iBAAiBjC,EAAMC,GAGjCQ,cAAcT,EAAMC,MACf7C,KAAKwE,0CAEHP,EAAajE,KAAKkE,WAAW,SAE/BlE,KAAKmE,iBAAiBF,IAGT,OAFhBpB,EAAW7C,KAAKuE,qBAAqB,QAAS1B,KAK/CZ,SAAS6C,oBAAoBlC,EAAMC,GAGpCa,eAAed,EAAMW,GACpBtB,SAAS8C,cAAc,IAAIL,YAAY9B,EAAM,QAAYW,KAG1DiB,iCACMxE,KAAK8C,WAAW,WAAa9C,KAAK8C,WAAW,iBAAoB,SAIrC,IAFb9C,KAAKkE,WAAW,SAEjB,OAAwC,oBAAXF,OAGjDG,iBAAiBF,UACe,IAAxBA,EAAU,MAGlBC,WAAWP,SAC0B,iBAAtB3D,KAAKyC,OAAOkB,IAA2C,MAArB3D,KAAKyC,OAAOkB,GAAgB3D,KAAKyC,OAAS,GAG3F6B,sBAAsBX,EAAMd,EAAUmC,GACP,MAA1BhF,KAAK0C,YAAYiB,UACfjB,YAAYiB,GAAQ,IAAIsB,cAGzBvC,YAAYiB,GAAMuB,IAAIrC,EAAUmC,GAGtCT,qBAAqBZ,EAAMd,MACI,MAA1B7C,KAAK0C,YAAYiB,UAAwB,WAEvCwB,EAAMnF,KAAK0C,YAAYiB,GACvByB,EAASD,EAAIE,IAAIxC,UAET,MAAVuC,GACHD,EAAIG,OAAOzC,GAGLuC,SC9JYG,EAUpB7F,YAAYC,EAASC,EAAU,SACzBC,GAAKF,OACLC,QAAUE,OAAOC,OAAO,GAAIC,KAAKN,YAAYO,SAAUL,QACvD4F,WAAa,IAAIhD,EAAWxC,KAAKJ,QAAQ6C,aAEzCgD,OAGNvF,eACMwF,cAEAF,WAAa,UACb5F,QAAU,QACVC,GAAK,KAGX4F,YACME,cACAC,YAGNF,cACMG,iBACAC,cAGNH,SACwB,MAAnB3F,KAAKJ,QAAQ+C,SAEZ/C,QAAQ+C,GAAG3C,KAAKJ,QAAQO,OAG9B0F,YACyB,MAApB7F,KAAKJ,QAAQsD,UAEZtD,QAAQsD,IAAIlD,KAAKJ,QAAQO,OAG/ByF,kBACOG,EAAQ/F,KAAKJ,QAAQmG,SAEd,MAATA,KAEiB,iBAAVA,OACLP,WAAW7C,GAAGoD,EAAO/F,KAAKJ,QAAQO,YACjC,GAAI6F,MAAMC,QAAQF,GACxBA,EAAMG,SAASC,SACTX,WAAW7C,GAAGwD,EAAKnG,KAAKJ,QAAQO,cAEhC,gBACN0B,YAASC,KAAM,6BAA4BiE,IAI7CD,oBACOC,EAAQ/F,KAAKJ,QAAQmG,SAEd,MAATA,KAEiB,iBAAVA,OACLP,WAAWtC,IAAI6C,EAAO/F,KAAKJ,QAAQO,YAClC,GAAI6F,MAAMC,QAAQF,GACxBA,EAAMG,SAASC,SACTX,WAAWtC,IAAIiD,EAAKnG,KAAKJ,QAAQO,cAEjC,gBACN0B,YAASC,KAAM,6BAA4BiE,KA5EzBR,EAEbtF,SAAW,CACjBE,MAAO,KACP4F,MAAO,KACPtD,OAAQ,GACRE,GAAI,KACJO,IAAK,YCTckD,EAMpB1G,YAAYC,EAAsBC,EAAkB,SAqBpDyG,aAAe,UACTzG,QAAQO,cArBRN,GAAKF,OACLC,QAAUE,OAAOC,OAAO,GAAIC,KAAKN,YAAYO,SAAUL,QAEvD0G,OAGNpG,gBACmB,oBAAP0D,cAEXA,OAAIE,kBAAkB,sBAAuB9D,KAAKqG,eAGnDC,mBACO/E,EAASvB,KAAKuB,SAEF,oBAAPqC,IAAgC,MAAVrC,YAEjCqC,OAAIC,eAAe,sBAAuB7D,KAAKqG,cAOhD9E,aACKgF,EAASvG,KAAKH,GAAG2G,mBAEdD,GAAQ,KACVE,GAAQ,EACRC,EAAQ,OAEP,MAAMC,KAASJ,EAAOK,YACV,MAAZD,EAAME,IAAc,MAAQ,uBAAuBC,KAAKH,EAAME,IACjEJ,GAAQ,OACF,GAAgB,MAAZE,EAAME,IAAc,MAAQ,qBAAqBC,KAAKH,EAAME,IAAK,CAC3EJ,GAAQ,MAEH,MAAMM,KAAQL,KACdK,IAAS/G,KAAKH,IAAMkH,EAAK5F,SAASnB,KAAKH,WACnCkH,EAITL,EAAQ,QACED,GACVC,EAAMM,KAAKL,GAIbJ,EAASA,EAAOC,qBAGV,MA3DYJ,EAEbnG,SAAW,CACjBE,MAAO,YCCY8G,EAgBpBvH,YAAYC,EAASC,EAAU,SA2E/BO,MAAQ,WACD+G,EAAQjF,SAASC,KAAKf,SAASnB,KAAKH,WAErCqH,QACCtH,QAAQuH,UAGPD,QAjFFrH,GAAKF,OACLC,QAAUE,OAAOC,OAAO,GAAIC,KAAKN,YAAYO,SAAUL,QAEvDwH,UAGNlH,eACMmH,iBACAzH,QAAU,QACVC,GAAK,KAGXuH,eACME,uBACAC,yBACAC,mBAGNH,iBACMI,yBACAC,2BACAC,qBAGNL,kBACMtH,KAAK4H,UAAU,mBAEf7G,2BC3CMpB,EAASC,SACmB,mBAA5B8B,OAAOd,iBACV,IAAIA,EAAiBjB,EAASC,GAG/B,IAAIQ,EAAaT,EAASC,KDsCDiI,KAAK7H,KAAKH,GAAIG,KAAK8H,cAAc,cAGlEL,oBACsB,MAAjBzH,KAAKe,eAEJA,SAASb,UAGfqH,oBACMvH,KAAK4H,UAAU,qBAEfG,WAAa,IAAIxC,EAAWvF,KAAKH,GAAIG,KAAK8H,cAAc,gBAG9DJ,sBACwB,MAAnB1H,KAAK+H,kBAEJA,WAAW7H,eACX6H,WAAa,MAGnBP,mBACMxH,KAAK4H,UAAU,oBAEfI,UAAY,IAAI5B,EAAUpG,KAAKH,GAAIG,KAAK8H,cAAc,eAG5DH,qBACuB,MAAlB3H,KAAKgI,gBAEJA,UAAU9H,UAGhB0H,UAAUjE,WACA3D,KAAKJ,QAAQ+D,GAGvBmE,cAAcnE,SACPsE,EAAuC,iBAAvBjI,KAAKJ,QAAQ+D,GAAqB3D,KAAKJ,QAAQ+D,GAAQ,GACvEuE,EAAY,CACjB/H,MAAOH,KAAKG,cAGNL,OAAOC,OAAO,GAAIkI,EAAQC,IAxFdjB,EAEbhH,SAAW,CACjBkH,QAAS,KACTY,WAAY,KACZhH,UAAU,EACViH,WAAW,SEVQG,iBAOLC,EAAUC,OACpBC,EACAC,EACAC,EACApD,EAASgD,MAERE,KAAOD,KACNA,EAAKI,eAAeH,IAEzBC,EAAa,IAAMD,EAAII,cAAgB,IACvCF,EAAeH,EAAKC,MAGnBlD,EAASA,EAAOuD,QAAQJ,EAAYC,UACI,IAAhCpD,EAAOwD,QAAQL,WAGlBnD,mBAGSyD,SACVC,EAAU7G,SAAS8G,cAAc,cACvCD,EAAQE,UAAYH,EAEbC,EAAQG,oCAGEJ,SACXC,EAAU7G,SAAS8G,cAAc,cACvCD,EAAQE,UAAYH,EAEb,IAAIC,EAAQlC,iBCtCRsC,8BAKU,MAAjBlJ,KAAKmJ,gBACHA,SAAW,IAAID,GAGdlJ,KAAKmJ,SAGbC,cAC0B,MAArBpJ,KAAKqJ,oBAEJA,aAAe,IAAIC,SAAQ,CAACC,EAASC,QACrCxJ,KAAKyJ,yBACRF,UAIKG,EAASzH,SAAS8G,cAAc,UAChCxH,EAASU,SAAS0H,qBAAqB,UAAU,IAAM1H,SAASC,KAEtEwH,EAAO/F,KAAO,kBACd+F,EAAOE,OAAQ,EACfF,EAAOG,IAAM,sCAEbH,EAAOI,OAAS,UACVC,YAAW,UACVV,aAAe,KACpBE,QAGFG,EAAOM,QAAU,UACXX,aAAe,KACpBK,EAAOO,SAEPT,EAAO,IAAIU,MAAM,sCAGlB3I,EAAO4I,WAAWC,aAAaV,EAAQnI,OA5BAvB,KAAKqJ,aAkC9CU,WAAWR,GACNvJ,KAAKyJ,aACRF,IAID7I,YAAW,UAAaqJ,WAAWR,KAAY,KAGhDE,0BACuC,gBAA/B/H,OAAO2I,gBAAOC,gBAzDVpB,EAELC,SAAW,WCFNoB,EAMZ7K,YAAYC,EAAsBC,EAAkB,SAC9CC,GAAKF,OACLC,QAAUE,OAAOC,OAAO,GAAIC,KAAKN,YAAYO,SAAUL,GAG7D4K,cACQ,IAAIlB,SAASC,IACiB,oBAAzBkB,2BAKNhJ,SAAW,IAAIgJ,sBAAqB,CAACC,EAASjJ,KAClDiJ,EAAQxE,SAASyE,OACZA,EAAMC,eAAgB,OACnBjL,EAAUgL,EAAME,OACtBpJ,EAASqJ,UAAUnL,GACnB4J,EAAQ5J,eAKN8B,SAASJ,QAAQrB,KAAKH,KAd1B0J,EAAQvJ,KAAKH,OAkBhBsH,QAAQJ,yBACFtF,aAAUqJ,UAAU9K,KAAKH,SACzBA,GAAKkH,gBACLtF,aAAUJ,QAAQrB,KAAKH,KAnCjB0K,EAELtK,SAAW,SCAE8K,EAMpBrL,YAAYsL,EAASpL,QACfoL,QAAUA,OACVpL,QAAUE,OAAOC,OAAO,GAAIC,KAAKN,YAAYO,SAAUL,GAG7DqL,SAIAC,MAAMnE,EAAMoE,EAASxH,IAIrByH,QAAQrE,EAAMoE,IAIdE,UAAUzI,UACF5C,KAAKJ,QAAQgD,GAGrB0I,eAIAC,mBA/BoBR,EAEb9K,SAAW,GCDJ,MAAMuL,UAAeT,EASnCE,cACOQ,EAAgBzL,KAAKyL,gBACrBC,EAAgB1L,KAAK0L,gBACrBC,EAAe3L,KAAK2L,sBAEnBC,EAAMC,QAAQ7L,KAAKqL,UAAU,SAAU,CAC7CJ,MAAOQ,EAAgBC,EAAgBC,IAIzCT,MAAMnE,EAAMoE,EAASxH,SACdmI,EAAQ9L,KAAKqL,UAAU,mBAAqBhB,MAAM0B,YAAYC,MAC9DC,EAAQjM,KAAKqL,UAAU,iBAAmBhB,MAAM6B,YAAYC,IAElEhB,EAAQiB,YAAYrF,EAAM,CACzBpD,KAAMA,EACNmI,MAAOA,EACPG,MAAiB,QAAVA,EAAkBA,EAAQ5B,MAAM6B,YAAYC,MAIrDf,QAAQrE,EAAMoE,GACbA,EAAQkB,cAActF,GAGvB0E,oBAEKrG,EAAS,UAIQ,OAFCpF,KAAKqL,UAAU,uBAAyB,QAM9DjG,EAASwG,EAAMC,QAAQ7L,KAAKqL,UAAU,eAAgB,CACrDxE,GAAI7G,KAAKgL,QAAQK,UAAU,eAC3BiB,OAAQtM,KAAKqL,UAAU,wBAA0B,QAL1CjG,EAWTsG,0BACKtG,EAAS,UAIQ,OAFCpF,KAAKqL,UAAU,8BAAgC,QAMrEjG,EAASwG,EAAMC,QAAQ7L,KAAKqL,UAAU,eAAgB,CACrDxE,GAAI7G,KAAKgL,QAAQK,UAAU,eAC3BkB,gBAAQvM,KAAKqL,UAAU,iCAAiC,OALjDjG,EAWTuG,mBACKvG,EAAS,SAIQ,QAFApF,KAAKqL,UAAU,kBAMpCjG,EAASwG,EAAMC,QAAQ7L,KAAKqL,UAAU,cAAe,CACpDxE,GAAI7G,KAAKgL,QAAQK,UAAU,eAC3BY,MAAOjM,KAAKqL,UAAU,uBAAyB,SALxCjG,EAWT6G,YACKA,EAAQjM,KAAKqL,UAAU,iBAAmB,YAEhC,QAAVY,IACHA,EAAQ,OAGFA,GA7FYT,EAEbvL,SAAW,CACjBgL,MAAQ,yBACRuB,YAAc,8EACdC,YAAc,kFACdC,WAAa,sGCNA,MAAMC,UAAe5B,EAQnCE,cACOS,EAAgB1L,KAAK0L,gBACrBC,EAAe3L,KAAK2L,sBAEnBC,EAAMC,QAAQ7L,KAAKqL,UAAU,SAAU,CAC7CJ,MAAOS,EAAgBC,IAIzBT,MAAMnE,EAAMoE,EAASxH,SACdiJ,EAAa5M,KAAKqL,UAAU,iCAC9BwB,EAAc7M,KAAKqL,UAAU,+BAAiC,IAEhD,MAAduB,IAAsBC,EAAc,KAExC1B,EAAQ2B,YAAY/F,EAAM,CACzBgG,WAAY/M,KAAKqL,UAAU,gBAAkBhB,MAAM2C,WAAWC,QAC9DC,YAAalN,KAAKqL,UAAU,iBAAmBhB,MAAM8C,YAAYC,KACjEC,YAAarN,KAAKqL,UAAU,wBAA0BhB,MAAM0B,YAAYC,MACxEsB,aAAcT,EACdU,eAAgBC,OAAOxN,KAAKqL,UAAU,yBAA0B,KAIlED,QAAQrE,EAAMoE,GACbA,EAAQsC,cAAc1G,GAGvB2E,0BACKtG,EAAS,UAIQ,OAFCpF,KAAKqL,UAAU,8BAAgC,QAMrEjG,EAASwG,EAAMC,QAAQ7L,KAAKqL,UAAU,eAAgB,CACrDxE,GAAI7G,KAAKgL,QAAQK,UAAU,eAC3BkB,gBAAQvM,KAAKqL,UAAU,iCAAiC,OALjDjG,EAWTuG,mBACKvG,EAAS,UAIO,OAFCpF,KAAKqL,UAAU,sBAAwB,QAM5DjG,EAASwG,EAAMC,QAAQ7L,KAAKqL,UAAU,cAAe,CACpDxE,GAAI7G,KAAKgL,QAAQK,UAAU,eAC3BY,MAAOjM,KAAKqL,UAAU,uBAAyB,SALxCjG,EAWT6G,cACQ,MAGRX,YAAYvE,SACL2G,EAAa1N,KAAKqL,UAAU,eAC5BsC,EAAc3N,KAAKqL,UAAU,uBAEjB,MAAdqC,IAEe,cAAfA,EACiB,MAAhBC,EACH5G,EAAKkE,MAAMK,YAAY,aAAc,SAErCvE,EAAKkE,MAAMK,YAAY,aAAc,SAEb,SAAfoC,EACV3G,EAAKkE,MAAMK,YAAY,aAAc,QACZ,YAAfoC,GAEe,YAAfA,EADV3G,EAAKkE,MAAMK,YAAY,aAAc,SAGZ,iBAAfoC,GACV3G,EAAKkE,MAAMK,YAAY,aAAc,UAIvCC,eAAexE,GACdrG,YAAW,KACVqG,EAAKkE,MAAMM,eAAe,gBACxB,OApGgBoB,EAEb1M,SAAW,CACjBgL,MAAQ,yBACRwB,YAAc,+HACdC,WAAa,uHCLMkB,cASRjK,EAAMqH,EAASpL,MACb,WAAT+D,SACI,IAAI6H,EAAOR,EAASpL,GACrB,GAAa,WAAT+D,SACH,IAAIgJ,EAAO3B,EAASpL,SAGtB,IAAIsK,MAAM,mBAAqBvG,UCnB1BkK,cAIAC,EAAcC,GACE,MAAvB/N,KAAKgO,SAASF,UACZE,SAASF,GAAQ,SAGlBE,SAASF,GAAM9G,KAAK+G,cAGfD,EAAcC,SAClBE,EAAQjO,KAAKgO,SAASF,GAAMlF,QAAQmF,IAE3B,IAAXE,QAECD,SAASF,GAAMI,OAAOD,EAAO,eAGvBH,yBACJ9N,KAAKgO,SAASF,MAAS,IArBnBD,EAELG,SAAW,SCOEJ,EA8BpBlO,YAAYE,EAAU,SAHtBuO,UAAY,OAINlO,SAAWH,OAAOC,OAAO,GAAIC,KAAKN,YAAYO,eAC9CL,QAAU,QAEVwO,WAAWxO,QACXyO,sBACAC,oBACAC,YAGNC,OAAOpM,EAAUqM,OACZC,SAEGpF,QAAQC,UACboF,MAAK,KACLD,EAAoB1O,KAAK4O,YAAYxM,MAErCuM,MAAK,IAAM3O,KAAK6O,cAChBF,MAAK,IAAM3O,KAAK8O,YAAYJ,KAC5BC,MAAMpN,GAAWvB,KAAK+O,aAAaxN,KACnCoN,MAAMpN,GAAWvB,KAAKgP,cAAczN,EAAQkN,KAC5CE,MAAMhP,GAAYK,KAAKoH,QAAQzH,KAC/BgP,MAAMZ,GAAW/N,KAAKiP,mBAAmBlB,KACzCY,MAAMZ,UACAmB,EAAe,IAAI3E,EAAawD,EAAOlO,WAEzCG,KAAKqL,UAAU,kBACb8D,SAAST,EAAmBD,EAAUV,EAAQmB,GAG7CA,EAAa1E,OAAOmE,MAAK,IAAMZ,OAEtCY,MAAMZ,GAAW/N,KAAKoP,gBAAgBrB,KACtCY,MAAMZ,GAAW7E,EAAUmG,cAAcjG,OAAOuF,MAAK,IAAMZ,MAG9Da,YAAYxM,SACLkN,EAAc,OAEf,MAAMC,KAAQnN,EAASC,MAAM,KAAM,OACjCmN,EAAgBD,EAAKjN,UAEL,KAAlBkN,iBAEGC,EAAcC,GAAc1P,KAAK2P,kBAAkBH,GAErDE,GAELJ,EAAYtI,KAAKyI,MAGS,IAAvBH,EAAYM,aACT,IAAI1F,MAAM,mCAAqC9H,UAG/CkN,EAAYO,KAAK,KAGzBd,aAAaxN,SACNa,EAAWpC,KAAK8P,yBAEnBvO,EAAOwO,cAAc3N,IACpBpC,KAAKgQ,uBAAuBzO,EAAQa,SAIjC,IAAI8H,MAAM,8CAGV3I,EAGRuO,0BACQ,IAAM9P,KAAKqL,UAAU,eAAiB,IAAMrL,KAAKqL,UAAU,qBAGnE2E,uBAAuBzO,EAAQa,aAC1BgD,GAAS,EACT6K,WAAO1O,EAAOiF,sBAAP0J,EAAsBjH,uBAE1BgH,GAAM,IACRA,EAAKE,QAAQ/N,IAAa6N,EAAKF,cAAc3N,GAAW,CAC3DgD,GAAS,QAIV6K,EAAOA,EAAKG,0BAGNhL,EAGR+J,SAAS/M,EAAUqM,EAAUV,EAAQmB,SAC9BmB,EAAY,IAAIpJ,EAAc8G,EAAOlO,GAAIC,OAAOC,OAAO,GAAIC,KAAKsQ,kBAAmB,CACxFnJ,QAAS,KACRkJ,EAAUnQ,eAELiH,QAAQ/E,EAAUqM,EAAUV,EAAQmB,OAI3CnB,EAAOwC,aAAaF,GAGrBC,wBACOE,EAAiBxQ,KAAKqL,UAAU,kBAEL,iBAAnBmF,EAA8BA,EAAiB,GAG9DrJ,QAAQ/E,EAAUqM,EAAUV,EAAQmB,UAC5B5F,QAAQC,UACboF,MAAK,IAAM3O,KAAK8O,YAAY1M,KAC5BuM,MAAMpN,UACA5B,EAAUK,KAAKgP,cAAczN,EAAQkN,UAE3CV,EAAO5G,QAAQxH,SACfuP,GAAAA,EAAc/H,QAAQxH,GAElBK,KAAKqL,UAAU,kBACb8D,SAAS/M,EAAUqM,EAAUV,EAAQmB,GAGpCnB,KAIVqB,gBAAgBrB,SACTD,EAAO9N,KAAKqL,UAAU,WAEhB,MAARyC,SAAuBC,MAEtB,MAAM0C,KAAW5C,EAAY6C,KAAK5C,GAClC7L,SAAS0O,gBAAgBxP,SAASsP,EAAQ5Q,MAE9C4Q,EAAQvQ,UACR2N,EAAY+C,IAAI9C,EAAM2C,WAGvB5C,EAAY7G,KAAK8G,EAAMC,GAEhBA,EAGR3G,QAAQzH,SACDoO,EAAS,IAAInK,GAAGiN,UAAUlE,OAAOhN,EAASK,KAAKJ,gBAErDmO,EAAO+C,YAAY9Q,KAAK+Q,UACxBhD,EAAOzH,OAEAyH,EAGRkB,mBAAmBlB,UAClBA,EAAOiD,mBACAjD,EAGRc,kBACOjM,EAAO5C,KAAKqL,UAAU,gBAEhB,MAARzI,EAAuB,KAEpB,IAAI0G,SAASC,UACb/D,EAAahD,EAAWqF,KAAK7H,KAAKqL,UAAU,gBAC5CxI,EAAW,KAChB2C,EAAWtC,IAAIN,EAAMC,GACrB0G,KAGD/D,EAAW7C,GAAGC,EAAMC,MAItBiM,YAAY1M,UACJ,IAAIkH,SAAQ,CAACC,EAASC,UACvB2E,UAAY,OACZ8C,gBAAgB7O,EAAUmH,EAASC,MAI1CyH,gBAAgB7O,EAAUmH,EAASC,SAC5BjI,EAASvB,KAAKkR,YAAY9O,GAE5Bb,EACHgI,EAAQhI,MAIPvB,KAAKmO,UAEHnO,KAAKmO,WAAanO,KAAKqL,UAAU,aACpC7B,EAAO,iCAAmCpH,GAI3C1B,WAAWV,KAAKiR,gBAAgBxL,KAAKzF,KAAMoC,EAAUmH,EAASC,GAASxJ,KAAKqL,UAAU,iBAGvF6F,YAAY9O,eACP+O,EAEA/L,EADAgM,EAAUhP,EAASE,UAGP,KAAZ8O,QAAwB,IAAIlH,MAAM,mCAEtCiH,oBAAcnR,KAAKqR,iBAAiBD,MAAYpR,KAAKsR,WAAWlP,MAAapC,KAAKuR,kBAAkBnP,GAEjF,MAAf+O,EAA8B,MAE9BA,EAAYvB,OAAS,IACxBxK,EAASpF,KAAKwR,cAAcL,IAGf,MAAV/L,IACHA,EAAS+L,EAAY,IAGf/L,GAGRiM,iBAAiBjP,aAETgD,EAAS,OAEV,MAAMmK,KAAQnN,EAASC,MAAM,KAAM,OACjCmN,EAAgBD,EAAKjN,UAEL,KAAlBkN,IAAyBxP,KAAKyR,cAAcjC,kBAE1CkC,EAAazP,SAAS0P,iBAAiBnC,OAExC,MAAM7P,KAAW+R,EACrBtM,EAAO4B,KAAKrH,UAIPyF,EAAOwK,OAAS,EAAIxK,EAAS,KACnC,MAAOwM,UACD,MAITN,WAAWlP,aAEHzC,EAAUsC,SAAS4P,eAAezP,UAEtB,MAAXzC,EAAkB,CAACA,GAAW,KACpC,MAAOiS,UACD,MAITL,kBAAkBnP,aAEVsP,EAAazP,SAAS6P,uBAAuB1P,UAE5CsP,EAAW9B,OAAS,EAAI8B,EAAa,KAC3C,MAAOE,UACD,MAITJ,cAAcE,OACTtM,EAAS,SAER,MAAMzF,KAAW+R,KACjB1R,KAAK+R,YAAYpS,GAAU,CAC9ByF,EAASzF,eAKJyF,EAGR2M,YAAYpS,UACHA,EAAQqS,aAAerS,EAAQsS,cAAgBtS,EAAQuS,iBAAiBtC,OAGjF6B,cAAcrP,SACN,QAAQ0E,KAAK1E,GAGrBuN,kBAAkBvN,SACX+P,EAAW,uBAAuBC,KAAKhQ,UAE7B,MAAZ+P,EAA2B,CAAE/P,GAAU,GAEpC,CACN+P,EAAS,GACTzQ,OAAOgO,WAAWyC,EAAS,IAAIhC,SAIjCnB,cAAczN,EAAQkN,mBACfrM,EAAWpC,KAAK8P,oBAChBuC,EAAUrS,KAAKsS,iBAEjBvF,EAAa,SAEG,qBAHA/M,KAAKqL,UAAU,uBAAfkH,EAA+BC,iBAIlDzF,WAAasF,EAAQhH,UAAU,uBAAlBoH,EAAkCD,qBAG1C3J,EAAO+C,EAAMC,QAAQ7L,KAAKqL,UAAU,YAAa,CACtDJ,MAAkB,MAAXoH,EAAkBA,EAAQpH,QAAU,GAC3CgB,MAAkB,MAAXoG,EAAkBA,EAAQpG,QAAQuG,cAAgB,OACzD3L,GAAI7G,KAAKqL,UAAU,eACnByC,KAAM9N,KAAKqL,UAAU,SAAW,UAChCgH,uBAAchH,UAAU,yBAAgBmH,gBAAiB,SACzDzB,kBAAU/Q,KAAKqL,UAAU,oBAAfqH,EAA4BF,cACtCG,YAAa5F,QAGViB,EAAWpC,EAAMgH,WAAW/J,GAC5BzD,EAAS,KAEqB,IAA9BqJ,EAAS7F,QAAQ,WAAkBoF,EAAWA,EAAS6E,eAEtD,MAAMlT,KAAWqO,EACrBzM,EAAOuR,sBAAsBrE,EAAU9O,GAEzB,MAAVyF,IAEJA,EAASzF,EAAQwQ,QAAQ/N,GAAYzC,EAAUA,EAAQoQ,cAAc3N,OAGxD,MAAVgD,QACG,IAAI8E,MAAO,4CAA2C9H,YAGtDgD,EAGRiJ,uBACOzL,EAAO5C,KAAKqL,UAAU,YACtByC,EAAO9N,KAAKqL,UAAU,aAEvB0F,SC1XQ,wBAEInO,oBACL,MAARA,SAAuB,SAEvBmQ,EAAWpP,GAEdoP,EAAWpP,GAAQf,EAAKP,MAAM,SAE3B2I,WAAUtJ,kBAAAsR,EAAQpP,cAARqP,EAAYpC,qBAAZqC,EAAuBC,oBAAvBC,EAAkCL,WAAlCM,EAA8CrI,6BAEhD,MAARrH,IAEHqH,WAAUtJ,kBAAA4R,EAAQ1P,cAAR2P,EAAY1C,qBAAZ2C,EAAuBL,oBAAvBM,EAAkCV,cAAlCW,EAA+C/P,WAA/CgQ,EAAsD3I,SAGlD,MAAXA,SAKGA,WAJNnJ,YAASC,KAAM,sBAAqBc,uBAOpBA,EAAMkL,SACjB9C,EAAUhL,KAAK4T,WAAWhR,UAEjB,MAAXoI,EAA0B,KAEvBA,EAAQ6I,OAAO/F,KD6VWgG,WAAWlR,EAAMkL,GAGnDQ,mCACMyC,aAAUgD,YAAY/T,MAG5BsS,mBACO3O,EAAO3D,KAAKqL,UAAU,eACtBzL,EAAUI,KAAKqL,UAAU,4BAEnB,MAAR1H,EAAuB,KAEpBoH,EAAQlD,KAAKlE,EAAM3D,KAAMJ,GAGjCoU,oBACQhU,KAAKqL,UAAU,cACnBO,EAAMC,QAAQ7L,KAAKqL,UAAU,WAAY,CAAC4I,MAAOjU,KAAKqL,UAAU,WAChE,GAGJkD,YACC/L,EAAWqF,OAAOvE,KAAK,qBAAsB,CAC5C0H,QAAShL,OAIXkU,eAAetU,QACTK,SAAWH,OAAOC,OAAOC,KAAKC,SAAUL,GAG9CwO,WAAWxO,QACLA,QAAUE,OAAOC,OAAOC,KAAKJ,QAASA,GAG5CyL,UAAUzI,yBACF5C,KAAKJ,QAAQgD,MAAS5C,KAAKC,SAAS2C,MApZrC3C,SAAW,CACjB8Q,SAAU,KACV3I,SACC,kNASD+L,YAAY,EACZrE,kBAAmB,mBACnB/J,MAAO,KACPqO,YAAa,GACbjF,SAAU,CACTnH,WAAW,GAEZqM,UAAW,GACXC,YAAa,WE7BMC,EAepB7U,YAAYqO,EAAQnO,EAAU,SAN9B4U,cAAgB,QAOVzG,OAASA,OACT9N,SAAWH,OAAOC,OAAO,GAAIC,KAAKN,YAAYO,eAC9CL,QAAUE,OAAOC,OAAO,GAAIH,GAGlCM,WASAmL,UAAUzI,oCACF5C,KAAKJ,QAAQgD,MAAS5C,KAAK+N,OAAO1C,UAAUzI,MAAS5C,KAAKC,SAAS2C,GAO3E6R,OAAO1N,EAAMxD,EAAO,IACnBwD,EAAKiC,UAAYhJ,KAAK6L,QAAQtI,GAO/BsI,QAAQtI,UACA4E,EAAS0D,QAAQ7L,KAAKqL,UAAU,YAAa9H,GAMrD4D,QAAQJ,IASR2N,MAAMC,EAAKpR,UACHqR,MAAMD,EAAK,CACjBE,OAAQ,OACRC,QAAS,gBAAkB,oBAC3B5S,KAAM6S,KAAKC,UAAUzR,KAEpBoL,MAAKsG,GAAoBA,EAASC,SAGrCC,gBACQnV,KAAKqL,UAAU,UAGvB+J,WAAW9M,EAAKQ,EAAS+L,OACpBzS,EAAWpC,KAAKqV,mBAAmB/M,UAEhCtI,KAAKsV,QAAQlT,EAAU0G,EAAS+L,GAAU,iBAGlDQ,mBAAmB/M,OACdiN,EAAYjN,EAAM,iBAEftI,KAAKJ,QAAQ2V,GAGrBD,QAAQlT,EAAU0G,EAAS+L,SACI,MAA1BzS,EAASoT,OAAO,EAAG,GACtB1M,EAAU7G,SACC6G,IACXA,EAAU9I,KAAKH,IAGTiJ,EAAQ+L,GAAQzS,GAGxBqT,WAAW7S,GACsB,MAA5B5C,KAAKwU,cAAc5R,KAEvBpC,aAAaR,KAAKwU,cAAc5R,SAC3B4R,cAAc5R,GAAQ,MAG5Bb,MAAMa,EAAMyB,EAAO,GAAI1D,EAAU,UAC3B8U,WAAW7S,QACX4R,cAAc5R,GAAQlC,WAAWV,KAAK4C,GAAM6C,KAAKzF,QAASqE,GAAO1D,GAGvE+U,UAAU/R,EAAMgS,EAASC,EAAM,UAC1BC,EAASlS,EAAO,MAAQgS,EAExBC,IACHC,GAAU,IAAMD,GAGjB/T,QAAQiU,MAAMD,IApHKtB,EAEbtU,SAAW,CACjBmI,SAAU,UCHS2N,EAKpBrW,YAAYE,EAAU,SAChBA,QAAUE,OAAOC,OAAO,GAAIC,KAAKN,YAAYO,SAAUL,QACvDmO,OAAS,KAGf0G,OAAO1N,EAAMxD,EAAO,IACnBwD,EAAKiC,UAAYhJ,KAAK6L,QAAQtI,GAG/BsI,QAAQtI,UACA4E,EAAS0D,QAAQ7L,KAAKJ,QAAQwI,SAAU7E,GAGhDyS,UAAUjI,QACJA,OAASA,EAGf1C,UAAU/C,UACLA,KAAOtI,KAAKJ,QACRI,KAAKJ,QAAQ0I,GAEbtI,KAAK+N,OAAOnO,QAAQ0I,IA1BTyN,EACb9V,SAAW,CACjBmI,SAAU,MCDG,MAAM6N,UAAaF,EAQjCtB,OAAO1N,EAAMxD,SACNkR,OAAO1N,EAAMxD,QACd2S,WAAWnP,GAGjB8E,QAAQtI,SACD6E,EAAWpI,KAAKJ,QAAQwI,SACxBC,EAAOvI,OAAOC,OAAOwD,EAAM,QACtBvD,KAAKmW,WAAW5S,YAGpB4E,EAAS0D,QAAQzD,EAAUC,GAGnC8N,WAAW5S,OACN+E,EAEA8N,EACAhO,EAFAC,EAAO9E,EAAK8S,UAIiB,IAA7BvW,OAAOwW,KAAKjO,GAAMuH,aAAuB,OAIxCtH,KAFLF,EAAW7E,EAAKgT,QAAU,8CAAgDlO,EAAKkO,QAAU,KAAO,GAEpFlO,EAENA,EAAKI,eAAeH,KAEzB8N,EAAQ/N,EAAKC,GAEbF,GAAY,8BAAgCE,EAAM,YAAc8N,EAAQ,aAGlEhO,EAGRoO,kBACKpR,EAASpF,KAAKqL,UAAU,aACxBoL,EAAU/U,OAAOgV,SAASC,YAE9BvR,KAC2B,IAAzBA,EAAOwD,QAAQ,KAAc,IAAM,KAClC,WAAagO,mBAAmBH,GAChC,YAAczW,KAAKqL,UAAU,eAC7B,cAAgBrL,KAAKqL,UAAU,cAE3BjG,EAGR8Q,WAAWnP,GACGA,EAAKgJ,cAAc,QAE3B8G,UA5DcZ,EAEbhW,SAAW,CACjBmI,SAAU,yECHG,MAAM0O,UAAef,EAMnCtB,OAAO1N,EAAMxD,QACPwT,aAAahQ,EAAMxD,GAGzBwT,aAAahQ,EAAMxD,GAClBwD,EAAKiC,UAAYb,EAAS0D,QAAQ7L,KAAKJ,QAAQwI,SAAU7E,QACpDsI,QAAQ9E,EAAMxD,GAGpBsI,QAAQ9E,EAAMxD,OACTyT,EAASjQ,EAAKgJ,cAAc,UAC5BkH,EAAgBD,EAAOE,eAAmBF,EAAOG,gBAAgBlV,UAAY+U,EAAOG,gBACpFtO,EAAOtF,EAAK8S,OAEhBY,EAAchV,SAASmV,OACvBH,EAAchV,SAASoV,MAAMxO,GAC7BoO,EAAchV,SAASqV,SAtBJR,EAEb7W,SAAW,CACjBmI,SAAU,4CCHG,MAAMmP,UAAkBxB,EAMtCtB,OAAO1N,EAAMxD,QACPwT,aAAahQ,EAAMxD,GAGzBwT,aAAahQ,EAAMxD,GAClBwD,EAAKiC,UAAYb,EAAS0D,QAAQ7L,KAAKJ,QAAQwI,SAAU7E,QACpDsI,QAAQ9E,EAAMxD,GAGpBsI,QAAQ9E,EAAMxD,GACb+F,QAAQC,UACNoF,MAAK,IAAM3O,KAAKwX,aAAazQ,EAAMxD,KACnCoL,MAAK,IAAM3O,KAAK0U,MAAMnR,KAGzBmR,MAAOnR,GACNqR,MAAM5U,KAAKqL,UAAU,aAAc,CAClCwJ,OAAQ,OACRC,QAAS,gBACQ,oBAEjB5S,KAAM6S,KAAKC,UAAU,CACpByC,QAASzX,KAAKqL,UAAU,eACxBqM,OAAQ,OACRC,OAAQpU,EAAK8S,OAAOsB,OACpBC,WAAYrU,EAAK8S,OAAOR,OAAO+B,WAC/BC,YAAatU,EAAK8S,OAAOR,OAAOgC,gBAGhClJ,MAAKsG,GAAYA,EAASC,SAC1BvG,MAAKvJ,KACkB,IAAnBA,EAAO0S,aACL/J,OAAOgK,GAAG3S,EAAO4S,MAAO5S,QAExB2I,OAAOgK,GAAG,QAAS3S,MAGzB6S,OAAMnC,GAASjU,QAAQqW,IAAIpC,KAG9B0B,aAAazQ,EAAMxD,OACdyT,EAASjQ,EAAKgJ,cAAc,UAC5BkH,EAAgBD,EAAOE,eAAmBF,EAAOG,gBAAgBlV,UAAY+U,EAAOG,gBACpFtO,EAAQ,6BAA4BtF,EAAK4U,yBAE7ClB,EAAchV,SAASmV,OACvBH,EAAchV,SAASoV,MAAMxO,GAC7BoO,EAAchV,SAASqV,QAEvBL,EAAchV,SAAS8N,cAAc,QAAQ8G,UAvD1BU,EAEbtX,SAAW,CACjBmI,SAAU,4CCDG,MAAMgQ,UAAgB7D,EAEpCE,OAAO1N,EAAMxD,SACN8U,EAAOrY,KAAKsY,SAAS/U,GAC3B8U,EAAKrC,UAAUhW,KAAK+N,QACpBsK,EAAK5D,OAAO1N,EAAMxD,GAGnB+U,SAAS/U,OACJ8U,EAAO9U,EAAK8U,QAEH,SAATA,SACI,IAAIE,EACL,GAAa,WAATF,SACH,IAAIG,EACL,GAAa,cAATH,SACH,IAAII,QAGN,IAAIvO,MAAM,0BCtBH,MAAMwO,UAAenE,GAAfmE,EAEbzY,SAAW,CACjBmI,SAAU,kFCHG,MAAMuQ,UAAgBpE,GAAhBoE,EAEb1Y,SAAW,CACjBmI,SAAU,iFCFG,MAAMwQ,UAAerE,EAOnCE,OAAO1N,EAAMxD,EAAO,OACyC,MAAxDwD,EAAKgJ,cAAc/P,KAAKqL,UAAU,gCAEhCxC,EAAO7I,KAAK6L,QAAQtI,GACpB5D,EAAUiM,EAAMiN,UAAUhQ,GAEhC9B,EAAK+L,sBAAsB,YAAanT,QACnCmZ,eAAiBnZ,EAGvBwH,QAAQJ,GACoB,MAAvB/G,KAAK8Y,gBAET/R,EAAK+L,sBAAsB,YAAa9S,KAAK8Y,gBAG9C7O,OAAOlD,SACAgS,EAAShS,EAAKgJ,cAAc/P,KAAKqL,UAAU,yBACjD0N,GAAAA,EAAQ9O,UAzBW2O,EAEb3Y,SAAW,CACjBmI,SAAU,gDACV4Q,eAAgB,8BCJH,MAAMC,UAAgB1E,EAWpCE,OAAO1N,EAAMxD,EAAO,UACb4G,EAAapD,EAAKP,cAClB0S,QAAW/O,SAAAA,EAAY4F,cAAc/P,KAAKqL,UAAU,wBAGxDrL,KAAKqL,UAAU,eACD,MAAZ6N,eAGErQ,EAAO7I,KAAK6L,QAAQ,CAACoI,MAAOjU,KAAKqL,UAAU,WAC3C1L,EAAUiM,EAAMiN,UAAUhQ,GAEhC9B,EAAK+L,sBAAsB,cAAenT,QACrCmZ,eAAiBnZ,EAGvBwH,QAAQJ,GACoB,MAAvB/G,KAAK8Y,gBACT/R,EAAK+L,sBAAsB,cAAe9S,KAAK8Y,gBAGhD7O,OAAOlD,SACAoD,EAAapD,EAAKP,cAClB2S,QAAUhP,SAAAA,EAAY4F,cAAc/P,KAAKqL,UAAU,0BACzD8N,GAAAA,EAASlP,UAnCUgP,EAEbhZ,SAAW,CACjBmI,SAAU,oMAKVgR,gBAAiB,2BCXEC,EAMpB3Z,YAAY4Z,QACNA,KAAOA,OACPvL,OAASuL,EAAKvL,YACdwL,YAAcvZ,KAAKwZ,iBAGzBnO,UAAUzI,UACF5C,KAAKsZ,KAAKjO,UAAUzI,GAG5B6W,aAIAnP,cAAcvD,EAAMwS,IAIpBC,kBAIArS,QAAQJ,IAIRmE,MAAMnE,EAAMoE,KC7BE,MAAMuO,UAAaL,EAEjCI,iBACM1L,OAAOiD,wBACP2I,gBACHhL,MAAMvJ,OACgB,SAAlBA,EAAOwU,aAA2B,IAAI1P,MAAM9E,EAAOyU,aAClDC,qBAAqB1U,EAAO7B,WAC5B+G,cAActK,KAAKsZ,KAAK3Z,QAASK,KAAKuZ,gBAE3CtB,OAAOnC,SACF/H,OAAOgM,wBAIfJ,oBAEKpW,EAAO,CACVyW,UAAWha,KAAKqL,UAAU,aAC1ByC,KAAM9N,KAAKqL,UAAU,QACrB4O,aAAcja,KAAKqL,UAAU,gBAC7B6O,QAASla,KAAKqL,UAAU,WACxB8O,SAAUna,KAAKqL,UAAU,oBAGnBrL,KAAKsZ,KAAK5E,MAAM1U,KAAKqL,UAAU,WAAa,cAAe9H,GAGnEiW,uBACQ,CACNY,IAAKpa,KAAKqL,UAAU,OACpBgP,QAAS,EACTC,WAAYta,KAAKqL,UAAU,cAC3BiO,KAAM,CAAE1B,WAAY,8BACpBqC,aAAcja,KAAKqL,UAAU,iBAI/BkP,iBAAiBxU,QACXyU,UAAUzU,GACb4I,MAAMvJ,IACgB,YAAlBA,EAAOwU,OACVlZ,YAAW,WACVgB,OAAOgV,SAASC,KAAOvR,EAAO7B,KAAKkX,WACjC,UAGEnB,KAAK5D,UAAU,YAAatQ,EAAOsV,WAAYtV,EAAOyU,WAI9DrX,EAAWqF,OAAOvE,KAAK,wBAAyByC,GAGjD4U,eAAe5U,GACdvD,EAAWqF,OAAOvE,KAAK,sBAAuByC,GAG/C6U,eAAe7U,GACdvD,EAAWqF,OAAOvE,KAAK,sBAAuByC,QACzCuT,KAAK5D,UAAU,eAAe,sBAAuB3P,EAAM8T,QAGjEvP,cAAcvD,EAAMwS,GACE,MAAjBvZ,KAAK6a,gBAEJA,UAAW,EAEhBxQ,MAAMyQ,cAAcvB,EAAa,CAChCwB,UAAW/a,KAAKua,iBAAiB9U,KAAKzF,MACtCgb,QAAShb,KAAK2a,eAAelV,KAAKzF,MAClCib,QAASjb,KAAK4a,eAAenV,KAAKzF,MAClCkb,MAAO,CAAEtY,KAAM,aAAcyX,QAAS,SAErC1L,MAAMwM,SACDN,UAAW,OACXvB,KAAKjH,QAAQ/G,YAAYvE,QACzBgH,OAAOqN,oBACPlQ,MAAMiQ,QACN7B,KAAKjH,QAAQ9G,eAAexE,MAEjCkR,OAAOrC,SACFiF,SAAW,KAChB9T,EAAKkD,cACAqP,KAAK5D,UAAU,eAAgB,sBAAuBE,OAI9D4E,UAAUzU,OACLxC,EAAO,CACV8X,QAAStV,EAAMsV,QACfC,KAAMvV,EAAMwV,SACZC,WAAYxb,KAAKqL,UAAU,sBAGrBrL,KAAKsZ,KAAK5E,MAAM1U,KAAKqL,UAAU,WAAa,YAAa9H,GAGjEkY,UAAUtQ,OACJ,MAAM7C,KAAO+B,MAAMqR,kBAClBrR,MAAMqR,kBAAkBjT,eAAeH,IAE5C6C,EAAQxI,GAAG0H,MAAMqR,kBAAkBpT,IAAM,WACxCzG,QAAQqW,IAAIyD,cAKfzQ,MAAMC,QACAmO,KAAKsC,eAAiB,UACtBzQ,QAAUA,OACVmO,KAAKjH,QAAQnH,MAAMlL,KAAKsZ,KAAK3Z,QAASwL,EAASd,MAAMwR,WAAWC,UACrEtZ,EAAWqF,OAAOvE,KAAK,sBAGxB8H,eACMyP,SAAW,UACXvB,KAAKjH,QAAQjH,QAAQpL,KAAKsZ,KAAK3Z,QAASK,KAAKmL,cAC7C4C,OAAOgM,qBAGb5S,QAAQJ,GACa,MAAhB/G,KAAKmL,eACJmO,KAAKjH,QAAQnH,MAAMnE,EAAM/G,KAAKmL,QAASd,MAAMwR,WAAWC,UAC7DtZ,EAAWqF,OAAOvE,KAAK,yBAGxBwW,qBAAqBvW,SACd+V,KAAEA,GAAStZ,KAAKuZ,gBAElBwC,EAAc,CACjBzC,KAAM,IACFA,EACH0C,MAAOzY,EAAKyY,MACZC,MAAO,CACNC,OAAQ3Y,EAAK0Y,MAAMC,SAGrBX,SAAUhY,EAAKgY,UAGhBzb,OAAOC,OAAOC,KAAKuZ,YAAawC,GAGjCI,YAAYC,GACKpc,KAAKqL,UAAU,eAEb+Q,SAEbrO,OAAOK,WAAW,CAAC4L,UAAWoC,IAE9Bpc,KAAKqc,gBAAgBD,KAEL,MAAjBpc,KAAK6a,cACHpB,iBAGA6C,WAIPC,oBACMD,SAGNA,cACMnR,QAAQmR,QAAO1S,gBACbxE,QAAepF,KAAK2Z,gBACxBhL,MAAKvJ,GAAUA,IACf6S,OAAOnC,SACF1K,eACAkO,KAAK5D,UAAU,gBAAgB,sBAAuBI,SAGvC,SAAlB1Q,EAAOwU,kBACLxO,UACC,IAAIlB,MAAM9E,EAAOyU,cAGjB,CACNP,KAAM,CACL0C,MAAO5W,EAAO7B,KAAKyY,OAEpBC,MAAO,CACNC,OAAQ9W,EAAO7B,KAAK0Y,MAAMC,QAE3BX,SAAUnW,EAAO7B,KAAKgY,aAKzBc,gBAAgBrC,SACTG,EAAWna,KAAKqL,UAAU,eAEf,MAAb2O,GAAiC,MAAZG,GAAwC,IAApBA,EAASvK,OACtD,KACMuK,EAAS1R,eAAeuR,UAAqB,KAE9Cha,KAAKqL,UAAU,mBAAuD,MAAlC8O,EAASH,GAAWwC,sBACtDpR,WACE,SAIF,GC7MM,MAAMqR,UAAapD,EAEjCI,iBACMiD,SAGNlD,qBACKD,EAAc,CACjBa,IAAKpa,KAAKqL,UAAU,OACpBgP,QAAS,EACTsC,YAAatS,MAAMuS,YAAYC,GAC/B5C,aAAc5P,MAAMyS,aAAaC,IACjCC,SAAU,CACTnW,GAAI7G,KAAKqL,UAAU,cACnBzI,KAAM5C,KAAKqL,UAAU,gBACrBsJ,IAAK3U,KAAKqL,UAAU,YAErB4R,MAAO,CAAEpW,GAAI,KACbqW,eAAgB,CACf,CACCvZ,KAAM0G,MAAM8S,kBAAkBC,KAC9BC,QAASrd,KAAKqL,UAAU,WACxBiS,kBAAmBtd,KAAKqL,UAAU,qBAClCkS,mBAAoB,CAAClT,MAAMmT,kBAAkBC,SAC7CC,oBAAqB,CACpBrT,MAAMsT,mBAAmBC,SACzBvT,MAAMsT,mBAAmBE,OACzBxT,MAAMsT,mBAAmBG,SACzBzT,MAAMsT,mBAAmBI,gBACzB1T,MAAMsT,mBAAmBK,KACzB3T,MAAMsT,mBAAmBM,WACzB5T,MAAMsT,mBAAmBO,IACzB7T,MAAMsT,mBAAmBQ,QACzB9T,MAAMsT,mBAAmBS,gBAK5BC,eAAgB,CAEfC,eAAgB,CACfC,MAAOve,KAAKqL,UAAU,cAAe,GAGtCmT,gBAAiB,CAChB5b,KAAM5C,KAAKqL,UAAU,aAAc,EACnCkT,MAAOve,KAAKqL,UAAU,cAAe,EACrCoT,MAAOze,KAAKqL,UAAU,cAAe,GAGtCqT,cAAe,CACdC,QAAQ,EACRC,QAAQ,YAK0B,MAAjC5e,KAAKqL,UAAU,gBAClBkO,EAAY2D,eAAelW,KAAK,CAC/BrD,KAAM0G,MAAM8S,kBAAkB0B,OAIzBtF,EAGRuF,kBAEKvb,EAAO,CACVwb,YAAa,cACb/E,UAAWha,KAAKqL,UAAU,aAC1ByC,KAAM9N,KAAKqL,UAAU,QACrB6O,QAASla,KAAKqL,UAAU,mBAGlBrL,KAAKsZ,KAAK5E,MAAM1U,KAAKqL,UAAU,eAAgB9H,GAGvDyb,mBAAmBC,OAEd1b,EAAO,CACV0b,QAASA,EACTF,YAAa,kBACb/C,MAAOhc,KAAKuZ,YAAY0D,MAAMjB,MAC9B9B,QAASla,KAAKqL,UAAU,WACxBwM,YAAa7X,KAAKqL,UAAU,uBAGtBrL,KAAKsZ,KAAK5E,MAAM1U,KAAKqL,UAAU,eAAgB9H,GAGvD2b,iBAAiBC,OAEZ5b,EAAO,CACV4b,OAAQA,EACRJ,YAAa,gBACb/C,MAAOhc,KAAKuZ,YAAY0D,MAAMjB,MAC9B9B,QAASla,KAAKqL,UAAU,WACxBwM,YAAa7X,KAAKqL,UAAU,uBAGtBrL,KAAKsZ,KAAK5E,MAAM1U,KAAKqL,UAAU,eAAgB9H,GAGvD+G,cAAcvD,EAAMwS,GACE,MAAjBvZ,KAAK6a,gBAEJA,UAAW,EAEhBxQ,MAAMC,cAAciP,EAAa,CAAE2B,MAAO,CAAEtY,KAAM,aAAcyX,QAAS,SACvE1L,MAAMxD,SACD0P,UAAW,OAEX9M,OAAOqN,oBACPhP,YAAYrF,EAAMoE,GAEvBA,EAAQxI,GAAG0H,MAAM+U,iBAAiBC,SAAUtZ,SAEtCuZ,YAAYvZ,GAAO4I,MAAMvJ,OAEzBA,EAAO0Q,YAAe,IAAI5L,MAAM9E,EAAO0Q,MAAMH,QAASvQ,EAAO0Q,MAAMyJ,MAEnEvf,KAAKwf,kBAAkBzZ,IAWzBoF,EAAQsU,SAASpV,MAAMqV,eAAeC,SAEf,MAAnBva,EAAOqV,WACV/Y,OAAOgV,SAASC,KAAOvR,EAAOqV,gBAb3B5E,OAAOzQ,EAAQW,GAAO4I,MAAKvJ,KACR,IAAnBA,EAAO0S,cACL/J,OAAOgK,GAAG3S,EAAO4S,MAAO5S,GAC7B+F,EAAQsU,SAASpV,MAAMqV,eAAeC,gBAEjC5R,OAAOgK,GAAG,QAAS3S,GACxB+F,EAAQsU,SAASpV,MAAMqV,eAAexV,cAWxC+N,OAAOnC,SACFwD,KAAK5D,UAAU,eAAgB,GAAII,GACxC3K,EAAQsU,SAASpV,MAAMqV,eAAexV,aAIzCiB,EAAQxI,GAAG0H,MAAM+U,iBAAiBlV,OAAQnE,SACpCuT,KAAK5D,UAAU,aAAc,iCAClCvK,EAAQsU,SAASpV,MAAMqV,eAAexV,UAGvCiB,EAAQxI,GAAG0H,MAAM+U,iBAAiBQ,QAAS7Z,IAEtCA,EAAM8Z,sBACJb,mBAAmBjZ,EAAM8Z,iBAAiBlR,MAAMvJ,IACpD+F,EAAQmR,OAAO,CAACwD,gBAAiB1a,OAK/BW,EAAMga,gBACT5U,EAAQmR,OAAO,CACdW,MAAOjd,KAAKggB,+BAA+Bja,EAAMga,kBAK/Cha,EAAMka,mBACJf,iBAAiBnZ,EAAMka,cAActR,MAAMvJ,IAC/C+F,EAAQmR,OAAO,CAAC4D,aAAc9a,OAI5BW,EAAMoa,iBACJC,gBAAgBra,EAAMoa,WAAWE,eAAe1R,MAAMvJ,IAC1D+F,EAAQmR,OAAO,CACdgE,YAAalb,OAMZW,EAAMua,aACTnV,EAAQmR,OAAO,CACdW,MAAOjd,KAAKugB,+BAA+Bxa,EAAMua,qBAKpDrI,OAAOrC,SACFiF,SAAW,UACXvB,KAAK5D,UAAU,eAAe,sBAAuBE,OAI7DxJ,YAAYrF,EAAMoE,QACZmO,KAAKsC,eAAiB,WAErB9P,EAAQ9L,KAAKsZ,KAAKjH,QAAQhH,UAAU,mBAAqBhB,MAAM0B,YAAYC,MAC3EC,EAAQjM,KAAKsZ,KAAKjH,QAAQhH,UAAU,iBAAmBhB,MAAM6B,YAAYsU,UAE1EC,cAAgBtV,EAAQuV,aAAa,CACzC/c,KAAM0G,MAAMwR,WAAWC,SACvBhQ,MAAOA,EACPG,MAAOA,SAGHwU,cAAcvV,MAAMlL,KAAKsZ,KAAK3Z,cAE9B8gB,cAAc9d,GAAG0H,MAAMsW,gBAAgBC,OAAO,KAClDzV,EAAQ0V,cAIVT,gBAAgBU,OACXvd,EAAO,CACVud,SAAUA,EACV/B,YAAa,eACb/C,MAAOhc,KAAKuZ,YAAY0D,MAAMjB,MAC9B9B,QAASla,KAAKqL,UAAU,WACxBwM,YAAa7X,KAAKqL,UAAU,uBAGtBrL,KAAKsZ,KAAK5E,MAAM1U,KAAKqL,UAAU,eAAgB9H,GAGvD+b,YAAYvZ,OAGPgb,EADAC,EAAejb,EAAMkb,mBAAmBlB,eAAiB,WAAa,SAIzEgB,EADoB,WAAjBC,EACQ,CACV/B,QAASlZ,EAAMkb,mBAAmBX,YAAYrB,QAC9CL,OAAQ7Y,EAAMkb,mBAAmBX,aAIvB,CACVrB,QAASlZ,EAAMkb,mBAAmBpB,gBAClCkB,SAAUhb,EAAMkb,mBAAmBlB,oBAejCxc,EAAO,IAXK,CACf2W,QAASla,KAAKqL,UAAU,WACxB2Q,MAAOhc,KAAKuZ,YAAY0D,MAAMjB,MAC9B7Q,QAASpF,EAAMmb,kBACfC,QAASpb,EAAMyY,gBACfO,YAAa,cACbiC,aAAcA,EACdnJ,YAAa7X,KAAKwf,kBAAkBzZ,GAAS/F,KAAKqL,UAAU,eAAiBrL,KAAKqL,UAAU,eAC5F+V,YAAarb,EAAMqb,gBAGSL,UAEtB/gB,KAAKsZ,KAAK5E,MAAM1U,KAAKqL,UAAU,eAAgB9H,GAGvDic,kBAAkBzZ,SACwB,SAAjCA,EAAMmb,kBAAkBvd,KAGjCkS,OAAO1K,EAASkW,OAEX9d,EAAO,CACVkU,QAASzX,KAAKqL,UAAU,eACxBqM,OAAQ,OACR4J,WAAYD,EACZzJ,WAAYzM,EAAQyM,WACpBC,YAAa1M,EAAQ0M,oBAGf7X,KAAKsZ,KAAK5E,MAAM1U,KAAKqL,UAAU,aAAc9H,GAGrD4Y,YAAYC,GACKpc,KAAKqL,UAAU,eAEb+Q,SACZrO,OAAOK,WAAW,CAAC4L,UAAWoC,SAC9BM,UAIPH,oBACMG,SAGNA,l//DACMoC,cACHnQ,MAAMvJ,OACFA,EAAO0Q,YAAe,IAAI5L,MAAM9E,EAAO0Q,MAAMH,cAE5C4L,yBAAyBnc,QACzBkF,cAActK,KAAKsZ,KAAK3Z,QAASK,KAAKuZ,gBAE3CtB,OAAOnC,SACF/H,OAAOqN,kBAKfmF,+BAA+BiB,SACxBvE,MAAEA,GAAUjd,KAAKuZ,kBAEhB,IACH0D,EACHjB,MAAO,IACHiB,EAAMjB,MACT,CACCrY,KAAM,WACNsQ,MAAOuN,EAAavN,MACpBiI,OAAQsF,EAAatF,SAGvBD,MAAO,IACHgB,EAAMhB,MACTC,OAAQlc,KAAKyhB,UAAUxE,EAAMhB,MAAMC,OAAQsF,EAAatF,UAK3D8D,+BAA+BD,SACxB9C,MAAEA,GAAUjd,KAAKuZ,kBAEhB,IACH0D,EACHjB,MAAO,IACHiB,EAAMjB,MACT,CACCrY,KAAM,WACNsQ,MAAO8L,EAAe9L,MACtBiI,OAAQ6D,EAAe7D,SAGzBD,MAAO,IACHgB,EAAMhB,MACTC,OAAQlc,KAAKyhB,UAAUxE,EAAMhB,MAAMC,OAAQ6D,EAAe7D,UAK7DqF,yBAAyBpH,SAClB8C,MAAEA,GAAUjd,KAAKuZ,gBAEnBmI,EAAe,IACfzE,EACHjB,MAAO7B,EAAS6B,MAChBC,MAAO,CACNC,OAAQ/B,EAAS+B,SAInBpc,OAAOC,OAAOC,KAAKuZ,YAAY0D,MAAOyE,GAGvCva,QAAQJ,GACmB,MAAtB/G,KAAKygB,oBAIJA,cAAcvV,MAAMnE,GAG1B0a,UAAUE,EAASC,UACVpU,OAAOmU,GAAWnU,OAAOoU,IAAUC,QAAQ,IC1WtC,MAAMC,UAAavN,EAOjCE,OAAO1N,EAAMxD,QACP5D,QAAUoH,OACVsL,QAAUrS,KAAKsS,kBACfsJ,eAAiB5b,KAAKL,QAAQqJ,eAC9B+Y,aAAc,OAEdC,iBACA1T,oBACAC,iBACA0T,iBAGN/hB,eACMgiB,oBACAC,kBAGNH,iBACMhd,MAAQhF,KAAKmV,SAAW,IAAIuE,EAAK1Z,MAAQ,IAAIyc,EAAKzc,MAGxDmH,QAAQJ,GACoB,MAAvB/G,KAAK4b,iBACR7U,EAAKiC,UAAYhJ,KAAK4b,qBAGlBjc,QAAUoH,OACV/B,MAAMmC,QAAQJ,GAGpB0S,iBACMsI,aAAc,OACd/c,MAAMyU,YAGZnL,mCACMP,OAAOqU,kBAAeC,SAASriB,MAGrCmiB,sCACMpU,OAAOqU,kBAAeE,YAAYtiB,MAGxCuO,YACC/L,EAAWqF,OAAOvE,KAAK,kBAAmB,CACzCgW,KAAMtZ,OAIRkiB,eACC1f,EAAWqF,OAAOvE,KAAK,qBAAsB,CAC5CgW,KAAMtZ,OAIRuiB,yBACMxgB,MAAM,gBAGZygB,iBAAiBxI,QACXjY,MAAM,cAAe,CAACiY,IAG5BiI,iBC7EM,IAAepf,EAAAA,ED8Ed,UACAd,MAAM,cC9Ee,aAAxBE,SAASwgB,YAAqD,gBAAxBxgB,SAASwgB,WAClD/hB,WAAWmC,EAAU,GAErBZ,SAAS4C,iBAAiB,mBAAoBhC,GD+E/C0Z,qBACMvc,KAAK+hB,4BACL/c,UAAOuX,gBAGbJ,YAAYC,SACPpc,KAAK+hB,0BACH/c,UAAOmX,YAAYC,QAEnBrO,OAAOK,WAAW,CAAC4L,UAAWoC,IAIrC9J,mBACO3O,EAAO3D,KAAKqL,UAAU,eACtBzL,EAAUI,KAAKqL,UAAU,4BACxBN,EAAQlD,KAAKlE,EAAM3D,KAAMJ,UEnGbyZ,EAKpB3Z,YAAYyL,QACNA,QAAUA,OACV4C,OAAS5C,EAAQ4C,OAGvB1C,UAAUzI,UACF5C,KAAKmL,QAAQE,UAAUzI,GAG/B0H,cAAcvD,EAAMwS,IAIpBC,eAAejW,KCfD,MAAMmW,UAAaL,EAEjCG,eAAejW,SACP,CACN6W,IAAKpa,KAAKqL,UAAU,OACpBgP,QAAS,EACTJ,aAAc5P,MAAMyS,aAAaC,IACjCzC,WAAYta,KAAKqL,UAAU,cAC3BgQ,QAAS9X,EAAKsD,GACdyS,KAAM,CACL0C,MAAOzY,EAAKyY,MACZC,MAAO,CACNC,OAAQ3Y,EAAK0Y,QAGfV,SAAUvb,KAAKqL,UAAU,aAI3BkP,iBAAiBxU,QACXqF,eACAoP,UAAUzU,GACb4I,MAAMvJ,IACgB,YAAlBA,EAAOwU,OACVlZ,YAAW,WACVgB,OAAOgV,SAASC,KAAOvR,EAAO7B,KAAKkX,WACjC,UAGEtP,QAAQuK,UAAU,YAAatQ,EAAOsV,WAAYtV,EAAOyU,WAKlEc,eAAe5U,GACdvD,EAAWqF,OAAOvE,KAAK,sBAAuByC,GAG/C6U,eAAe7U,GACdrF,YAAW,KACVgB,OAAOgV,SAASC,KAAO3W,KAAKqL,UAAU,aACpC,KAGJf,cAAcvD,EAAMwS,GACnBlP,MAAMyQ,cAAcvB,EAAa,CAChCwB,UAAW/a,KAAKua,iBAAiB9U,KAAKzF,MACtCgb,QAAShb,KAAK2a,eAAelV,KAAKzF,MAClCib,QAASjb,KAAK4a,eAAenV,KAAKzF,MAClCkb,MAAO,CAAEtY,KAAM,aAAcyX,QAAS,SAErC1L,MAAOwM,SACFpN,OAAOqN,oBACPlQ,MAAMiQ,MAEXlD,OAAQrC,SACHzK,QAAQuK,UAAU,eAAe,sBAAuBE,MAIhE1K,MAAMC,QACAgQ,eAAiBhQ,OACjBA,QAAQkH,QAAQnH,MAAMlL,KAAKmL,QAAQxL,QAASwL,EAASd,MAAMwR,WAAW6G,KAC3ElgB,EAAWqF,OAAOvE,KAAK,sBAGxB8H,eACMD,QAAQkH,QAAQjH,QAAQpL,KAAKmL,QAAQxL,QAASK,KAAKmb,qBACnDpN,OAAOgM,qBAGbS,UAAUzU,OACLxC,EAAO,CACV8X,QAAStV,EAAMsV,QACfC,KAAMvV,EAAMwV,SACZC,WAAYxb,KAAKqL,UAAU,sBAGrBrL,KAAKmL,QAAQuJ,MAAM1U,KAAKqL,UAAU,WAAa,YAAa9H,IC/EtD,MAAMkZ,UAAapD,EAEjCG,eAAejW,SACP,CACN6W,IAAKpa,KAAKqL,UAAU,OACpBgP,QAAS,EACTsC,YAAatS,MAAMuS,YAAYC,GAC/B5C,aAAc5P,MAAMyS,aAAaC,IACjCC,SAAU,CACTnW,GAAI7G,KAAKqL,UAAU,cACnBzI,KAAM5C,KAAKqL,UAAU,iBAEtB4R,MAAO,CACNpW,GAAItD,EAAKsD,GACToV,MAAO,CAAEC,OAAQ3Y,EAAK0Y,OACtBD,MAAOzY,EAAKyY,OAEbkB,eAAgB,CACf,CACCvZ,KAAM0G,MAAM8S,kBAAkBC,KAC9BC,QAASrd,KAAKqL,UAAU,WACxBiS,kBAAmBtd,KAAKqL,UAAU,qBAClCkS,mBAAoB,CAAClT,MAAMmT,kBAAkBC,SAC7CC,oBAAqB,CACpBrT,MAAMsT,mBAAmBC,SACzBvT,MAAMsT,mBAAmBE,OACzBxT,MAAMsT,mBAAmBG,SACzBzT,MAAMsT,mBAAmBI,gBACzB1T,MAAMsT,mBAAmBK,KACzB3T,MAAMsT,mBAAmBM,WACzB5T,MAAMsT,mBAAmBO,IACzB7T,MAAMsT,mBAAmBQ,QACzB9T,MAAMsT,mBAAmBS,iBAO9B9T,cAAcvD,EAAMwS,GACnBlP,MAAMC,cAAciP,EAAa,CAAE2B,MAAO,CAAEtY,KAAM,aAAcyX,QAAS,SACvE1L,MAAOxD,QACHwX,EAASxX,EAAQuV,aAAa,CACjC/c,KAAM0G,MAAMwR,WAAW6G,IACvB5W,MAAO9L,KAAKqL,UAAU,gBAAkBhB,MAAM0B,YAAYC,MAC1DC,MAAOjM,KAAKqL,UAAU,gBAAkBhB,MAAM6B,YAAYsU,YAGtDzS,OAAOqN,eACZuH,EAAOzX,MAAMnE,GAEb4b,EAAOhgB,GAAG0H,MAAMsW,gBAAgBC,OAAO,WACtCzV,EAAQ0V,cAGT1V,EAAQxI,GAAG0H,MAAM+U,iBAAiBC,SAAUtZ,SAEtC8P,OAAO1K,EAASpF,GAAO4I,MAAMvJ,QAElC+F,EAAQsU,SAASpV,MAAMqV,eAAeC,YAGvCxU,EAAQxI,GAAG0H,MAAM+U,iBAAiBlV,OAAO,SAAwBnE,GAChElE,QAAQqW,IAAI,QAAWnS,IACvBoF,EAAQsU,SAASpV,MAAMqV,eAAexV,UAGvCiB,EAAQxI,GAAG0H,MAAM+U,iBAAiBwD,OAAO,SAAwB7c,UAEjEkS,OAAM,SAAUrC,GAChB/T,QAAQqW,IAAI,sBAAuBtC,OAItCC,OAAO1K,EAASkW,UACRzM,MAAM5U,KAAKqL,UAAU,aAAc,CACzCwJ,OAAQ,OACRC,QAAS,gBACQ,oBAEjB5S,KAAM6S,KAAKC,UAAU,CACpByC,QAASzX,KAAKqL,UAAU,eACxBqM,OAAQ,OACR4J,WAAYD,EACZzJ,WAAY5X,KAAKqL,UAAU,cAC3BwM,YAAa7X,KAAKqL,UAAU,mBAG5BsD,MAAKsG,GAAYA,EAASC,SAC1BvG,MAAKvJ,KACkB,IAAnBA,EAAO0S,aACL/J,OAAOgK,GAAG3S,EAAO4S,MAAO5S,QAExB2I,OAAOgK,GAAG,QAAS3S,MAGzB6S,OAAMnC,GAASjU,QAAQqW,IAAIpC,MC7FhB,MAAM+M,UAAgBtO,EAIpCE,OAAO1N,EAAMxD,QACP5D,QAAUoH,OACVsL,QAAUrS,KAAKsS,kBAEf0P,kBAECzI,EAAcvZ,KAAKwZ,eAAejW,QACnC+G,cAAcvD,EAAMwS,GAG1ByI,iBACMhd,MAAQhF,KAAKmV,SAAW,IAAIuE,EAAK1Z,MAAQ,IAAIyc,EAAKzc,MAGxDwZ,eAAejW,UACPvD,KAAKgF,MAAMwU,eAAejW,GAGlC+G,cAAcvD,EAAMwS,QACdvU,MAAMsF,cAAcvD,EAAMwS,GAGhCjH,mBACO3O,EAAO3D,KAAKqL,UAAU,eACtBzL,EAAUI,KAAKqL,UAAU,4BAExBN,EAAQlD,KAAKlE,EAAM3D,KAAMJ,UChCbgZ,EAMpBlZ,YAAYqO,EAAQnO,QACdmO,OAASA,OACTnO,QAAUE,OAAOC,OAAO,GAAIC,KAAKN,YAAYO,SAAUL,QACvDA,QAAQoZ,eAAiB,6BAG/BvE,OAAO1N,EAAMxD,EAAO,OACyC,MAAxDwD,EAAKgJ,cAAc/P,KAAKqL,UAAU,gCAEhCxC,EAAOV,EAAS0D,QAAQ7L,KAAKqL,UAAU,YAAa9H,GACpD5D,EAAUiM,EAAMiN,UAAUhQ,GAEhC9B,EAAK+L,sBAAsB,YAAanT,QACnCmZ,eAAiBnZ,EAGvBwH,QAAQJ,GACoB,MAAvB/G,KAAK8Y,gBAET/R,EAAK+L,sBAAsB,YAAa9S,KAAK8Y,gBAG9C7O,OAAOlD,SACAgS,EAAShS,EAAKgJ,cAAc/P,KAAKqL,UAAU,yBACjD0N,GAAAA,EAAQ9O,SAQToB,UAAUzI,oCACF5C,KAAKJ,QAAQgD,MAAS5C,KAAK+N,OAAO1C,UAAUzI,MAAS5C,KAAKC,SAAS2C,MArCpE3C,SAAW,CACjBmI,SAAU,ICJG,MAAMoD,UAAeoN,KAE5B3Y,SAAW,CACjBmI,SAAU,2FCDG,MAAM6E,UAAgB2L,EAYpCnE,OAAO1N,EAAMxD,EAAW,OACqC,MAAxDwD,EAAKgJ,cAAc/P,KAAKqL,UAAU,8BAGlCyX,EAAc,CACjBC,iBAAkB,IAGN,YALA/iB,KAAKqL,UAAU,UAM3ByX,EAAYC,iBAAoB,iUAO3Bla,EAAOV,EAAS0D,QAAQ7L,KAAKqL,UAAU,YAAayX,GACpDnjB,EAAUiM,EAAMiN,UAAUhQ,GAEhC9B,EAAK+L,sBAAsB,YAAanT,QACnCmZ,eAAiBnZ,GAhCHsN,EAEbhN,SAAW,CACjBmI,SAAW,kRCLE,MAAM6E,UAAgB2L,KAE7B3Y,SAAW,CACjBmI,SAAW,0QCDE,MAAM4a,UAAcpK,EA+ClCnE,OAAO1N,EAAMxD,EAAO,OACyC,MAAxDwD,EAAKgJ,cAAc/P,KAAKqL,UAAU,gCAEhC4X,EAAoBjjB,KAAKqL,UAAU,qBACnCyC,EAAO9N,KAAKqL,UAAU,YACxByX,EAGHA,EADsC,wBAAnCG,SAAAA,EAAmBC,aACR,CACbvf,KAAM,cACNwf,UAAW,+KAEXC,UAAW,kFAEyC,aAA3CH,SAAAA,EAAmBI,qBACf,CACb1f,KAAM,mBACNwf,UAAW,+KAEXC,UAAW,kFAGE,CACbzf,KAAM,UACNwf,UAAW,GACXC,UAAW,IAKZN,EAAYC,iBADA,YAATjV,EAC6B,iXAOD,SAG1BjF,EAAOV,EAAS0D,QAAQ7L,KAAKqL,UAAU,YAAayX,GACpDnjB,EAAUiM,EAAMiN,UAAUhQ,GAEhC9B,EAAK+L,sBAAsB,YAAanT,QACnCmZ,eAAiBnZ,GA3FHqjB,EAEb/iB,SAAW,CACjBmI,SAAW,m1DCDQuE,EAmBpBjN,YAAYC,EAASC,EAAU,SACzBK,SAAWH,OAAOC,OAAO,GAAIC,KAAKN,YAAYO,eAC9CL,QAAU,QACVC,GAAKF,OAELyO,WAAWxO,GAGjB0G,YACMgI,eAGNpO,eACMojB,mBACAnB,uBACAoB,mBAMNpY,QAAQ5H,QACFwU,GAAG,UAAWxU,GAMpB+V,KAAK/V,QACCwU,GAAG,OAAQxU,GAGjB4D,QAAQxH,cACFE,GAAKF,gBACL6jB,SAAMrc,QAAQxH,QACd8jB,oBAAoB9jB,GAO1BoY,GAAGpU,EAAMJ,QACHigB,KAAOxjB,KAAK0jB,SAAS/f,QACrB6f,KAAK/O,OAAOzU,KAAKH,GAAI0D,GAG3B+f,kCACME,SAAMtjB,UAGZ8Q,wBACM2S,mBACAC,aAGNH,oBAAoB9jB,uBACdwZ,YAAShS,QAAQxH,GAGvBoa,0BACM8J,qBACAzI,eAGNuI,cACqB,MAAhB3jB,KAAKmZ,eAEHA,QAAU,IAAIF,EAAQjZ,YAGvBmZ,QAAQ1E,OAAOzU,KAAKH,IAG1BgkB,gBACqB,MAAhB7jB,KAAKmZ,eACJA,QAAQlP,OAAOjK,KAAKH,SACpBsZ,QAAU,MAGhByK,aACoB,MAAf5jB,KAAK+Y,cACHA,yBCtGKpV,EAAMoK,EAAQnO,MACZ,WAAT+D,SACI,IAAI6H,EAAOuC,EAAQnO,GACpB,GAAa,WAAT+D,EAAmB,OACvBoJ,EAAanN,EAAO,kBAAsBsjB,qCCHtCvf,EAAMoK,EAAQnO,MACZ,YAAT+D,SACI,IAAIsJ,EAAQc,EAAQnO,GACrB,GAAa,SAAT+D,SACH,IAAImgB,EAAK/V,EAAQnO,GAClB,GAAa,cAAT+D,GAAiC,iBAATA,SAC3B,IAAIqf,EAAMjV,EAAQnO,SAGpB,IAAIsK,MAAM,+BAAiCvG,KDL3BkE,KAAKkF,EAAYgB,EAAQnO,SAGzC,IAAIsK,MAAM,kBAAoBvG,KD8FdkE,KAAK7H,KAAKqL,UAAU,eAAgBrL,KAAMA,KAAKJ,eAGhEmZ,OAAOtE,OAAOzU,KAAKH,IAGzBub,eACoB,MAAfpb,KAAK+Y,cACJA,OAAO9O,OAAOjK,KAAKH,SACnBkZ,OAAS,MAQf2K,SAAS/f,SACF/D,EAAUI,KAAKqL,UAAU1H,IAAS,4BG5G7BA,EAAMoK,EAAQnO,EAAU,OACtB,QAAT+D,SACI,IAAIogB,EAAShW,EAAQnO,GACtB,GAAa,aAAT+D,SACH,IAAI+U,EAAO3K,EAAQnO,GACpB,GAAa,UAAT+D,SACH,IAAIgV,EAAQ5K,EAAQnO,GACrB,GAAa,YAAT+D,SACH,IAAIkf,EAAQ9U,EAAQnO,GACrB,GAAa,SAAT+D,SACH,IAAIme,EAAK/T,EAAQnO,GAClB,GAAa,WAAT+D,SACH,IAAIiV,EAAO7K,EAAQnO,SAGrB,IAAIsK,MAAM,gBAAkBvG,KH+FfkE,KAAKlE,EAAM3D,KAAMJ,GAGrC2Q,aAAaF,QACPA,UAAYA,EAGlBkT,uCACMlT,cAAWnQ,UAGjB4Q,YAAYC,QACNA,SAAWA,EAGjBqR,qBACQpiB,KAAK+Q,SAGbzC,mCACM8T,kBAAe4B,WAAWhkB,MAGhCmiB,sCACMC,kBAAe6B,cAAcjkB,MAGnCkU,eAAetU,QACTK,SAAWH,OAAOC,OAAOC,KAAKC,SAAUL,GAG9CwO,WAAWxO,QACLA,QAAUE,OAAOC,OAAOC,KAAKJ,QAASA,GAG5CyL,UAAUzI,yBACF5C,KAAKJ,QAAQgD,MAAS5C,KAAKC,SAAS2C,kBA3JrC3C,SAAW,GILnB,MAAMikB,WAAkBxiB,OAAOkC,cAAPqP,EAAWpC,kBAAXqC,EAAsBtF,QACxCuW,WAAiBziB,OAAOkC,cAAPwgB,EAAWvT,kBAAXwT,EAAsB1X,OAEhCiB,QAAUsW,EAAAA,EAAmBI,EAC7B3X,QAASwX,EAAAA,EAAkBI"}