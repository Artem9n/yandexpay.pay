{"version":3,"file":"script.js","sources":["src/mapsLoader.js","src/suggestwidget.js","src/suggest.js","src/index.js"],"sourcesContent":["export class MapsLoader {\r\n\r\n\tstatic instance;\r\n\r\n\tstatic defaults = {\r\n\t\tscriptUrl: 'https://api-maps.yandex.ru/2.1?lang=ru&wizard=bitrix&load=package.full&mode=release', // todo locale and wizard\r\n\t\tloadStep: 100,\r\n\t\tloadTimeout: 5000,\r\n\t};\r\n\r\n\t_loadPromise;\r\n\t_loadElapsed;\r\n\r\n\tstatic getInstance() : MapsLoader {\r\n\t\tif (this.instance == null) {\r\n\t\t\tthis.instance = new this();\r\n\t\t}\r\n\r\n\t\treturn this.instance;\r\n\t}\r\n\r\n\tconstructor(options: Object = {}) {\r\n\t\tthis.options = Object.assign({}, this.constructor.defaults, options);\r\n\t}\r\n\r\n\tload(apiKey: string) : Promise {\r\n\t\tif (this._loadPromise != null) { return this._loadPromise; }\r\n\r\n\t\tconst loaded = this.loaded();\r\n\r\n\t\tif (loaded != null) { return Promise.resolve(loaded); }\r\n\r\n\t\tif (apiKey == null || apiKey === '') {\r\n\t\t\treturn Promise.reject(new Error (BX.message('YAPAY_FIELD_WAREHOUSE_MAPS_API_KEY_NOT_FOUND')));\r\n\t\t}\r\n\r\n\t\tthis._loadElapsed = 0;\r\n\t\tthis._loadPromise = new Promise((resolve, reject) => {\r\n\t\t\tthis.injectScript(apiKey);\r\n\t\t\tthis.waitLoaded(resolve, reject);\r\n\t\t});\r\n\r\n\t\tthis._loadPromise.finally(() => {\r\n\t\t\tthis._loadPromise = null;\r\n\t\t})\r\n\r\n\t\treturn this._loadPromise;\r\n\t}\r\n\r\n\tloaded() {\r\n\t\tif (window.ymaps?.Map == null) { return null; }\r\n\r\n\t\treturn window.ymaps;\r\n\t}\r\n\r\n\tinjectScript(apiKey: string) : void {\r\n\t\tconst anchor = window.document.head || window.document.body || window.document.documentElement;\r\n\t\tconst script = document.createElement('script');\r\n\r\n\t\tscript.src = this.options.scriptUrl + '&apikey=' + encodeURIComponent(apiKey);\r\n\r\n\t\tanchor.appendChild(script);\r\n\r\n\t\tscript.onload = () => {\r\n\t\t\tanchor.removeChild(script);\r\n\t\t};\r\n\t}\r\n\r\n\twaitLoaded(resolve, reject) : void {\r\n\t\tconst loaded = this.loaded();\r\n\r\n\t\tif (loaded != null) {\r\n\t\t\tresolve(loaded);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (this._loadElapsed > this.options.loadTimeout) {\r\n\t\t\treject(new Error(BX.message('YAPAY_FIELD_WAREHOUSE_CANT_LOAD_MAPS')));\r\n\t\t}\r\n\r\n\t\tsetTimeout(\r\n\t\t\t() => { this.waitLoaded(resolve, reject) },\r\n\t\t\tthis.options.loadStep\r\n\t\t);\r\n\r\n\t\tthis._loadElapsed += this.options.loadStep;\r\n\t}\r\n\r\n}","import \"./suggestwidget.css\";\r\n\r\nexport class SuggestWidget extends BX.ui.autoComplete {\r\n\r\n\tconstructor(options) {\r\n\t\tsuper(options.widget);\r\n\r\n\t\tthis.onSelect = options.onSelect;\r\n\t\tthis.search = options.search;\r\n\t}\r\n\r\n\tdestroy() {\r\n\t\tthis.cleanupDOM();\r\n\t}\r\n\r\n\tcleanupDOM() {\r\n\t\tconst input = this.ctrls?.inputs?.origin;\r\n\t\tconst container = this.ctrls?.container;\r\n\r\n\t\tinput && (input.style.display = '');\r\n\t\tcontainer && container.remove();\r\n\t}\r\n\r\n\thandleInitStack(nf, owner, opts) {\r\n\t\tthis.setOptions();\r\n\t\tsuper.handleInitStack(nf, owner, opts);\r\n\t}\r\n\r\n\tsetOptions() {\r\n\t\tBX.merge(this, {\r\n\t\t\topts: {\r\n\t\t\t\tmessages: {\r\n\t\t\t\t\tnothingFound: BX.message('YAPAY_FIELD_WAREHOUSE_SUGGEST_NOTING_FOUND'),\r\n\t\t\t\t\terror: BX.message('YAPAY_FIELD_WAREHOUSE_SUGGEST_ERROR'),\r\n\t\t\t\t},\r\n\t\t\t\tbindEvents: {\r\n\t\t\t\t\tinit: function() {}, // disable set initial value\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tsys: {\r\n\t\t\t\tcode: 'yapay-suggest'\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tdownloadBundle(request, onLoad, onComplete, onError) {\r\n\t\tthis.search(request, onLoad, onComplete, onError);\r\n\t}\r\n\r\n\t// invokes when user selects value\r\n\tselectItem = (value) => {\r\n\t\tsuper.selectItem(value);\r\n\t\tthis.onSelect(value);\r\n\t}\r\n\r\n\tshowLoading() {\r\n\t\tthis.vars.loader.show();\r\n\t}\r\n\thideLoading() {\r\n\t\tthis.vars.loader.hide();\r\n\t}\r\n\r\n\tshowError(errorLabel, messages, sysDesc) {\r\n\t\tif (errorLabel === '') {\r\n\t\t\terrorLabel = this.opts.messages.error;\r\n\t\t}\r\n\t\tsuper.showError(errorLabel, messages, sysDesc);\r\n\t}\r\n}\r\n","import {SuggestWidget} from \"./suggestwidget\";\r\n\r\nexport class Suggest {\r\n\r\n\tstatic defaults = {\r\n\r\n\t};\r\n\r\n\t_itemsData = {};\r\n\r\n\tconstructor(element: $, options: Object = {}) {\r\n\t\tthis.$el = element;\r\n\t\tthis.el = this.$el[0];\r\n\t\tthis.options = Object.assign({}, this.constructor.defaults, options);\r\n\r\n\t\tthis.initialize();\r\n\t}\r\n\r\n\tinitialize() {\r\n\t\tthis.bootWidget();\r\n\t\tthis.bind();\r\n\t}\r\n\r\n\tdestroy() {\r\n\t\tthis.unbind();\r\n\t\tthis.destroyWidget();\r\n\t}\r\n\r\n\tbind() {\r\n\t\tthis.handleMapDoubleClick(true);\r\n\t}\r\n\r\n\tunbind() {\r\n\t\tthis.handleMapDoubleClick(false);\r\n\t}\r\n\r\n\thandleMapDoubleClick(dir: boolean) : void {\r\n\t\tthis.options.map.events[dir ? 'add' : 'remove'](\"dblclick\", this.onMapDoubleClick);\r\n\t}\r\n\r\n\tonMapDoubleClick = (e) => {\r\n\t\tconst coords = e.get('coords');\r\n\r\n\t\tthis.drawPlacemark(coords);\r\n\t\tthis.fillCoordinates(coords);\r\n\r\n\t\tymaps.geocode(coords)\r\n\t\t\t.then((response) => {\r\n\t\t\t\tconst geoObject = response.geoObjects.get(0);\r\n\t\t\t\tconst title = this.geoObjectTitle(geoObject);\r\n\t\t\t\tconst address = this.geoObjectAddress(geoObject);\r\n\r\n\t\t\t\tthis.fillSuggest(title);\r\n\t\t\t\tthis.fillAddress(address);\r\n\t\t\t})\r\n\t\t\t.catch(() => {\r\n\t\t\t\tthis.options.error(BX.message('YAPAY_FIELD_WAREHOUSE_SUGGEST_MAP_ERROR'));\r\n\t\t\t});\r\n\t}\r\n\r\n\tbootWidget() {\r\n\t\tthis.widget = new SuggestWidget({\r\n\t\t\twidget: {\r\n\t\t\t\tscope: this.el,\r\n\t\t\t},\r\n\t\t\tonSelect: this.onSuggestSelect,\r\n\t\t\tsearch: this.onSuggestSearch\r\n\t\t});\r\n\t}\r\n\r\n\tdestroyWidget() {\r\n\t\tif (this.widget == null) { return; }\r\n\r\n\t\tthis.widget.destroy();\r\n\t\tthis.widget = null;\r\n\t}\r\n\r\n\tonSuggestSelect = (value) => {\r\n\t\tif (this._itemsData[value] == null) {\r\n\t\t\tthrow new Error('cant find associated data for item');\r\n\t\t}\r\n\r\n\t\tconst data = this._itemsData[value];\r\n\r\n\t\tthis.fillAddress(data.address);\r\n\t\tthis.fillCoordinates(data.coordinates);\r\n\t\tthis.drawPlacemark(data.coordinates);\r\n\t\tthis.moveCenter(data.coordinates);\r\n\t}\r\n\r\n\tonSuggestSearch = (request, onLoad, onComplete, onError) => {\r\n\r\n\t\tthis.widget.showLoading();\r\n\r\n\t\tymaps.geocode(request['QUERY'])\r\n\t\t\t.then((response) => {\r\n\t\t\t\tconst result = [];\r\n\r\n\t\t\t\tthis._itemsData = {};\r\n\r\n\t\t\t\tfor (let i = 0; i < response.geoObjects.getLength(); i++) {\r\n\t\t\t\t\tconst geoObject = response.geoObjects.get(i);\r\n\t\t\t\t\tconst title = this.geoObjectTitle(geoObject);\r\n\r\n\t\t\t\t\tresult.push({\r\n\t\t\t\t\t\tVALUE: title,\r\n\t\t\t\t\t\tDISPLAY: title,\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tthis._itemsData[title] = {\r\n\t\t\t\t\t\tcoordinates: this.geoObjectCoordinates(geoObject),\r\n\t\t\t\t\t\taddress: this.geoObjectAddress(geoObject),\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.widget.hideLoading();\r\n\t\t\t\tonLoad.apply(this.widget, [result]);\r\n\t\t\t\tonComplete.call(this.widget);\r\n\t\t\t})\r\n\t\t\t.catch((e) => {\r\n\t\t\t\tthis.widget.hideLoading();\r\n\t\t\t\tthis.options.error(BX.message('YAPAY_FIELD_WAREHOUSE_SUGGEST_MAP_ERROR'));\r\n\t\t\t\tthis.widget.showError('', false, e);\r\n\t\t\t\tonComplete && onComplete.call(this.widget);\r\n\t\t\t\tonError && onError.call(this.widget);\r\n\t\t\t});\r\n\t}\r\n\r\n\tgeoObjectCoordinates(geoObject) : Array {\r\n\t\treturn geoObject.geometry.getCoordinates();\r\n\t}\r\n\r\n\tgeoObjectTitle(geoObject) : string {\r\n\t\treturn geoObject.properties.get('metaDataProperty').GeocoderMetaData.text;\r\n\t}\r\n\r\n\tgeoObjectAddress(geoObject) : Object {\r\n\t\tconst address = geoObject.properties.get('metaDataProperty').GeocoderMetaData.Address.Components;\r\n\t\tconst map = {\r\n\t\t\tcountry: 'COUNTRY',\r\n\t\t\tstreet: 'STREET',\r\n\t\t\tdistrict: 'STREET',\r\n\t\t\thouse: 'BUILDING',\r\n\t\t\tlocality: 'LOCALITY',\r\n\t\t};\r\n\t\tconst result = {};\r\n\r\n\t\tfor (let i = 0; i < address.length; i++) {\r\n\t\t\tconst part = address[i];\r\n\t\t\tconst target = map[part.kind];\r\n\r\n\t\t\tif (target == null) { continue; }\r\n\r\n\t\t\tresult[target] = part.name;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tfillSuggest(text: string) : void {\r\n\t\tthis.$el.find('input[data-name=\"FULL_ADDRESS\"]').val(text);\r\n\t}\r\n\r\n\tfillAddress(address: Object) : void {\r\n\t\tfor (const [type, value] of Object.entries(address)) {\r\n\t\t\tthis.options.details.find(`input[data-name=\"${type}\"]`).val(value);\r\n\t\t}\r\n\t}\r\n\r\n\tfillCoordinates(coordinates: Array) : void {\r\n\t\tthis.options.details.find('input[data-name=\"LOCATION_LAT\"]').val(coordinates[0]);\r\n\t\tthis.options.details.find('input[data-name=\"LOCATION_LON\"]').val(coordinates[1]);\r\n\t}\r\n\r\n\tdrawPlacemark(coordinates: Array) : void {\r\n\t\tthis.options.map.geoObjects.removeAll();\r\n\t\tthis.options.map.geoObjects.add(new ymaps.Placemark(coordinates));\r\n\t}\r\n\r\n\tmoveCenter(coordinates: Array) : void {\r\n\t\tthis.options.map.setCenter(coordinates, 16);\r\n\t}\r\n}","import {MapsLoader} from \"./mapsLoader\";\nimport {Suggest} from \"./suggest\";\n\nimport \"./index.css\";\n\nexport class Warehouse extends BX.YandexPay.Plugin.Base {\n\n\tstatic defaults = {\n\t\tmapElement: '.js-field-warehouse__map',\n\t\tsuggestElement: '.js-field-warehouse__suggest',\n\t\tclarifyElement: '.js-field-warehouse__clarify',\n\t\tdetailsElement: '.js-field-warehouse__details',\n\t\tdialogElement: '.bx-core-adm-dialog-content',\n\t\terrorElement: '.js-js-field-warehouse-error',\n\t\tapiKey: null,\n\t};\n\n\tstatic dataName = 'uiFieldWarehouse';\n\n\tconstructor(...args) {\n\t\tsuper(...args);\n\t\tthis.postInitialize();\n\t}\n\n\tdestroy() {\n\t\tthis.unbind();\n\t\tthis.destroySuggest();\n\t\tthis.destroyMap();\n\t\tsuper.destroy();\n\t}\n\n\tpostInitialize() {\n\t\tthis.bind();\n\n\t\tMapsLoader.getInstance().load(this.options.apiKey)\n\t\t\t.then(() => {\n\t\t\t\tthis.bootMap();\n\t\t\t\tthis.bootSuggest();\n\t\t\t\tthis.showSavedPlacemark();\n\t\t\t\tthis.focusSuggest();\n\t\t\t})\n\t\t\t.catch((error: Error) => {\n\t\t\t\tthis.showError(error.message);\n\t\t\t\tthis.openDetails();\n\t\t\t\tthis.focusDetails();\n\t\t\t});\n\t}\n\n\tbind() {\n\t\tthis.handleClarifyClick(true);\n\t\tthis.handleDialogResize(true);\n\t}\n\n\tunbind() {\n\t\tthis.handleClarifyClick(false);\n\t\tthis.handleDialogResize(false);\n\t}\n\n\thandleClarifyClick(dir: boolean) : void {\n\t\tthis.getElement('clarify')[dir ? 'on' : 'off']('click', this.onClarifyClick);\n\t}\n\n\thandleDialogResize(dir: boolean) : void {\n\t\tBX[dir ? 'addCustomEvent' : 'removeCustomEvent']('onWindowResize', this.onDialogResize);\n\t}\n\n\tonDialogResize = () => {\n\t\tconst dialog = this.$el.closest(this.options.dialogElement);\n\n\t\tif (dialog.length === 0) { return; }\n\n\t\tthis.$el.width(dialog.width() - 1);\n\t\tthis.$el.height(dialog.height() - 1);\n\n\t\tthis._map.container.fitToViewport();\n\t}\n\n\tonClarifyClick = () => {\n\t\tthis.toggleDetails();\n\t}\n\n\ttoggleDetails() : void {\n\t\tconst $button = this.getElement('clarify');\n\t\tconst newText = $button.data('alt');\n\t\t$button.data('alt', $button.html());\n\t\t$button.html(newText);\n\n\t\tconst $details = this.getElement('details');\n\t\tconst readonly = $details.hasClass('readonly');\n\t\t$details.toggleClass('readonly');\n\t\t$details.find('input').prop('readonly', !readonly);\n\t}\n\n\topenDetails() : void {\n\t\tconst $details = this.getElement('details');\n\t\tif ($details.hasClass('readonly')) {\n\t\t\tthis.toggleDetails();\n\t\t}\n\t}\n\n\tbootMap() {\n\t\tconst element = this.getElement('map');\n\n\t\tthis._map = new ymaps.Map(element[0], {\n\t\t\tcenter: [55.76, 37.64],\n\t\t\tcontrols: ['zoomControl'],\n\t\t\tbehaviors: ['drag', 'scrollZoom', 'multiTouch'],\n\t\t\tzoom: 10\n\t\t}, {\n\t\t\tyandexMapDisablePoiInteractivity: true,\n\t\t});\n\n\t\treturn this._map;\n\t}\n\n\tdestroyMap() {\n\t\tif (this._map == null) { return; }\n\n\t\tthis._map.destroy();\n\t\tthis._map = null;\n\t}\n\n\tbootSuggest() {\n\t\tconst element = this.getElement('suggest');\n\n\t\tthis._suggest = new Suggest(element, {\n\t\t\tmap: this._map,\n\t\t\tdetails: this.getElement('details'),\n\t\t\terror: this.onSuggestError\n\t\t});\n\t}\n\n\tdestroySuggest() {\n\t\tif (this._suggest == null) { return; }\n\n\t\tthis._suggest.destroy();\n\t\tthis._suggest = null;\n\t}\n\n\tonSuggestError = (message) => {\n\t\tthis.showError(message);\n\t\tthis.openDetails();\n\t\tthis.focusDetails();\n\t}\n\n\tshowSavedPlacemark() : void {\n\t\tconst lat = this.getElement('details').find('input[data-name=\"LOCATION_LAT\"]').val();\n\t\tconst lon = this.getElement('details').find('input[data-name=\"LOCATION_LON\"]').val();\n\n\t\tif (!lat || !lon) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._suggest.drawPlacemark([lat, lon]);\n\t\tthis._suggest.moveCenter([lat, lon]);\n\t}\n\n\tfocusSuggest() : void {\n\t\tthis.$el.find('input[data-name=\"FULL_ADDRESS\"]').focus();\n\t}\n\n\tfocusDetails() : void {\n\t\tthis.getElement('details').find('input').first().focus();\n\t}\n\n\tshowError(message) : void {\n\t\tthis.getElement('error').html(message).show();\n\t}\n}\n"],"names":["MapsLoader","static","this","instance","constructor","options","Object","assign","defaults","load","apiKey","_loadPromise","loaded","Promise","resolve","reject","Error","BX","message","_loadElapsed","injectScript","waitLoaded","finally","window","ymaps","Map","anchor","document","head","body","documentElement","script","createElement","src","scriptUrl","encodeURIComponent","appendChild","onload","removeChild","loadTimeout","setTimeout","loadStep","SuggestWidget","ui","autoComplete","super","widget","selectItem","value","onSelect","search","destroy","cleanupDOM","input","ctrls","_this$ctrls","inputs","_this$ctrls$inputs","origin","container","_this$ctrls2","style","display","remove","handleInitStack","nf","owner","opts","setOptions","merge","messages","nothingFound","error","bindEvents","init","sys","code","downloadBundle","request","onLoad","onComplete","onError","showLoading","vars","loader","show","hideLoading","hide","showError","errorLabel","sysDesc","Suggest","element","_itemsData","onMapDoubleClick","e","coords","get","drawPlacemark","fillCoordinates","geocode","then","response","geoObject","geoObjects","title","geoObjectTitle","address","geoObjectAddress","fillSuggest","fillAddress","catch","onSuggestSelect","data","coordinates","moveCenter","onSuggestSearch","result","i","getLength","push","VALUE","DISPLAY","geoObjectCoordinates","apply","call","$el","el","initialize","bootWidget","bind","unbind","destroyWidget","handleMapDoubleClick","dir","map","events","scope","geometry","getCoordinates","properties","GeocoderMetaData","text","Address","Components","country","street","district","house","locality","length","part","target","kind","name","find","val","type","entries","details","removeAll","add","Placemark","setCenter","Warehouse","YandexPay","Plugin","Base","args","onDialogResize","dialog","closest","dialogElement","width","height","_map","fitToViewport","onClarifyClick","toggleDetails","onSuggestError","openDetails","focusDetails","postInitialize","destroySuggest","destroyMap","getInstance","bootMap","bootSuggest","showSavedPlacemark","focusSuggest","handleClarifyClick","handleDialogResize","getElement","$button","newText","html","$details","readonly","hasClass","toggleClass","prop","center","controls","behaviors","zoom","yandexMapDisablePoiInteractivity","_suggest","lat","lon","focus","first","mapElement","suggestElement","clarifyElement","detailsElement","errorElement","dataName"],"mappings":"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"}